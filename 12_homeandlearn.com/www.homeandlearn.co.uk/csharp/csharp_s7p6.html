<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.uk/csharp/csharp_s7p6.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 06:56:06 GMT -->
<HEAD>
		<TITLE>Visual C# .NET - Collections: Array Lists</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-2.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-2.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2010.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign.html">Web Design</a></LI>
<LI><a href="../javascript/javascript.html">Javascript</a></LI>
<LI><a href="../NET/vbNet.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php.html">Beginners PHP</a></LI>
<LI><a href="csharp.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">C# Collections - Lists</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p align="center">&nbsp;</p>
<p align="center"><a href="csharp_s7p5.html">&lt;&lt; Continues from the previous 
  lesson</a></p>
<p>Arrays are very useful for holding lots of values under the same name. But 
  there is also something called a Collection that does a similar job. In fact, 
  there's an inbuilt group of Classes in C# specifically for Collections. They 
  can be quite powerful.</p>
<p>With an array, you store data of the same type. So one array can only hold, 
  say, numbers, but not letter. And an array set up as string can't hold numbers. 
  So you can't do this, for example:</p>
<p class="indent_big">arrayPos[0] = 1;<br>
  arrayPos[1] = &quot;two&quot;;</p>
<p>The first position holds a number and the second position holds text. C# won't 
  let you do this in an array. But you can do it in a collection known as a Hashtable.</p>
<p>Collections can also make it easier to do things like sorting the data in your 
  lists, deleting items, and adding more items. We'll start with the collection 
  class called <b>Lists</b>.</p>
<p align="left">&nbsp;</p>
<h3 align="left">Lists</h3>
<p>You use a List when your collection may need items adding to it, deleting from 
  it, or needs sorting. For example, suppose you are teacher with a class of ten 
  children. You could keep a list of the children's names, add new students, delete 
  ones who leave, and even sort them alphabetically! If you used a normal array, 
  it would be difficult to do these things. </p>
<p>So start a new C# project. Add a button and a listbox to your new form. Double 
  click the button to get at the coding window. Now have a look near the top and 
  you'll see a list of using statements (lines 1 to 7 in the image below):<br>
</p>
<p align="center"><img src="images/arrays/arrayList_Using.gif" width="311" height="226" alt="A List of Using Statements in C#" border="1"></p>
<p>&nbsp;</p>
<p>The using statement that is needed for lists is the one that says System.Collections.Generics. 
  If you can't see it as one of your using statements, add it yourself. </p>
<p>To set up a List, double click the button on your form to create a code stub. 
  Now add the following line:</p>

<p align="center"><b>List&lt;string&gt; students = new List&lt;string&gt;();</b></p>
<p>You start with the word, <b>List</b>. Then comes a pair of pointy brackets. 
  In between the pointy brackets you need a variable or object type. We've used 
  <b>string</b>. What this tells C# to do is to set up a List that will hold string 
  values. The list itself is called <b>students</b>. After an equal sign, we have 
  the <b>new</b> keyword. Next comes the <b>List&lt;string&gt;</b> part again. 
  This time, however, it's followed by a pair of round brackets, telling C# to 
  create a new list of string values.</p>
<p>Your code window will look something like this:</p>
<p align="center"><img src="images/csharp_2012/chapter_lists/lists_1.gif" alt="C# code to set up a List"></p>
<p>After setting up the List, you need to fill it with data. Add the following 
  three lines to your code:</p>
<p class="indent_big">students.Add(&quot;Jenny&quot;);<br>
  students.Add(&quot;Peter&quot;);<br>
  students.Add(&quot;Mary Jane&quot;);</p>
<p>Your coding window will then look like this:</p>
<p align="center"><img src="images/csharp_2012/chapter_lists/lists_2.gif" alt="Adding items to a C# List"></p>
<p>After typing the name of your List (<b>students</b>, for us), you may have 
  seen the C# IntelliSense list appear:</p>
<p align="center"><img src="images/arrays/arrayList_SetUp3.gif" alt="IntelliSense dropdown to add items to a List"></p>
<SECTION ID="Wrapper"><ARTICLE><SECTION>This is a list of all the Methods and 
Properties that a List has. The one that you use to add items to your List is 
called, not surprisingly, <b>Add</b>( ). Between the round brackets of Add( ), 
you type the data that you want to add to your List: 
<p align="center">students.<b>Add(</b> &quot;Jenny&quot;<b> )</b>;</p>
<p>For every item in your collection, you need a new line that Adds items.</p>
<p>To access the items in your List, you can use a <a href="csharp_s7p5.html">foreach 
  loop</a>. Add this to your button code:</p>
<p class="indent_small">foreach (string child in students)<br>
  {</p>
<p class="indent_big">listBox1.Items.Add( child );</p>
<p class="indent_small">}</p>
<p>So we're looping round all the items in the List, and then adding them to the 
  listbox. </p>
<p>You can also use an ordinary for loop:</p>
<p class="indent_small">for (int i = 0; i &lt; students.Count; i++)<br>
  {</p>
<p class="indent_big">listBox1.Items.Add( students[i] );</p>
<p class="indent_small">}</p>
<p>Notice that the end condition is <b>students.Count</b>. Count is a property 
  of Lists that tells you how many items is in it. Inside the for loop, we're 
  using square brackets with the index number inside. This is just like the normal 
  arrays you used earlier.</p>
<p>But if you want to loop round a collection, the above code is not the right 
  choice. A better choice is a foreach loop.</p>
<p>A foreach loop ends when no more items in your collection or array are left 
  to examine. Unlike a normal for loop, you don't have to tell C# when this is 
  - it already knows what's in your collection, and is clever enough to bail out 
  of the foreach loop by itself.</p>
<p>You can add a new item to your List at any time. Here's an example to try:</p>
<p align="center"><img src="images/csharp_2012/chapter_lists/lists_3.gif" alt="Add List item"></p>
<p>So we're adding a fourth student to the List, Azhar, and then displaying the 
  item in the listbox.</p>
<p>Add the new code to your button. Run your programme and click your button. 
  Your form will look something like this:</p>
<p align="center"><img src="images/csharp_2012/chapter_lists/lists_form.gif" alt="ArrayList Form"></p>
<p>&nbsp;</p>
<h3>Sorting a List</h3>
<p>Sorting a List alphabetically is quite straightforward. You just use the Sort 
  Method. Like this:</p>
<p align="center">students.<b>Sort()</b>;</p>
<p>And here's some code to try out. The new lines should be added at the end of 
  your current code:</p>
<p class="indent_small">students.Sort();</p>
<p class="indent_small">listBox1.Items.Add(&quot;=================&quot;);</p>
<p class="indent_small">foreach (string child in students)<br>
  {</p>
<p class="indent_big">listBox1.Items.Add(child);</p>
<p class="indent_small">}</p>
<p>Run your programme and try it out. Here's what your listbox will look like 
  after the button is clicked:</p>
<p align="center"><img src="images/csharp_2012/chapter_lists/lists_form_2.gif" alt="A sorted ArrayList"></p>
<p>As you can see, the items have been sorted alphabetically, in ascending order. 
  You can have a descending sort, if you prefer. One way to do this is with the 
  <b>Reverse</b> method:</p>
<p class="indent_big">students.Reverse( );</p>
<p>No extra coding is needed!<br>
</p>
<p>&nbsp;</p>
<h3>Removing items from a List</h3>
<p>To remove an item from your list, you can either use the <b>Remove</b> or the 
  <b>RemoveRange</b> methods. The Remove method deletes single items from the 
  List. You use it like this:</p>
<p align="center">students.<b>Remove(</b> &quot;Peter&quot; <b>)</b>;</p>
<p>In between the round brackets of <b>Remove</b>, you simply type the item you 
  want to remove.</p>
<p>If you want to remove more than one item, use <b>RemoveRange</b>. Like this:</p>
<p align="center">students.<b>RemoveRange(</b> 0, 2 <b>)</b>;</p>
<p>The first number between the round brackets of RemoveRange is where in your 
  list you want to start. The second number is how many items you want to remove. 
  Here's some code to try at the end of your button:</p>
<p class="indent_small">students.RemoveRange(0, 2);</p>
<p class="indent_small">listBox1.Items.Add(&quot;=================&quot;);</p>
<p class="indent_small">foreach (string child in students)<br>
  {</p>
<p class="indent_big">listBox1.Items.Add(child);</p>
<p class="indent_small">}</p>
<p></p>
<p>But that's enough of Lists. There's lots more that you can do with them, and 
  they are worth researching further. </p>
<p>The final Collection we'll look at is called a Hashtable.</p>
</SECTION></ARTICLE></SECTION><FOOTER> 
<p align="right"><a href="csharp_s7p5.html">&lt;-- Arrays and Text</a> | <a href="csharp_s7p7.html"> C# HashTables --&gt;</a></p>
		<P><A HREF="csharp.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.uk/csharp/csharp_s7p6.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 06:56:06 GMT -->
</HTML>

