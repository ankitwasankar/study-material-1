<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s12p6.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:39 GMT -->
<HEAD>
		<TITLE>Visual C# .NET - DataSets and DataAdapters</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">DataSets and DataAdapters</H1>
</HEADER> <SECTION>
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<P>&nbsp;</P>
<P>The connection to the database has been made. The next step is to pull the 
  records from our Employees table. To do that, a <b>Dataset</b> and a <b>DataAdapter</b> 
  are needed.</P>
<p>A Dataset is where all your data is held when it is pulled from the database 
  table. Think of it like a grid that you see on a spreadsheet. The Columns in 
  the grid are the Columns from your database table. The Rows represent a single 
  entry in the table.</p>
<p>The Dataset needs to be filled with data. However, because the Dataset and 
  Connection object can't see each other, they need someone in the middle to help 
  them out - the <b>DataAdapter</b>. The DataAdapter will fill the Dataset with 
  records from the database.</p>
<p>So we need to set up two more objects, a Dataset and a DataAdapter. To create 
  a Dataset object, add the following just above the form load event:</p>
<p class="indent_big">DataSet ds1;</p>
<p>Inside of the form load event, create a new object from the Dataset type we've 
  called <b>ds1</b>:</p>
<p class="indent_big">ds1 = new DataSet();</p>
<p>Add the code just after your con.Open line.</p>
<p>For the DataAdapter, add the following outside of the form load event:</p>
<p class="indent_big">System.Data.SqlServerCe.SqlCeDataAdapter da;</p>
<p>We're setting up a DataAdapter variable, here, and calling it <b>da</b>.</p>
<p>Inside of the form load event, we can create a new object from our <b>da</b> 
  variable. Add these two lines just after your <b>ds1</b> line:</p>
<p class="indent_big">string sql = &quot;SELECT * From tbl_employees&quot;;<br>
  da = new System.Data.SqlClient.SqlDataAdapter( sql, con );</p>
<p>The first line sets up a string variable called <b>sql</b>. SQL stands for 
  Structured Query Language. It's a language used to pull records from a database, 
  and variants of it are used for all database systems. You use the Structured 
  Query Language on the database itself. (SQL Server's variant is called T-SQL. 
  The T stands for Transact.) </p>
<p>Keywords in SQL are SELECT, UPDATE, WHERE, and a whole lot more besides. The 
  * symbol means &quot;all the records&quot;. So we're saying, &quot;Select all 
  the records from the table called <b>tbl_employees</b>&quot;. </p>
<p>The DataAdapter object will use your SQL commands to pull the records from 
  the database. But you need to tell it which connection object to use. That's 
  why, in between the round brackets, we have this:</p>
<p class="indent_big">( sql, con );</p>
<p>Our new DataAdapter object will then know what records to pull (sql), and where 
  to pull them from (con).</p>
<p>But here's what your coding windows should look like:</p>
<p align="center"><img src="images/csharp_2012/chapter_databases/con_new/con_code_2-2.gif" width="678" height="314" alt="C# Code to select records from a SDF database table"></p>
<p>To fill the dataset with records from the database, you use the DataAdapter 
  and issue the <b>Fill</b> command:</p>
<p class="indent_big">da.Fill( ds1, &quot;Workers&quot; );</p>
<p>What this does is to <b>Fill</b> a Dataset called <b>ds1</b>. After the comma, 
  you can type an identifying name for this particular Fill. We've called ours 
  <b>Workers</b>. </p>
<p>After the Fill command has been issued, the records from the SQL command are 
  stored in the Dataset. This, remember, is just like a grid with Columns and 
  Rows.</p>
<p>So add the line to your code. Put it just before the <b>con.Close</b>() line.<br>
</p>
<p>In the next part, you'll see how to access the data from the Dataset.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s12p5-2.html">&lt;-- Connect to a Database</a> | <a href="csharp_s12p7-2.html">Access Data from the Dataset --&gt;</a></P>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s12p6.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:39 GMT -->
</HTML>

