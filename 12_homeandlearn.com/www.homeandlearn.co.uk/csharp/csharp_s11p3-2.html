<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s11p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:37 GMT -->
<HEAD>
		<TITLE>Visual C# .NET and Text Files: Write to a Text File</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Write to a Text File in C# .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p>&nbsp;</p>
<p>To write to a text file, you use the <b>StreamWriter</b> instead of the StreamReader. 
  It's used in the same way, though:</p>
<p class="indent_big_no_bold">System.IO.<b>StreamWriter</b> objWriter;<br>
  objWriter = new System.IO.<b>StreamWriter</b>( file_name );</p>
<p>Here, we're setting up a StreamWriter object and calling it <b>objWriter</b>. 
  When you create a new StreamWriter object, you hand it the name of a file between 
  the round brackets. Note that if the file is not found, no error will be raised. 
  This is because a file is created if one doesn't exist.</p>
<p>Add another button to your form. Double click and type the following code for 
  it (If you have a Windows version later than XP you can add the longer <b>file_name</b> 
  lines, the ones with Environment.GetFolderPath, etc, from the <a href="csharp_s11p2-2.html">previous 
  section</a>):</p>
<p align="center"><img src="images/csharp_2010/file_path_new5-2.gif" width="397" height="198" alt="C# code to Write to a Text File"></p>
<p>Notice the line the does the writing:</p>
<p align="center"><b>objWriter.Write( textBox1.Text );</b></p>
<p>After the dot, use the Write method. In between the round brackets of Write, 
  add what it is you want to write to your file. For us, this was the Text in 
  textBox1.</p>
<p>We also close the StreamWriter object, after we have finished with it.</p>
<p>If you want to write line by line, instead of all at once, use this:</p>
<p align="center"><b>objWriter.<i>WriteLine( )</i>;</b></p>
<p>In between the round brackets of WriteLine, you add the line that you want 
  to write to your text file. This is normally done in a loop, and is useful if 
  you have an array of text that you want to write to a file. Here's a coding 
  example that does just that. See if you can work out what's happening. Try it 
  yourself.</p>
<p align="center"><img src="images/csharp_2010/file_path_new6-2.gif" width="487" height="427" alt="C# code to write to a text file line by line"></p>
<p>The for loop is where we write each line to the text file, adding a carriage 
  return and new line character. </p>
<p>&nbsp;</p>
<h3>Appending text to a file</h3>
<p>When you use either Write or WriteLine, it will overwrite the current file. 
  So if you click your button twice, it won't add the new text to the end. It 
  will just erase whatever is already there, and write it again.</p>
<p>If you want to add more text to what you already have, then you need to append. 
  This is quite easy, and is done with the StreamWriter line:</p>
<p align="center"><b>objWriter = new System.IO.StreamWriter( file_name, <i>true</i> 
  );</b></p>
<p>Between the round brackets of StreamWriter, and after the file you want to 
  use, you type <b>true</b> to append data to your file. The default is <b>false</b>.</p>
<p>And that's it - no need for anything else!</p>
<p>Coming up next - How to Copy a file with C#.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s11p2-2.html">&lt;-- Read a Text File</a> | <a href="csharp_s11p4-2.html">Copy a File in C# --&gt;</a></p>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s11p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:37 GMT -->
</HTML>

