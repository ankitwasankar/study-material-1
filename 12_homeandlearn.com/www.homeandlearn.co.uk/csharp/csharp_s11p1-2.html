<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s11p1.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:35 GMT -->
<HEAD>
		<TITLE>Visual C# .NET and Text Files: How to Open a Text File</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Open a Text File in C# .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p>&nbsp;</p>
<p>As a programmer, you should have the ability to manipulate files. By this we 
  mean opening and processing things like text files, html files, word docs, etc. 
  In this section, you'll learn how to do that. First up is opening a text file.</p>
<h3><br>
  How to open a Text File in C#</h3>
<p>What we'll do is to open up a plain text file and insert the contents into 
  a text box. So start a new project. Add a text box and a button to your form. 
  Set the MultiLine property of the text box to true.</p>
<p>Before you double click your button, you'll need to create a text file. Use 
  the Windows Notepad to create the following text file:<br>
</p>
<p align="center"><img src="images/textFiles/notepad-2.gif" width="356" height="286" alt="Notepad with some text in it"></p>
<p>(The Windows Notepad can be found by clicking <b>Start &gt; All Programs &gt; 
  Accessories</b>, in both XP and Vista/Windows7.)</p>
<p>Save it anywhere you like, but we recommend saving to your root drive if you 
  have XP. The file path would then be C:\test1.txt. For later versions of Windows, 
  save it to your Documents folder. The file path would then be:</p>
<p class="indent_big">&quot;C:\\Users\\Owner\\Documents\\test1.txt&quot;</p>
<p>But you can also use this rather long line:</p>
<p class="indent_small">string fldr =&quot;\\test1.txt&quot;;<br>
  fldr = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) + fldr;</p>
<p>Once you have created and saved your text file, double click the button on 
  your form to get at the code. Add your file path as a string variable. Here's 
  the one for XP users:<br>
</p>
<p align="center"><img src="images/csharp_2010/file_name_xp-2.gif" width="449" height="73" alt="File path to text file - XP users"></p>
<p>And here's one for all other Windows users:</p>
<p align="center"><img src="images/csharp_2012/chapter_textfiles/folder_path_code-2.gif" alt="Environment.SpecialFolder file path"></p>
<p>Note that we have two backslash characters (\\) in the file name. This is because 
  if you just use one in C# it means &quot;A special character follows&quot;. 
  The special character IS the backslash, so you need two: one to tell C# that 
  a special character follows, and one for the special character itself. This 
  is known as <b>escaping</b>.</p>
<p>To open up text files, C# .NET uses something called the <b>StreamReader</b>. 
  This is an inbuilt class that lives in the <b>Input/Output</b> namespace. (A 
  namespace is a collection of related classes, all grouped together.) The Input/Output 
  namespace, or IO for short, lives in the System namespace. We need to set up 
  a <b>StreamReader</b> variable, so the code would be this:</p>
<p align="center"><b>System.IO.StreamReader </b>objReader</p>
<p>This sets up a StreamReader variable that we've called objReader. You then 
  create a new object with the name objReader:</p>
<p align="center"><b>objReader = new System.IO.StreamReader( </b>file_name<b> 
  );</b></p>
<p>After the new keywords, we have System.IO.StreamReader again. However, after 
  StreamReader we have a pair of round brackets. The file you want to open goes 
  between the round brackets. For us, this was held in the variable we called 
  file_name. Add the two lines to your code, and your coding window should look 
  like ours below (This is the XP <b>file_name</b> version just so that we can 
  have a smaller images):</p>
<p align="center"><img src="images/csharp_2010/file_path_new-2.gif" width="392" height="121" alt="C# code for a StreamReader Object"></p>
<p>Now that we have a StreamReader object, we can use its properties and methods. 
  To place the entire contents of a file in to a text box, you can use the ReadToEnd 
  method. As its name suggests, this reads all the contents of the file. Add this 
  line to your code:</p>
<p align="center">textBox1.Text = objReader.<b>ReadToEnd()</b>;</p>
<p>Once opened, a Streamreader should be closed. This is quite simple:</p>
<p align="center">objReader.<b>Close()</b>;</p>
<p>After adding the close line, your code should look like this:</p>
<p align="center"><img src="images/csharp_2010/file_path_new2-2.gif" width="401" height="180" alt="C# code to open a text file"></p>
<p>Run your programme and test it out. You should find that the contents of your 
  text file appear in your text box when your button is clicked.</p>
<p>Stop your programme and return to your code. Change your file_name line to 
  this:</p>
<p align="center"><b>string file_name = &quot;C:\\test1111.txt&quot;;</b></p>
<p>In other words, just add three more 1's to the file name. Run your programme 
  and click the button again. Unless you have a file called test1111.txt on your 
  C drive, you should see this error message appear (Visual Studio 2012 users 
  will see a plainer version of the error below):</p>
<p align="center"><img src="images/textFiles/fileNotFoundError_p119-2.gif" width="402" height="233" alt="File Not Found Error"></p>
<p>You can test to see if a file exists. Again, you use the System.IO namespace. 
  But this time you use the File class. Here's the code:</p>
<p class="indent_small">if ( System.IO.File.Exists( file_name ) = = true )<br>
  {</p>
<p class="indent_big_no_bold">//OPEN FILE HERE</p>
<p class="indent_small">}<br>
  else<br>
  {</p>
<p class="indent_big_no_bold">//ERROR MESSAGE HERE</p>
<p class="indent_small">}</p>
<p>So the line that checks to see if the file exists is this:</p>
<p align="center"><b>System.IO.File.Exists( file_name ) == true</b></p>
<p><b>Exists</b> is a method available to <b>File</b>. Between the round brackets 
  of Exists, you type the name of the file you want to check. After a pair of 
  double equals signs, we're checking for a value of <b>true</b>.</p>
<p>Place the code that opens the file between the curly brackets of the IF statement. 
  Add an error message for the <b>else</b> part, and we have this:</p>
<p align="center"><img src="images/csharp_2010/file_path_new3-2.gif" width="419" height="295" alt="C# code to check if the file exists"></p>
<p>So the file gets checked to see if it exits. If it doesn't, we display an error 
  message. If it does, the file is opened.</p>
<p>You can also check to see if a folder (Directory) exists. Just use <b>Directory</b> 
  instead of <b>File</b>. Like this:</p>
<p class="indent_big">if ( System.IO.Directory.Exists( folder_location ) )<br>
  {</p>
<p class="indent_big">}</p>
<p><br>
</p>
<p>In the next lesson, you'll learn how to read a file line by line.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s10p9-2.html">&lt;-- Static Methods</a> | <a href="csharp_s11p2-2.html">Read a file line by line --&gt;</a></p>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s11p1.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:35 GMT -->
</HTML>

