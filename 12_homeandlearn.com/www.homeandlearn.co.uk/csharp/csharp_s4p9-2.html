<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s4p9.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:09 GMT -->
<HEAD>
		<TITLE>Visual C# .NET - Open File dialogue box</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Open File Dialogue Box in C#</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p align="center"><a href="csharp_s4p8-2.html">&lt;&lt; Continues from the previous 
  lesson</a></p>
<p align="left">We'll now give users the option to add their own images to the 
  picture box, instead of the one we chose. To do that, you need to display an 
  Open File dialogue box when the user clicks your <b>View &gt; View Images</b> 
  menu item.</p>
<p>Dialogue boxes in C# can be added with the aid of an inbuilt object. Have a 
  look in the Toolbox on the left hand side of Visual C#. There should be a category 
  called Dialogs:</p>
<p align="center"><img src="images/menus/Toolbox_Dialogs-2.gif" width="180" height="290" alt="The Dialogs Tools in Visual C# .NET" border="1"></p>
<p>All the dialogue boxes you are familiar with in Windows are on the list above. 
  The one highlighted is the one we want - <b>OpenFileDialog</b>. Double click 
  this item, and you'll see a new item appear at the bottom of Visual C#, next 
  to your menuStrip1 object:</p>
<p align="center"><img src="images/menus/OpenFileDialog-2.gif" width="474" height="150" alt="An OpenFileDialog control added to a form" border="1"></p>
<p>Nothing will appear on your form, however, because the Dialog controls are 
  are hidden from view. The one in the image above has a default Name of <b>openFileDialog1</b>. 
  This is a bit long, so have a look at the Properties Window on the right. Change 
  the <b>Name</b> to <b>openFD</b>:</p>
<p align="center"><img src="images/menus/OpenFileDialog_Properties-2.gif" width="269" height="418" border="1" alt="Change the Name Property to openFD"></p>
<p>The control at the bottom of Visual C# should have changed, as well:</p>
<p align="center"><img src="images/menus/OpenFileDialog-Object-2.gif" width="214" height="49" border="1" alt="The Name has been changed"></p>
<p>With the control selected, have another look at the Properties Window. You'll 
  see that there are Properties for <b>Filter</b>, <b>FileName</b>, <b>InitialDirectory</b> 
  and <b>Title</b>. We'll change these with code. But one important point to bear 
  in mind about the Open File Dialogue box is this: They don't actually open files! 
  What the Open File Dialogue box does, and the same is true for the other Dialog 
  controls, is to allow you to select a file for opening. You have to write separate 
  code to open anything. The only thing you're really doing here is to get at 
  a file name.</p>
<p>We want the dialogue box to appear when the <b>View &gt; View Images</b> menu 
  is clicked. So double click this item on your <b>View</b> menu. A code stub 
  will appear:</p>
<p align="center"><img src="images/menus/MenuView_CodeStub-2.gif" width="442" height="76" border="1" alt="C# code stub for a menu item"></p>
<p>To see the Open Dialogue box, add this line to your code, in between the curly 
  brackets:</p>
<p align="center"><b>openFD.ShowDialog();</b></p>
<p>So you type the Name of your control, and then a dot. After the dot, select 
  <b>ShowDialog</b> from the IntelliSense list. As its name suggest, this shows 
  you the dialogue box.</p>
<p>Run your programme and try it out. You should see something like the following 
  appear when you click your <b>View &gt; View Images</b> menu item:</p>
<p align="center"><img src="images/csharp_2010/openFD-2.gif" width="617" height="493" alt="The Open Dialogue Box"></p>
<p>Because we haven't yet set any Properties, a default location is displayed, 
  which is the Documents folder in Windows 7. The File name has the default openFileDialog1. 
  You can change all these, though.</p>
<p>We can set a Title, first. The default Title is the word Open, in white on 
  a blue background in XP, black on light blue background in Vista and Windows 
  7. Add this line to your code, before the first line:</p>
<p align="center"><b>openFD.Title = &quot;Insert an Image&quot;;</b></p>
<p>This time, we're using the <b>Title</b> Property, and setting it to the text 
  &quot;Insert an Image&quot;. You can, of course, type anything you like here. 
  When you run your programme and click the menu item, the new Title will look 
  like this in XP:</p>
<p align="center"><img src="images/menus/OpenFileDialog_Title-2.gif" width="166" height="64" alt="The Title has changed"></p>
<p>And this in later versions of Windows:</p>
<p align="center"><img src="images/csharp_2010/openFD_title-2.gif" width="264" height="58" alt="Changing the Title property"></p>
<p>If you wanted something more humorous, you could even change it something like 
  this:</p>
<p align="center"><img src="images/menus/OpenFileDialog_Title2-2.gif" width="166" height="64" alt="A New Title"></p>
<p>Better to stick with something more descriptive, though!</p>
<p>Another thing you can change is that Look in area. The default location is 
  the Debug folder from your project. You can reset it with the InitialDirectory 
  property. Add the following line to your code, before the other two lines:</p>
<p align="center"><b>openFD.InitialDirectory = &quot;C:&quot;;</b></p>
<p>We're setting the default folder to be C. This would assume that the user had 
  a hard drive called C. If you want to set the Initial Directory to the &quot;My 
  Documents&quot; folder of any computer, try this after the equals sign, instead 
  of &quot;C:&quot;:</p>
<p align="center"><b>= System.Environment.GetFolderPath(Environment.SpecialFolder.Personal);</b></p>
<p>This will get the folder path to the My Document folder (Personal folder), 
  which is called the Documents folder in Vista and Windows 7. You need to do 
  it this way because different users will have different user names, and there's 
  no way for you to tell beforehand.</p>
<p>But run your programme and try it out. The Look in box should have changed 
  (XP):<br>
</p>
<p align="center"><img src="images/menus/OpenFileDialog_InitDir-2.gif" width="327" height="65" alt="Set the Look In area to the My Documents folder of XP"></p>
<p>Or this, in later versions of the Windows operating system:</p>
<p align="center"><img src="images/csharp_2012/chapter_menus/openFD-2.gif" alt="InitialDirectory property"></p>
<p>For the File name area, you can use the <b>FileName</b> Property. Add this 
  line to your code (add it before the final line):</p>
<p align="center"><b>openFD.FileName = &quot;&quot;;</b></p>
<p>Here, we're setting the File Name to a blank string. Run your programme and 
  you'll find that the <b>File name</b> area on your dialogue box will be blank, 
  and the cursor will be flashing away. Select any file you like, and the file 
  name will appear in the box.</p>
<p>The next thing to do is to set up some Files of type. This is for the drop 
  down list you see at the bottom, just under File name. Here's what we want to 
  do (XP):</p>
<p align="center"><img src="images/menus/OpenFileDialog_FileTypes-2.gif" width="351" height="99" alt="Set the Files of Type" border="1"></p>
<p>And this in later versions of Windows:</p>
<p align="center"><img src="images/csharp_2010/openFD_filesOfType-2.gif" width="479" height="80"></p>
<p>So we want the user to be able to select JPEG images, GIF images, and Bitmap 
  images. When you set the files of type, you are restricting the type of files 
  that the user can open. This is done with the Filter Property. After all, you 
  don't want your users trying to insert text files into a picture box!</p>
<p>The filter property makes use of the pipe character ( | ). The pipe character 
  can be found above the backslash on a UK keyboard. Add this code, just before 
  the last line:</p>
<p align="center"><b>openFD.Filter = &quot;JPEG|*.jpg&quot;;</b></p>
<p>Notice what comes after the equals sign:</p>
<p align="center">&quot;JPEG<b>|</b>*.jpg&quot;;</p>
<p>Your filters need to go between quote marks. But the JPEG part, before the 
  pipe character, is what you want to display in the drop down list. You can have 
  anything you like here, &quot;JPEG Images&quot; instead of just &quot;JPEG&quot;, 
  for example. After the pipe character, you need an asterisk symbol * followed 
  by a dot. The asterisk symbol means &quot;any file name&quot;. After the dot, 
  you type the file extension that you want to filter for.</p>
<p>Run you code and try it out. You should see this in the &quot;Files of type&quot; 
  list (on the right of the text box in Vista and Windows 7)::</p>
<p align="center"><img src="images/menus/OpenFileDialog_Filter-2.gif" width="355" height="54" alt="Filtering for JPEG images in C#" border="1"></p>
<p>Now change your code to this:</p>
<p align="center"><b>openFD.Filter = &quot;JPEG Images|*.jpg&quot;;</b></p>
<p>The &quot;Files of type&quot; list will then look like this, depending on your 
  Operating System:</p>
<p align="center"><img src="images/menus/OpenFileDialog_Filter2-2.gif" width="351" height="47" border="1" alt="Files of Type now reads JPEG Images"></p>
<p align="center"><img src="images/csharp_2010/openFD_jpegs-2.gif" width="476" height="52"></p>
<p>Using just one filter means that no other file types will display. To add other 
  file types you just need to use the pipe character again. Let's add GIF images, 
  as well. Change your code to this:</p>
<p align="center"><b>openFD.Filter = &quot;JPEG Images|*.jpg|GIF Images|*.gif&quot;;</b></p>
<p>As you can see, the line is a bit messy! The new part is in blue, though. Notice 
  that you separate one file type from another with a pipe character. But you 
  also need a pipe to separate the text for the drop down list from the actual 
  file type. To add Bitmap images, the code would be this:</p>
<p align="center"><b>openFD.Filter = &quot;JPEG Images|*.jpg|GIF Images|*.gif|BITMAPS|*.bmp&quot;;</b></p>
<p>In the line above, the three file types have been displayed using different 
  colours, so that you can see them better.</p>
<p>Here's a few more image types, and their file extensions:</p>
<p align="center"><b>TIFF Images</b>: *.tif or *.tiff<br>
  <b>PNG Images</b>: *.png<br>
  <b>PICT Images</b>: *pct or *.pict</p>
<p>There are, of course, lots of others. In the image below, we've added TIFF 
  files to the list. (Note that you can use upper or lower case for the extensions.):</p>
<p align="center"><img src="images/menus/OpenFileDialog_Filter3-2.gif" width="354" height="87" alt="Four Image types have been filtered for" border="1"></p>
<p>To display files of any type, use an asterisk symbol in place of the file extension. 
  For example:</p>
<p align="center"><b>openFD.Filter = &quot;JPEG Images|*.jpg|All Files|*.*&quot;;</b></p>
<p><br>
  However, we still haven't inserted a new image. To place a selected image into 
  the picture box, you have to get the file name that the user selected. You can 
  add a string variable to your code for this:</p>
<p align="center"><b>string Chosen_File = &quot;&quot;;</b></p>
<p>You then access the FileName property of openFD. Like this:</p>
<p align="center"><b>Chosen_File = openFD.FileName;</b></p>
<p>The file name will then be in the variable we've called <b>Chosen_File</b>. 
</p>
<p>To place a new image into the picture box you have on the form, you need the 
  Image property:</p>
<p align="center"><b>pictureBox1.Image</b></p>
<p>To place your chosen file into the Image property, you need this:</p>
<p align="center"><b>pictureBox1.Image = Image.FromFile(</b>Chosen_File<b>);</b></p>
<p>So after the equals sign, you can use the <b>Image</b> object. This has a method 
  called <b>FromFile</b>( ). In between the round brackets of this method, you 
  type the name of the image file. For us, this image file is stored in our Chosen_File 
  variable.</p>
<p>Add the new lines to your code and your coding window should look something 
  like ours below (we've cut down on a few filters):</p>
<p align="center"><img src="images/menus/OpenFileDialog_Code-2.gif" width="433" height="230" alt="C# code for the View Images menu item" border="1"></p>
<p>Run your programme and test it out. Select an image to open. You should find 
  that your new image replaces the old one in your picture box.</p>
<p>However, there is a problem with the code. Instead of clicking Open, click 
  <b>Cancel</b>. You should get an error message (C# 2012's error message is a 
  plain version of the one below):</p>
<p align="center"><img src="images/menus/OpenFileDialog_Error-2.gif" width="415" height="280" alt="ArgumentException Error" border="1"></p>
<p>Because the Cancel button was clicked, there is no image name in the variable 
  Chosen_File. So the programme &quot;bugs out&quot; on you. You need to handle 
  this in your code.</p>
<p>To check if the cancel button was clicked, you can use this:</p>
<p class="indent_small">if (openFD.ShowDialog() = = DialogResult.Cancel)<br>
  {</p>
<p class="indent_big">MessageBox.Show(&quot;Operation Cancelled&quot;);</p>
<p class="indent_small">}</p>
<p>So there is inbuilt object called <b>DialogResult</b>. You check if this has 
  a value of <b>Cancel</b>. Adding an else statement gives us this code:</p>
<p align="center"><img src="images/menus/OpenFileDialog_Code2-2.gif" width="440" height="329" alt="The complete code" border="1"></p>
<p>Change your code so that it looks like ours above. When you run your programme 
  now, it shouldn't crash when you click the Cancel button.</p>
<p>You can also have this for you IF Statement, instead of the one above:</p>
<p class="indent_small">if (openFD.ShowDialog() != DialogResult.Cancel)<br>
  {</p>
<p class="indent_big">Chosen_File = openFD.FileName;<br>
  pictureBox1.Image = Image.FromFile(Chosen_File);</p>
<p class="indent_small">}</p>
<p>We've used the NOT symbol, here ( ! ). So we're checking if DialogResult does 
  NOT equal Cancel.</p>
<p>&nbsp;</p>
<p>In the next part, you'll see how to use the Open File Dialogue box to insert 
  a text file into your text boxes.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s4p8-2.html">&lt;-- Adding Images in C#</a> 
          | <a href="csharp_s4p10-2.html">Open a Text File --&gt;</a></p>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s4p9.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:09 GMT -->
</HTML>

