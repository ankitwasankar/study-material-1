<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s14p1.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:44 GMT -->
<HEAD>
		<TITLE>Visual C# .NET: Dates and Times</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Dates and Times in C# .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p>&nbsp;</p>
<p>At some stage of your programming career, you'll need the ability to manipulate 
  dates and time. A typical example would be a database programme where you want 
  to record when an entry was made, especially if it's an order for a product. 
  Or if you want to, say, calculate how many days it's been since an order was 
  placed.</p>
<p>Start a new project for this. Add a button to your new form, and double click 
  it to get at the code.</p>
<p>An inbuilt structure you can use to manipulate dates is called DateTime. Add 
  this to you button code:</p>
<p class="indent_big">DateTime theDate;</p>
<p class="indent_big"> theDate = DateTime.Now;</p>
<p> <span class="indent_big">MessageBox.Show( theDate.ToString() );</span><br>
</p>
<p>After setting up a DateTime variable called <b>theDate</b>, we have this line:</p>
<p class="indent_big">theDate = DateTime.Now;</p>
<p>The <b>Now</b> property returns the current system date and time of your computer, 
  wherever you are in the world.</p>
<p>The third line in our code converts the DateTime into a string and then displays 
  it in a message box. When the code is run, and the button clicked, the message 
  box will be something like this:</p>
<p align="center"><img src="images/extras/date-2.gif" width="131" height="107" alt="Message Box with a Date and Time"></p>
<p>This is the date in UK format (day first, then month), followed by the current 
  time (hours, minutes and seconds).</p>
<p>You can also have this, instead of Now:</p>
<p class="indent_big">theDate = DateTime.Today;</p>
<p>And even this</p>
<p class="indent_big">theDate = DateTime.UtcNow;</p>
<p>Utc is something called Coordinated Universal Time, or International Atomic 
  Time. </p>
<p>Try all three in your code and see how they differ.</p>
<p>To get at just the year, or the month, or the day, take a look at the IntelliSense 
  list when you type the dot after DateTime:<br>
</p>
<p align="center"><img src="images/extras/dateList-2.gif" width="151" height="646" alt="A list of Date and Time Methods and Properties in C#"></p>
<p>If you click on Day to highlight it, you'll see that it is an Integer:</p>
<p align="center"><img src="images/extras/dateDay-2.gif" width="441" height="56" alt="The C# Day property" border="1"></p>
<p>To use this, then, you can set up a new integer variable and hand it the day:</p>
<p class="indent_big"> theDate = DateTime.UtcNow;</p>
<p class="indent_big"> int theDay = theDate.Day;</p>
<p>The Month and Year are also Integers, so the code is similar:</p>
<p class="indent_big">int theMonth = theDate.Month;</p>
<p>Or</p>
<p class="indent_big">int theYear = theDate.Year;</p>
<p>You can also convert your date to a string, and use something called a Format 
  Provider. Try this code:</p>
<p class="indent_big"> DateTime theDate = DateTime.UtcNow;</p>
<p class="indent_big"> string custom = theDate.ToString(&quot;d&quot;);</p>
<p class="indent_big"> MessageBox.Show(custom);</p>
<p>When you run your programme and click the button, the date displays in this 
  format:</p>
<p align="center"><b>14/04/08</b></p>
<p>Change the &quot;d&quot; in the code above to &quot;D&quot; (capital D instead 
  of lowercase). When you run the code, the date is displayed like this:</p>
<p align="center"><b>14 April 2008</b></p>
<p>Here's a list of letters you can use, and what they will display. Try a few 
  and see for yourself:</p>
<p align="center"><img src="images/extras/datesTable-2.gif" width="332" height="257" alt="A Table of Date and Time formats in C# .NET"></p>
<p>Another thing you can do with DateTime is to specify a format. Type the following:</p>
<p class="indent_big">DateTime firstDate = new DateTime</p>
<p>After the final &quot;e&quot;, type a round bracket. You should see this:</p>
<p align="center"><img src="images/extras/dateTime-2.gif" width="351" height="42" alt="The DateTime Class in C#"></p>
<p>There are 12 different ways to use the DateTime structure. Each one is giving 
  you the option of a date/time format. Examine option 4 of 12:</p>
<p align="center"><img src="images/extras/dateTime2-2.gif" width="469" height="60" alt="Specify a Date"></p>
<p>You can just type some numbers here:</p>
<p class="indent_big">DateTime firstDate = new DateTime(2008, 01, 14);</p>
<p>What you'll get back is the Date you specified. But you'll also get the time 
  as a series of zeros:</p>
<p align="center"><img src="images/extras/dateTimeMB-2.gif" width="131" height="107"></p>
<p>If you want to calculate the difference between one date and another, then 
  a more precise structure is used with DateTime - TimeSpan. Here's how to use 
  it:</p>
<p class="indent_big"> DateTime firstDate = new DateTime(2008, 01, 14);<br>
  DateTime secondDate = DateTime.Parse(&quot;1 Feb 2008&quot;);</p>
<p class="indent_big"> TimeSpan dateDiff;<br>
  dateDiff = secondDate.Subtract(firstDate);<br>
  MessageBox.Show(&quot;Date diff:&quot; + dateDiff.ToString() );</p>
<p>The first line sets up a date: the 14th of January 2008. The second line sets 
  up a date in a different way:</p>
<p class="indent_big">DateTime secondDate = DateTime.Parse(&quot;1 Feb 2008&quot;);</p>
<p>After the dot of DateTime, we're using <b>Parse</b>. In between the round brackets 
  of Parse, simply type your date between double quotes.</p>
<p>When you subtract one date from another, the answer is returned as a TimeSpan 
  structure. This uses similar methods and properties as DateTime. One of the 
  options is Subtract:</p>
<p class="indent_big">TimeSpan dateDiff;<br>
  dateDiff = secondDate.Subtract( firstDate );</p>
<p>After typing a date then a dot, use the Subtract method. In between the round 
  brackets of Subtract, you need another date - the one you're trying to subtract. 
  When the code is run, it will calculate the difference between the two dates.</p>
<p>You can also add date and time values to ones you already have. Examine this 
  code:</p>
<p class="indent_big"> firstDate = firstDate.AddDays(30);<br>
  MessageBox.Show( firstDate.ToString(&quot;D&quot;) );</p>
<p>Now we're using AddDays after our firstDate variable. In between the round 
  brackets of AddDays, type how many days you want to add.</p>
<p>When the IntelliSense list appears, have a look at other date and time values 
  you can add: AddMonths, AddYears, etc.</p>
<p><br>
  But that's it for this beginners course on Visual C# .NET. We hope you enjoyed 
  it, and wish you all the best for your future programming career. The book version 
  of this course has lots more lessons and tutorials. If you want to buy it, click 
  a link at the top of these pages.</p>
</SECTION></ARTICLE></SECTION> <FOOTER> 
<p align="right"><a href="csharp_s13p3-2.html">&lt;-- Form Values</a></P>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s14p1.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:44 GMT -->
</HTML>

