<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s4p10.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:10 GMT -->
<HEAD>
		<TITLE>Visual C# .NET - Open a Text File with the Open File Dialogue Box</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="../NET/vbNet-2.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="csharp-2.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Open a Text File with the Open File Dialogue Box</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<p align="center"><a href="csharp_s4p9-2.html">&lt;&lt; Continues from the previous 
  lesson</a></p>
<p align="left">We can reuse the Open File dialogue box that we have added. Instead 
  of filtering for images, we'll filter for text files. We'll also add a different 
  kind of text box - the Rich Text Box. This will allow us to easily add the text 
  from the file, straight into the programme. </p>
<p>So return to Designer View, so that you can see your form. Now expand the Toolbox, 
  and locate RichTextBox, under Common Controls:</p>
<p align="center"><img src="images/menus/richTextBox-2.gif" width="187" height="140" alt="The RichTextBox control in C# .NET" border="1"></p>
<p>Double click to add a <b>RichTextBox</b> to your form. You may have to adjust 
  the height and width of your form, and reposition other controls. But your form 
  should look like this, when you've added the RichTextBox:</p>
<p align="center"><img src="images/menus/Form_RichTB-2.gif" width="461" height="365" alt="A RichTextBox control on a Windows Form"></p>
<p>The RichTextBox is the one at the bottom - it looks exactly the same as a normal 
  text box, but you can do more with it. One Method it does have is called <b>LoadFile</b>( 
  ). We'll use this to load a text file.</p>
<p>Now that we've added the RichTextBox, we can add some code. So, access the 
  code stub for you <b>File &gt; Open</b> menu item. It should look like this:</p>
<p align="center"><img src="images/menus/File_Open_ofd-2.gif" width="394" height="69" alt="The Open code stub" border="1"></p>
<p>We can add the same lines as before. So add this to your code:</p>
<p class="indent_small">string Chosen_File = &quot;&quot;;</p>
<p class="indent_small">openFD.InitialDirectory = &quot;C:&quot;;<br>
  openFD.Title = &quot;Open a Text File&quot;;<br>
  openFD.FileName = &quot;&quot;;</p>
<p>The only thing we've changed here is the Title property. For the next line, 
  we can add the Filters:</p>
<p align="center"><b>openFD.Filter = &quot;Text Files|*.txt|Word Documents|*.doc&quot;;</b></p>
<p>The RichTextBox can open plain text files as well as Word documents, so we've 
  added both of these to the Filter property. (It can't handle Word documents 
  very well, though.)</p>
<p>The next thing to do is to display the Open File Dialogue box, so that a file 
  can be selected. Add the following to your code:</p>
<p class="indent_small"> if (openFD.ShowDialog() != DialogResult.Cancel)<br>
  {</p>
<p class="indent_big">Chosen_File = openFD.FileName;<br>
  richTextBox1.LoadFile(Chosen_File, RichTextBoxStreamType.PlainText);</p>
<p class="indent_small">}</p>
<p>This is more or less the same as before. But notice the line that adds the 
  text file to RichTextBox:</p>
<p align="center">richTextBox1.LoadFile(Chosen_File, <b>RichTextBoxStreamType</b>.PlainText);</p>
<p>You'll see a better way to open up a text file later in the course. For now, 
  run your programme and test that it works. You should be able to add plain text 
  file to the RichTextBox. </p>
<p>&nbsp;</p>
<p>In the next lesson, you'll see how to add a Save As dialogue box to your C# 
  programmes.</p>
</SECTION> </ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s4p9-2.html">&lt;-- Open File Dialogue 
          Box </a> | <a href="csharp_s4p11-2.html">Save As Dialogue Box --&gt;</a></p>
		<P><A HREF="csharp-2.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukcsharp/csharp_s4p10.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:09:10 GMT -->
</HTML>

