<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.uk/csharp/csharp_s12p5.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 06:56:48 GMT -->
<HEAD>
		<TITLE>Connecting to a SQL Server Express Database</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-2.css">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free C# .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
		<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">C#.NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-2.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2010.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign.html">Web Design</a></LI>
<LI><a href="../javascript/javascript.html">Javascript</a></LI>
<LI><a href="../NET/vbNet.html">Visual Basic .NET</a></LI>
<LI><a href="../php/php.html">Beginners PHP</a></LI>
<LI><a href="csharp.html">C# .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../java/java.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Connect to a SQL Server Express Database with C# .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageCsharp()
			</script>
</p>
<P>&nbsp;</P>
<P>Close your entire Project down from the previous section (<b>File &gt; Close 
  Project</b> or <b>Close Solution</b>), because we're going to be copying the 
  database we just created. We're doing this so that we don't run into any problems 
  with this error:</P>
<p align="center">&quot;An attempt to attach an auto-named database ...&quot;</p>
<p>To find your database, have a look in your Visual Studio Projects folder, usually 
  located in the <b>Documents</b> folder. Find the folder with the name of the 
  Project you just closed down. You should see the <b>Employees.sdf</b> file. 
  If you can't find it that way, do a search through the Windows Start menu.</p>
<p>Once you've found the database, copy the SDF file to the Documents folder (My 
  Documents in Windows XP). You can create a new folder for this. Call it databases. 
  Copy your database to this new folder.</p>
<p>Now that you have moved the database, create a New project in C# (<b>File &gt; 
  New Project</b>). Give it the name <b>employees_database</b>.</p>
<P>&nbsp;</P>
<h3>Connecting to a SQL Server Express Database</h3>
<p>To connect to a database using SQL Server Express, you first need to set up 
  a SQL Connection object. You then need something called a connection string 
  to tell C# where the database is. </p>
<p>If you're using a Compact SQL Server database (Local Dataase) then the easiest 
  connection object to use is the <b>SqlServerCe</b> object. If you have Visual 
  Studio Express 2012, however, you need to add a reference in order to get the 
  various SqlServerCe objects. From the menu bar at the top of Visual Studio Express 
  2012 click <b>Project</b>. From the Project menu, select <b>Add Reference</b>. 
  You'll then see the following dialogue box appear:<br>
</p>
<P align="center"><img src="images/csharp_2012/chapter_databases/SqlServerCe_reference.gif" width="692" height="342" alt="Adding a reference to the SqlServerCe objects in C# .NET 2012"></P>
<P>On the left hand side, click on the <b>Extensions</b> item, you'll then see 
  a list of objects you can add to your project. Scroll down to near the bottom 
  and you'll see an item for <b>System.Data.SqlServerCe</b>. You may see two of 
  these, a later version and an earlier version. Hold your mouse over the latest 
  version and you'll see a checkbox appear. Put a check in the checkbox and then 
  click OK. You will now be able to use the <b>SqlServerCe</b> objects.</P>
<p>To set up a <b>SqlServerCe</b> connection variable, double click the blank 
  form. Just outside of the Form Load event add the following:</p>
<p class="indent_small">System.Data.SqlServerCe.SqlCeConnection con;</p>
<p>When you type a dot after <b>SqlServerCe</b> you'll see lots of SqlCe objects 
  appear. We're using the <b>SqlCeConnection</b> object and giving it the name 
  con.</p>
<p>Inside of the Form Load event, we can create a new con object. Add the following 
  line:</p>
<P class="indent_small">con = new System.Data.SqlServerCe.SqlCeConnection();</P>
<P>A connection object needs a connection string. This points the connection object 
  to where your database is. Add the following line to your code:</P>
<p class="indent_small">con.ConnectionString = &quot;Data Source=C:\\Users\\Owner\\Documents\\Employees.sdf&quot;;</p>
<p><b>ConnectionString</b> is a Property of connection objects. After an equal 
  sign, you type the path to your database file. The path needs to go after the 
  text &quot;Data Source=&quot;. Notice where all the double quotes are. Notice, 
  too, that we've used two backslash characters. The backslash character is considered 
  a special character in C# programming, so it needs to be escaped. To escape 
  a backslash character (or any other character) just type another backslash before 
  it.</p>
<p>To try to open a connection, you need to issue the Open command:</p>
<p class="indent_small">con.Open( );</p>
<p>Next, add message box to see if everything is working OK:</p>
<P>Next, add message box to see if everything is working OK:</P>
<p class="indent_small">MessageBox.Show(&quot;Connection Open&quot;);</p>
<p>If you have opened a connection, then you need to close it:</p>
<p class="indent_small">con.Close( );</p>
<p>Once you've added the lines above, you code should look like this:</p>
<P align="center"><img src="images/csharp_2012/chapter_databases/con_new/con_code_1.gif" width="676" height="206" alt="C# Code to open a connection to a SDF database"></P>
<P>Run your programme and you should see the message box appear when you click 
  your button.</P>
<p>Stop your programme and return to your code. You can delete or comment out 
  the message box.</p>
<P>In th enext section below, we'll take a look at DataSets and DataAdapters.</P>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<p align="right"><a href="csharp_s12p4.html">&lt;-- Add Data to a SQL Server Express Table</a> | <a href="csharp_s12p6.html">DataSets and DataAdapters --&gt;</a></P>
		<P><A HREF="csharp.html">Back to the C# NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.uk/csharp/csharp_s12p5.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 06:56:48 GMT -->
</HTML>

