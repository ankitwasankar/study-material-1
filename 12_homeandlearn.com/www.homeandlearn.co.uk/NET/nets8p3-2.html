<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:05 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Reading a Text File Line by Line</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Reading a Text File Line by Line</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p><i>This lesson is part of an ongoing tutorial. The first part is here: <a href="nets8p2-2.html">How 
  to open a Text File in VB .NET</a></i></p>
<p align="left">&nbsp;</p>
<p align="left">Quite often, you don't want to read the whole file at once. You 
  want to read it line by line. In which case, instead of using the <b>ReadToEnd</b> 
  method, as we did in the <a href="nets8p2-2.html">previous section</a>, you can 
  use the <b>ReadLine</b> method:</p>
<p>The ReadLine method, as its name suggests, reads text one line at a time. In 
  order to do this, though, you need to use a loop. You can then loop round each 
  line and read it into a variable. Here's a coding example:</p>
  
<p class="indent_small_blue_no_bold">Dim TextLine As String</p>
<p class="indent_small_blue_no_bold">Do While objReader.Peek() &lt;&gt; -1</P>
  
<P class="indent_big_blue_no_bold">TextLine = TextLine &amp; objReader.<b>ReadLine</b>() 
  &amp; vbNewLine</P>
  <P class="indent_small_blue_no_bold">Loop</p>
  
<p>The first line of the <b>Do While</b> loop is rather curious:</p>
<p align="center"><b>Do While objReader.Peek() &lt;&gt; -1</b></p>
<p>The <b>Peek</b> method takes a peek at the incoming text characters. It's looking 
  ahead one character at a time. If it doesn't see any more characters, it will 
  return a value of minus 1. This will signify the end of the text file. Our loop 
  checks for this minus 1, and bails out when <b>Peek</b> has this value.</p>
<p>Inside the loop, we're reading each line from the text file and putting into 
  new variable. (We're also adding a new line character on the end. Delete the 
  <b>&amp; vbNewLine</b> and see what happens). </p>
<p align="center"><b>objReader.ReadLine()</b></p>
<p>So the <b>ReadLine</b> method reads each line for you, instead of the ReadToEnd 
  method which gets the whole of the text file.</p>
<p>Once you have a line of text in your variable, though, it's up to you to parse 
  it. For example, suppose the line of text coming in from the text file was this:</p>
<p align="center"><b>&quot;UserName1, Password1, UserName2, Password2&quot;</b></p>
<p>You would then have to chop the line down and do something which each segment. 
  VB won't do this for you! (But you saw how to do this in the last section, when 
  you used things like <a href="nets7p7-2.html">Split</a> and <a href="nets7p5-2.html">Substring</a>.)</p>
<p>But what you are doing in the Do Loop is building up your variable with lines 
  of text that are pulled from your text file. Once you have pulled all the text 
  from your file, you can then put it into the text box. Here's our programme 
  once more, with the new code highlighted in bold text:</p>
<p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;</P>
  <P class="indent_small_blue">Dim TextLine As String</p>
  
<p class="indent_small_blue_no_bold">If System.IO.File.Exists( FILE_NAME ) = True Then</p>
<p class="indent_big_blue_no_bold">Dim objReader As New System.IO.StreamReader(FILE_NAME)</p>

<p class="indent_big_blue">Do While objReader.Peek() &lt;&gt; -1</P>
  <P class="indent_bigger_blue">TextLine = TextLine &amp; objReader.ReadLine() &amp; vbNewLine</P>
  <P class="indent_big_blue">Loop</p>
<p class="indent_big_blue">Textbox1.Text = TextLine</p>

<p class="indent_small_blue_no_bold">Else</p>
<p class="indent_big_blue_no_bold">MsgBox(&quot;File Does Not Exist&quot;)</p>
<p class="indent_small_blue_no_bold">End If</p>
<p>So inside the loop, we go round building up the <b>TextLine</b> variable. Once 
  all the file has been read (when Peek() has a value of -1), we then place it 
  into <b>Textbox1</b>.</p>
<p>&nbsp;</p>
<p>In the next part, you'll learn how to write to a text file.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets8p4-2.html">Learn how to Write to a Text File with VB .NET --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:05 GMT -->
</HTML>

