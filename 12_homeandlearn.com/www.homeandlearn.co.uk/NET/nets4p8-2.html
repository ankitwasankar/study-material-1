<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets4p8.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:06:44 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - How to Select a File from the Open File Dialogue Box</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Select a File from the Open File Dialogue Box</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p align="center"><b>This tutorial is part of an ongoing lesson. Click <a href="nets4p6-2.html">here</a> 
  for the first part.</b></p>
<p>You'll notice from the <a href="nets4p7-2.html">previous section</a> that if 
  you select a file and click the Open button, nothing happens. That's because 
  the Open dialogue boxes doesn't actually open files! It only displays a list 
  of files that CAN be opened, if you were clever enough to write the code. We'll 
  be writing the code that does the opening (and the saving) in a later section. 
  But you need to be able to get the name of the file. The Open Dialogue box has 
  a property that returns the file name that was selected. Not surprisingly, it's 
  called FileName:</p>
<p class="indent_big_blue">OpenFD.FileName</p>
<p>However, this is a property that returns a value (a string value). The value 
  is the name of a file. So you have to assign this value to something. We can 
  assign it to a new variable:</p>
<p class="indent_big_blue">Dim strFileName As String</p>
<p class="indent_big_blue">strFileName = OpenFD.FileName</p>
<p>The value in the variable <b><font color="#0000FF">strFileName</font></b> will 
  then hold the name of the file selected. So change you code to this (new lines 
  in bold):</p>
<p class="indent_big_blue">Dim strFileName As String</p>
<p class="indent_big_blue">openFD.InitialDirectory = &quot;C:\&quot;<br>
  openFD.Title = &quot;Open a Text File&quot;<br>
  openFD.Filter = &quot;Text Files|*.txt&quot;<br>
  openFD.ShowDialog()<br>
  strFileName = OpenFD.FileName</p>
<p class="indent_big_blue">MessageBox.Show( strFileName )</p>
<p>Run your programme, and click your <b>File &gt; Open</b> menu. Navigate to 
  where you have some text files. Click one to select it. Then click the <b>Open</b> 
  button. You should see the name of the file displayed in your message box:</p>
<p align="center"><img src="images/openFD7-2.gif" alt="The selected file has been returned"></p>
<p align="left">Notice that the location (the path) of the file is also displayed.</p>
<p>One thing you may have noticed is that if you select a file, then click the 
  Cancel button, the message box still displays. But it will be blank, or just 
  say OpenFileDialog1. In your code, you will only want to do something with a 
  file if the Cancel button is NOT clicked. </p>
<p>You can test to see if it was clicked by assigning the openFD.ShowDialog() 
  to an integer:</p>
<p class="indent_big_blue">Dim DidWork As Integer = openFD.ShowDialog()</p>
<p>You can then test what is inside of the DidWork variable. If the cancel button 
  is clicked, the result of the action is stored by VB.NET in this property:</p>
<p align="center"><b>DialogResult.Cancel</b></p>
<p>You can compare the two in an if statement:</p>
<p class="indent_small_blue">If DidWork = DialogResult.Cancel Then</P>
<P class="indent_big_blue">MsgBox(&quot;Cancel Button Clicked&quot;)</P>
<P class="indent_small_blue">Else</P>
<P class="indent_big_blue">strFileName = openFD.FileName<BR>
  MsgBox(strFileName)</P>
<P class="indent_small_blue">End If</p>
<p>In the code above, you're only opening the file if the Open button was clicked. 
  The code is a bit more complicated, but study it for a while and it will make 
  sense!</p>
<p>In the next part, we'll take a look at how to code for the Save menu.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets4p9-2.html">Click here to see how to code for the Save menu--&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets4p8.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:06:44 GMT -->
</HTML>

