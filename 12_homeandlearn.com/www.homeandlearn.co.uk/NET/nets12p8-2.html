<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p8.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:20 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Coding for the Navigate Buttons</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Coding for the Navigate Buttons</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>Part of an ongoing tutorial. This lessons is part of an ongoing tutorial. The 
  first part is here: </p>
<p align="center"><a href="nets12p4-2.html">Coding your own VB .NET database projects</a></p>
<p align="center">&nbsp;</p>
In <a href="nets12p7-2.html">the last lesson</a>, you set up a Form with four buttons 
and two textboxes. In this lesson, you'll add the code for the buttons. 
<p>&nbsp;</p>
<h3>How to Move Forward One Record at a Time</h3>
<p>Double click your <b>Next Record</b> button to access the code. Add the following 
  If &#133; Else Statement:</p>
  
<p class="indent_small_blue">If inc &lt;&gt; MaxRows  - 1 Then</P>
  <P class="indent_big_blue">inc = inc + 1</P>
  <P class="indent_big_blue">NavigateRecords()</P>
  <P class="indent_small_blue">Else</P>
  <P class="indent_big_blue">MsgBox(&quot;No More Rows&quot;)</P>
  <P class="indent_small_blue">End If</p>
  
<p>We're checking to see if the value in <b>inc</b> does not equal the value in 
  <b>MaxRows</b> - 1. If they are both equal then we know we've reached the last 
  record in the DataSet. In which case, we just display a message box. If they 
  are not equal, these two lines get executed:</p>
  
<p class="indent_small_blue">inc = inc + 1<br>
  NavigateRecords()</p>
<p>First, we move the <b>inc</b> counter on by one. Then we call the Sub we set 
  up:</p>
<p class="TextIndent3"><b>NavigateRecords()</b></p>
<p>Our Subroutine is where the action takes place, and the values from the DataSet 
  are placed in the textboxes. Here it is again:</p>
  
<p class="indent_small_blue">Private Sub NavigateRecords()</p>
<p class="indent_big_blue">txtFirstName.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(1)<br>
  txtSurname.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(2)</p>
<p class="indent_small_blue">End Sub</p>

<p>The part that moves the record forward (and backwards soon) is this part:</p>
<p align="center"><b>Rows( inc )</b></p>
<p>Previously, we hard-coded this with:</p>
<p align="center"><b>Rows( 0 )</b></p>
<p>Now the value is coming from the variable called <b>inc</b>. Because we're 
  incrementing this variable with code, the value will change each time the button 
  is clicked. And so a different record will be displayed.</p>
<p>You can test out your Next button. Run your programme and click the button. 
  You should now be able to move forward through the DataSet. When you get to 
  the end, you should see the message box display &quot;No More Rows&quot;.</p>
<p>None of the other button will work yet, of course. So let's move backwards.</p>
<p align="left">&nbsp;</p>
<h3>Move Back One Record at a Time</h3>
<p>To move backwards through the DataSet, we need to decrement the <b>inc</b> 
  counter. All this means is deducting 1 from whatever is currently in inc.</p>
<p>But we also need to check that inc doesn't go past zero, which is the first 
  record in the DataSet. Here's the code to add to your <b>btnPrevious</b>:</p>
  
<p class="indent_small_blue">If inc &gt; 0 Then</P>
  <P class="indent_big_blue">inc = inc - 1</P>
  <P class="indent_big_blue">NavigateRecords()</P>
  <P class="indent_small_blue">Else</P>
  <P class="indent_big_blue">MsgBox(&quot;First Record&quot;)</P>
  <P class="indent_small_blue">End If</p>
  
<p>So the If statement first checks that <b>inc</b> is greater than zero. If it 
  is, inc gets 1 deducted from. Then the NavigateRecords() subroutine gets called. 
  If <b>inc</b> is zero or less, then we display a message.</p>
<p>When you've finished adding the code, test your programme out. Click the Previous 
  button first. The message box should display, even though no records have been 
  loaded into the textboxes. This is because the variable <b>inc</b> has a value 
  of -1 when the form first loads. It only gets moved on to zero when the Next 
  button is clicked. You could amend your IF Statement to this:</p>
<p class="indent_small_blue">If inc &gt; 0 Then</P>
  <P class="indent_big_blue">inc = inc - 1</P>
  <P class="indent_big_blue">NavigateRecords()</P>
  <P class="indent_small_blue">ElseIf inc = -1 Then</P>
  <P class="indent_big_blue">MsgBox(&quot;No Records Yet&quot;)</P>
  <P class="indent_small_blue">ElseIf inc = 0 Then</P>
  <P class="indent_big_blue">MsgBox(&quot;First Record&quot;)</P>
  <P class="indent_small_blue">End If</p>
  
<p>This new If Statement now checks to see if inc is equal to minus 1, and displays 
  a message if it does. It also checks if inc is equal to zero, and displays the 
  &quot;First Record&quot; message box. </p>
<p>&nbsp;</p>
<h3>Moving to the Last Record in the DataSet</h3>
<p>To jump to the last record in the DataSet, you only need to know how many records 
  have been loaded into the DataSet - the <b>MaxRows</b> variable in our code. 
  You can then set the <b>inc</b> counter to that value, but minus 1. Here's the 
  code to add to your <b>btnLast</b>:</p>
  
<p class="indent_small_blue">If inc &lt;&gt; MaxRows - 1 Then</P>
  <P class="indent_big_blue">inc = MaxRows - 1</P>
  <P class="indent_big_blue">NavigateRecords()</P>
  <P class="indent_small_blue">End If</p>
<p>The reason we're saying <b>MaxRows - 1</b> is that the row count might be 5, 
  say, but the first record in the DataSet starts at zero. So the total number 
  of records would be zero to 4. Inside of the If Statement, we're setting the 
  <b>inc</b> counter to MaxRows - 1, then calling the NavigateRecords() subroutine.</p>
<p>That's all we need to do. So run your programme. Click the Last button, and 
  you should see the last record displayed in your textboxes.</p>
<p>&nbsp;</p>
<h3>Moving to the First Record in the DataSet</h3>
<p>Moving to the first record is fairly straightforward. We only need to set the 
  <b>inc</b> counter to zero, if it's not already at that value. Then call the 
  Sub:</p>
  
<p class="indent_small_blue">If inc &lt;&gt; 0 Then</P>
  <P class="indent_big_blue">inc = 0</P>
  <P class="indent_big_blue">NavigateRecords()</P>
  <P class="indent_small_blue">End If</p>
  
<p>Add the code to your <b>btnFirst</b>. Run your programme and test out all of 
  your buttons. You should be able to move through the names in the database, 
  and jump to the first and last records.</p>
<p>As yet, though, we don't have a way to add new records, to update records, 
  or to delete them. Let's do that next.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets12p9-2.html">Learn how to Add, Update and Delete Records --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p8.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:20 GMT -->
</HTML>

