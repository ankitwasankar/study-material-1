<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p2.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:05 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - How to Open a Text File</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">How to Open a Text File in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>The ability to open up a text file and read its contents can be very useful 
  to you in your programming life. You might have a text file containing quiz 
  questions and answers, for example. You could read the questions and answers 
  from a text file and create your own &quot;Who wants to be a Millionaire&quot; 
  game. Or you might want to save some data associated with your programme, and 
  then open it up again when the programme starts. Well see how to open up a text 
  file in VB .NET right now. In a later section, you'll learn how to save data 
  to a text file.</p>
  <hr width="70%">
  <p>&nbsp;</p>
  <p>To open up a text file, you need to create something called a &quot;<b>StreamReader</b>&quot;. 
    This, as its name suggests, reads streams of text. The <b>StreamReader</b> 
    is an object available to <b>System.IO</b>. You create a StreamReader like 
    this (if you have Windows XP, you can just use <b>C:\test.txt</b> instead 
    of the longer file name we use for these text file tutorials):</p>
  <p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;</p>
  
<p class="indent_small_blue_no_bold">Dim objReader As New System.IO.<b>StreamReader(</b> 
  FILE_NAME <b>)</b></p>
  <p> The first line just sets up a string variable called FILE_NAME. We store 
    the path and name of our text file inside of the string variable:<br>
  </p>
  <p class="indent_big_blue">= &quot;C:\Users\Owner\Documents\test.txt&quot;</p>
  <p>We're saying that there is a text file called test which is at the location 
    (path) &quot;C:\&quot;.</p>
  <p>You set up the <b>StreamReader</b> to be a variable, just like a String or 
    Integer variable. But we're setting up this variable differently:</p>
  
<p class="indent_big_blue_no_bold">Dim objReader As New System.IO.<b>StreamReader( 
  </b>FILE_NAME <b>)</b></p>
  <p>We've called the variable <b>objReader</b>. Then, after the &quot;<b>As</b>&quot; 
    word comes &quot;<b>New</b>&quot;. This means &quot;Create a New Object&quot;. 
    The type of object we want to create is a <b>StreamReader</b> object:</p>
  <p align="indent_big_blue">System.IO.StreamReader</p>
  <p><b>Sysytem</b> is the main object. <b>IO</b> is an object within System. 
    And <b>StreamReader</b> is an object within IO. </p>
  <p>StreamReader needs the name of a file to Read. This goes between a pair of 
    round brackets:</p>
  
<p class="indent_big_blue_no_bold">System.IO.StreamReader( <b>FILE_NAME</b> )</p>
  
<p>VB will then assign all of this to the variable called <b>objReader</b>. So 
  instead of assigning say 10 to an Integer variable, you are assigning a StreamReader 
  to a variable.</p>
<p>&nbsp;</p>
<h3>Read To End</h3>
<p>But this won't do you any good. We haven't actually opened the text file yet. 
  We've just told VB where the text file is and what object to open it with. You 
  do the opening like this:</p>
<p class="indent_big_blue_no_bold">TextBox1.Text = objReader.<b>ReadToEnd</b></p>
<p>Now that objReader is an object variable, it has its own properties and methods 
  available for use (in the same way that the textbox has a Text property).</p>
<p>One of the Methods available to our new StreamReader variable is the ReadToEnd 
  method. This will read the whole of your text, right to the end. We're then 
  popping this in a textbox.</p>
<p>Let's test all this theory out. Do the following:</p>
<ul>
  <li>Start a new project </li>
  <li>Add a textbox to your new form, and just leave it on the default Name of 
    Textbox1</li>
  <li>Set its MultiLine property to True </li>
  <li>Add a Button to your form</li>
  <li>Double click the button and add the following code for it: </li>
</ul>
<p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;</p>
<p class="indent_small_blue_no_bold">Dim objReader As New System.IO.<b>StreamReader(</b> 
  FILE_NAME <b>)</b></p>
<p class="indent_small_blue_no_bold">TextBox1.Text = objReader.<b>ReadToEnd</b></p>
<p class="indent_small_blue_no_bold">objReader.<b>Close()</b></p>
<p>The last line closes the StreamReader we set up. You have to close your stream 
  objects after you&#146;ve used them, otherwise you&#146;ll get errors messages.</p>
<p>When you&#146;re done, run your programme and click your Button.</p>
<p>Unless you already have a file called <b>test.txt </b>at the location specified 
  you&#146;ll get this error message popping up:<br>
</p>
<p align="center"><img src="images/vb_2010/FileNotFound-2.gif" alt="FileNotFound Error message in VB NET"></p>
<p align="left">The last line spells it out clearly: Could not find file &quot;C:\Users\Owner\Documents\test.txt&quot;. 
  So we were trying to read a text file that doesn't exist.</p>
<p align="left">&nbsp;</p>
<p align="center"><font face="Verdana, Arial, Helvetica, sans-serif"><a href="../bookshop/net-2.html">No 
  more reading these lessons online - get the eBook here!</a></font> </p>
<p>&nbsp;</p>
<h3 align="left">Does the File Exist?</h3>
<p>You can, though, test to see if the file exists. If it does, you can open it; 
  if not, you can display an error message. Amend your code to this (the new lines 
  are in bold):</p>
<p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;</p>
<p class="indent_small_blue">If System.IO.File.Exists(FILE_NAME) = True Then</P>
  <P class="indent_big_blue_no_bold">Dim objReader As New System.IO.StreamReader(FILE_NAME)<br>
  TextBox1.Text = objReader.ReadToEnd<br>
  objReader.Close()</P>
  <P class="indent_small_blue">Else</P>
  <P class="indent_big_blue">MsgBox(&quot;File Does Not Exist&quot;)</P>
  <P class="indent_small_blue">End If></p>
<p>We've now wrapped up our code in an If Statement. The first line of the If 
  Statement is this:</p>
<p class="indent_small_blue_no_bold">If System.IO.<b>File.Exists( </b>FILE_NAME 
  <b>)</b> = True Then</p>
<p>This tests to see whether or not a file exists. Again, you start with <b>System.IO</b>. 
  Then you access another object of System.IO - the <b>File</b> object. This has 
  a method called <b>Exists</b>. In between the round brackets, you type the name 
  (or variable) of the file you want to check. The value returned will either 
  be True (if it does exists), or False (if it doesn't).</p>
<p>If the file exist then we can go ahead and create our StreamReader; If it doesn't, 
  we can display a error message for the user.</p>
<p>So that your programme will work, there is a file below called &quot;test.txt&quot;. 
  Download this to your computer, either in the main <b>C:\</b> folder for XP 
  users, or the Documents folder if you have Vista/Windows7. (Right click the 
  file and select Save Target As (IE), or Save Links As (Firefox):</p>
<p align="center"><a href="test-2.txt">Download the &quot;test.txt&quot; Text File 
  here</a></p>
<p>When you have done that, run your programme again. Click the button once more, 
  and you should see the text from your file appear in the textbox. (If you get 
  the error message again, it means you haven't copied the file to the right place.)</p>
<p>&nbsp;</p>
<p>In the next part, we'll see how to read the contents line by line, instead 
  of all in one go.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets8p3-2.html">Learn how to read a text file line by line -- &gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p2.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:05 GMT -->
</HTML>

