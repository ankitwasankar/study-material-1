<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets10p2.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:14 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - The MouseDown Event</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">The MouseDown Event in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>The MouseDown event is available to many controls on the form. A Form can detect 
  when the mouse was held down on it; a textbox can detect when the mouse was 
  held down inside of it; and a Button can detect which mouse button was held 
  down to do the clicking.</p>
<p>We'll see how it all works right now.</p>
<p>&nbsp;</p>
<p>First, delete the all but one of the buttons on your form. (You can right click 
  on a control to delete it. If you haven't been following along from the <a href="nets10p1-2.html">previous 
  lesson</a>, then just create a new project. Add a Button to your form, and leave 
  iton the default name of Button1.) </p>
<p>Go back to your coding window, and delete any code for the button on your form. 
  Delete any Handles code except for Handles Button1.Click. Your coding window 
  should look something like this one (we've used underscores to spread the code 
  out over three lines):</p>
<p align="center"><img src="images/EventMouseDown-2.gif" alt="The coding window, with the Event at the top" border="1"></p>
<p align="left">Right at the top of the code window, it says <b>Button1</b> and 
  <b>Click</b>. The lightning bolt next to Click signifies that it is an Event. 
  If you click the drop down box, you'll see a list of other available events:</p>
<p align="center"><img src="images/EventMouseDown2-2.gif" alt="Select the MouseDown event from the list"></p>
<p align="left">Scroll down and find the MouseDown event, as in the image above. 
  When you click on it, a new code stub appears, this one (ours looks a bit messy):</p>
<p class="indent_small_blue_no_bold">Private Sub <b>Button1_MouseDown</b>(ByValsender 
  As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles <b>Button1.MouseDown</b></p>
<p class="indent_small_blue_no_bold">End Sub</p>
<p>This is a Private Subroutine called <b>Button1_MouseDown</b>. Notice that it 
  <b>Handles</b> the Button1 <b>MouseDown</b> event, and not Button1.Click.</p>
<h2>&nbsp;</h2>
<h3>Exploring the Event Arguments</h3>
<p>In between the round brackets of the Subroutine, we still have ByVal sender 
  As Object. But we have a new argument now (2012 users will just see <b>e As 
  MouseEventArgs</b>):</p>
<p align="center"><b>ByVal e As System.Windows.Forms.MouseEventArgs</b></p>
<p>The name of the variable is still <b>e</b>. But the type of Object being stored 
  inside of the e variable is different:</p>
<p align="center"><b>System.Windows.Forms.MouseEventArgs</b></p>
<p>The bit on the end of all that is what we're interested in: <b>MouseEventArgs</b>. 
  This stands for Mouse Events Arguments. What is being stored inside of the e 
  variable is information the Mouse Event: Did you click a button, if so which 
  one?</p>
<p>The only thing you need to do to detect which button was pressed is to access 
  a property of the <b>e</b> variable. Let's see how to do that.</p>
<p>&nbsp;</p>
<h3>Which Button was Clicked?</h3>
<p>Inside of the Button1_MouseDown Subroutine, type the following code:</p>
<p class="indent_small_blue_no_bold">If e.Button = MouseButtons.Right Then</P>
<P class="indent_big_blue_no_bold">MsgBox(&quot;Right Button Clicked&quot;)</P>
<P class="indent_small_blue_no_bold">End If</p>
<p>As soon as you type the letter &quot;e&quot;, you'll see this pop up box:<br>
</p>
<p align="center"><img src="images/EventMouseProps-2.gif" alt="Properties and Methods of the Event"></p>
<p align="left">To detect which button was clicked, you need the first Property 
  on the list: <b>Button</b>. Double click this property to add it to your code. 
  Then after you typed the equals sign, another pop up list appears. This one:</p>
<p align="center"><img src="images/EventMouseProps2-2.gif" alt="Select a Mouse Button to detect"></p>
<p align="left">This is a list of available buttons that VB can detect. Left and 
  Right are the ones you'll use most often.</p>
<p align="left">When you've added the If Statement, your coding window should 
  look something like this:</p>
<p align="center"><img src="images/EventCode-2.gif" border="1" alt="VB NET Code for MouseDown Event"></p>
<p>When you're finished writing your code, run your programme. Click the button 
  with your Left mouse button and nothing will happen. Click it with the Right 
  mouse button and you should see the message box display. </p>
<p>&nbsp;</p>
<p class="links_ads"><a href="../bookshop/net-2.html">No more reading these lessons 
  online - get the eBook here!</a></p>
<p>&nbsp;</p>
<h3>MouseDown and the Form</h3>
<p>Stop your programme. When you are returned to the coding environment, click 
  the down arrow of Button1 at the top of the code. You'll see a drop down box 
  like this:</p>
<p align="center"><img src="images/EventForm-2.gif" alt="Form1 Events"></p>
<p align="left">Select the one highlighted in the image, &quot;Form1 Events&quot;. 
  In the Events box to the right, select MouseDown from the list of available 
  events. A new code stub will appear:</p>
<p class="indent_small_blue_no_bold">Private Sub Form1_MouseDown( ByVal sender 
  As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles MyBase.MouseDown</p>
<p class="indent_small_blue_no_bold">End Sub</p>
<p align="left">This time, we have a Private Subroutine called <b>Form1_MouseDown</b>. 
  The two arguments are exactly the same as before. The difference is that now 
  this code Handles the MouseDown event for something called <b>MyBase</b>. (This 
  is an object that refers to the code for Public Class Form1.)</p>
<p>The important thing to bear in mind is that we now have a way to detect when 
  a mouse button was clicked on the form itself.</p>
<p>Add the following code inside of Form1_MouseDown:</p>
<p class="indent_small_blue">If e.Button = MouseButtons.Right Then</P>
<P class="indent_big_blue">MsgBox(&quot;You clicked on the Form&quot;)</P>
<P class="indent_small_blue">End If</p>
<p align="left">The only thing that has changed is the Message Box! The If Statement 
  is exactly the same. Run your programme and test it out. Click anywhere on your 
  Form, and you should see the new message box. However, if you right click on 
  the button, you'll get the old message box. Although the button is on the Form, 
  this is considered a separate control from the Form itself. So it has its own 
  events.</p>
<p>You can detect where on the Form the mouse was when the right mouse button 
  was click. Amend your code for Form1_MouseDown. Change it to this:</p>
<P class="indent_small_blue">Dim xPos As Integer<br>
  Dim yPos As Integer</P>
<p class="indent_small_blue">If e.Button = MouseButtons.Right Then</P>
<P class="indent_big_blue">xPos = e.X<br>
  yPos = e.Y<BR>
  MsgBox(&quot;The X Position is &quot; &amp; xPos &amp; &quot; The Y Position 
  is &quot; &amp; yPos)</p>
<p class="indent_small_blue">End If</p>
<p align="left">First, we're setting up two integer variable, xPos and yPos. After 
  that we have the same If Statement as before:</p>
<p class="indent_small_blue">If e.Button = MouseButtons.Right Then</p>
<p class="indent_small_blue">End If</p>
<p>Inside of the If Statement, we're using the X and Y properties of the e variable:</p>
<p class="indent_small_blue">xPos = e.X<br>
  yPos = e.Y</p>
<p>The X property returns how far across, from left to right, the mouse is; the 
  Y property returns how far down, from top to bottom, the mouse is. These values 
  are assigned to our two variables. The result is displayed in a message box.<br>
</p>
<p align="left">When you've wrote the code, run your programme and test it out. 
  Right click anywhere on your form. The new message box should display, telling 
  you where the mouse was when the right button was held down.</p>
<p>Click near the top of the form and you'll see the Y position number go down 
  in value; Click near the bottom of the form and you'll see it go up in value. 
  The very top of the form (or a control) has a Y value of zero. </p>
<p>Click from left to right and you'll see the X numbers go up in value. The very 
  left edge of your form has an X value of zero.</p>
<p>&nbsp;</p>
<p>In the next part, we'll explore the KeyDown event.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets10p3-2.html">Learn about the KeyDown Event in VB .NET --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets10p2.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:14 GMT -->
</HTML>

