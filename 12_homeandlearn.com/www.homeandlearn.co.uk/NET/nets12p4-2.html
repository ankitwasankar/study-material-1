<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:18 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Write your own Database code</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Write your own Database code in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>In this next section, we'll take a look at the objects that you can use to 
  open and read data from a Database. We'll stick with our Access database, the 
  AddressBook.mdb one, and recreate what the Wizard has done. That way, you'll 
  see for yourself just what is going on behind the scenes.</p>
<p>So close any open projects, and create a new one. Give it whatever name you 
  like, and let's begin.</p>
<p>If you haven't yet downloaded the Address Book database, you can get it here:</p>
<p align="center"><a href="AddressBook-2.zip">Download the Address Book Database</a></p>
<h2>&nbsp;</h2>
<h3>The Connection Object</h3>
<p>The Connection Object is what you need if you want to connect to a database. 
  There are a number of different connection objects, and the one you use depends 
  largely on the type of database you're connecting to. Because we're connecting 
  to an Access database, we'll need something called the OLE DB connection object.</p>
<p>OLE stands for Object Linking and Embedding, and its basically a lot of objects 
  (COM objects) bundled together that allow you to connect to data sources in 
  general, and not just databases. You can use it, for example, to connect to 
  text files, SQL Server, email, and a whole lot more.</p>
<p>There are a number of different OLE DB objects (called data providers), but 
  the one we'll use is called &quot;<b>Jet</b>&quot;. Others are SQL Server and 
  Oracle. </p>
<p>So place a button on your form. Change the <b>Name</b> property to <b>btnLoad</b>. 
  Double click your button to open up the code window. Add the following line:</p>
<p align="center"><b>Dim con As New OleDb.OleDbConnection</b></p>
<p>The variable <b>con</b> will now hold the <b>Connection Objec</b>t. Notice 
  that there is a full stop after the OleDB part. You'll then get a pop up box 
  from where you can select OleDbConnection. We're also creating a <b>New</b> 
  object on this line.This is the object that you use to connect to an Access 
  database.<br>
</p>
<p>&nbsp;</p>
<p class="links_ads"><a href="../bookshop/net-2.html">No more reading these lessons online - get the eBook here!</a></p>
<p>&nbsp;</p>
<h3 align="left">Setting a Connection String</h3>
<P>There are Properties and Methods associated with the Connection Object, of 
  course. We want to start with the ConnectionString property. This can take MANY 
  parameters . Fortunately, we only need a few of these.</p>
<P>&nbsp;</p>
<P>We need to pass two things to our new <b>Connection Object</b>: the technology 
  we want to use to do the connecting to our database; and where the database 
  is. (If your database was password and user name protected, you would add these 
  two parameters as well. Ours isn't, so we only need the two.)</p>
<p>The technology is called the <b>Provider</b>; and you use <b>Data Source</b> 
  to specify where your database is. So add this to your code:</p>
  
<p class="indent_small_blue">Dim dbProvider As String<br>
  Dim dbSource As String</p>
<p class="indent_small_blue">dbProvider = &quot;PROVIDER=Microsoft.Jet.OLEDB.4.0;&quot;<br>
  dbSource = &quot;Data Source = C:/AddressBook.mdb&quot;</p>
<p class="indent_small_blue">con.ConnectionString = dbProvider &amp; dbSource</p>

<p>The first part specifies which provider technology we want to use to do the 
  connecting (JET). The second part, typed after a semi-colon, points to where 
  the database is. In the above code, the database is on the C drive, in the root 
  folder. The name of the Access file we want to connect to is called AddressBook.mdb. 
  (Note that &quot;Data Source&quot; is two words, and not one.)</p>
<p>If you prefer, you can have the provider and source on one line, as below (it's 
  on two here because it won't all fit on one line):</p>
<p class="indent_small">con.ConnectionString = &quot;PROVIDER=Microsoft.Jet.OLEDB.4.0;Data 
  Source = C:\AddressBook.mdb&quot;</p>
<p> The first part specifies which provider technology we want to use to do the 
  connecting (<b>JET</b>). The second part, typed after a semi-colon, points to 
  where the database is. In the above code, the database is on the C drive, in 
  the root folder. The name of the Access file we want to connect to is called 
  <b>AddressBook.mdb.</b> (Note that &quot;<b>Data Source</b>&quot; is two words, 
  and not one.)</p>
<p>But your coding window should now look like this: 
<p align="center"><img src="images/vb_2010/db_con1-2.gif" border="1"> 
<p>This assumes that you have copied the AddressBook database over to the root 
  folder of your C Drive. If you've copied it to another folder, change the &quot;Data 
  Source&quot; part to match. For example, if you copied it to a folder called 
  &quot;databases&quot; you'd put this:</p>
<p align="center"><b>Data Source = C:\databases\AddressBook.mdb</b></p>
<p>You can also specify a folder such as MyDocuments (or Documents in Vista and 
  Windows 7). You do it like this:</p>
<p align="center"><b>dbSource = &quot;Data Source = C:\Users\Owner\Documents\AddressBook.mdb&quot;</b></p>
<p>Another way to specify a file path is this:</p>

<p class="indent_small_blue">Dim fldr As String<br>
  fldr = Environment.GetFolderPath( Environment.SpecialFolder.MyDocuments ) &amp; &quot;/AddressBook.mdb&quot;</p>
<p class="indent_small_blue">dbSource = &quot;Data Source = &quot; &amp; fldr</p>

<p>On the second line, spread over two lines in the code above, we have this:</p>
<p class="indent_small_blue">Environment.GetFolderPath()</p>
<p>The folder path you're getting goes between the round brackets of GetFolderPath:</p>
<p class="indent_small_blue">Environment.SpecialFolder.MyDocuments</p>
<p>The Special Folder in this case is the MyDocuments folder. <br>
</p>
<p>But back to our connection code. <b>ConnectionString</b> is a property of the 
  <b>con</b> variable. The con variable holds our Connection Object. We're passing 
  the Connection String the name of a data provider, and a path to the database.</p>
<p>&nbsp;</p>
<h3>Opening the Connection</h3>
<p>Now that we have a ConnectionString, we can go ahead and open the datatbase. 
  This is quite easy - just use the <b>Open</b> method of the Connection Object:</p>
<p align="center"><b>con.Open()</b></p>
<p>Once open, the connection has to be closed again. This time, just use the Close 
  method:</p>
<p align="center"><b>con.Close()</b></p>
<p>Add the following four lines to your code:</p>

<p class="indent_small_blue">con.Open()</p>
<p class="indent_small_blue">MsgBox(&quot;Database is now open&quot;)</p>
<p class="indent_small_blue">con.Close()</p>
<p class="indent_small_blue">MsgBox(&quot;Database is now Closed&quot;)</p>

<p>Your coding window will then look like this (use the file path below, if you 
  have Vista or Windows 7, after moving the database to your Documents folder):</p>
<p align="center"><img src="images/vb_2010/db_con2-2.gif" border="1"></p>
<p>Test out your new code by running your programme. Click your button and the 
  two message boxes should display. If they don't, make sure your Data Source 
  path is correct. If it isn't, you might see this error message:</p>
<p align="center"><img src="images/vb_2010/errorAddBook_p275-2.jpg" alt="OleDbException Error"></p>
<P>The error message is a bit on the vague and mysterious side. But what it's 
  saying is that it can't find the path to the database, so it can't Open the 
  connection. The line con.Open in your code will then be highlighted in green. 
  You need to specify the correct path to your database. When you do, you'll see 
  the message boxes from our code, and not the big one above.</p>
<P>&nbsp;</p>
<P>Now that we've opened a connection to the database, we need to read the information 
  from it. This is where the DataSet and the DataAdapter come in.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets12p5-2.html">Learn about the DataSet and DataAdapter --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:18 GMT -->
</HTML>

