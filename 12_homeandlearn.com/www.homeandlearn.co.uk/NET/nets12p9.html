<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.uk/NET/nets12p9.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 07:21:34 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Add, Update and Delete Records</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-2.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-2.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2010.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign.html">Web Design</a></LI>
<LI><a href="../javascript/javascript.html">Javascript</a></LI>
<LI><a href="vbNet.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp.html">C# .NET</a></LI>
<LI><a href="../java/java.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Add, Update and Delete Records</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>Part of an ongoing tutorial. This lessons is part of an ongoing tutorial. The 
  first part is here: </p>
<p align="center"><a href="nets12p4.html">Coding your own VB .NET database projects</a></p>
<p>&nbsp;</p>
<P>In the <a href="nets12p8.html">last section</a>, you learned how to move through 
  the records in your DataSet, and how to display the records in Textboxes on 
  your form. In this lesson, we'll see how to add new records, how to delete them 
  and how to Update a records. </P>
<p>Before we start the coding for these new buttons, it's important to understand 
  that the DataSet is <i><b>disconnected</b></i> from the database. What this 
  means is that if you're adding a new record, you're not adding it to the database: 
  you're adding it to the <b>DataSet</b>! Similarly, if you're updating or Deleting, 
  you doing it to the DataSet, and <b><u>NOT</u></b> to the database. After you 
  have made all of your changes, you THEN commit these changes to the database. 
  You do this by issuing a separate command. But we'll see how it all works.</p>
<p>You'll need to add a few more buttons to your form - five of them. Change the 
  <b>Name</b> properties of the new Buttons to the following:</p>
<p align="center"><b>btnAddNew<br>
  btnCommit<br>
  btnUpdate<br>
  btnDelete<br>
  btnClear</b><br>
</p>
<p>Change the <b>Text</b> properties of the buttons to <b>Add New</b> <b>Record</b>, 
  <b>Commit Changes</b>, <b>Update Record</b>, <b>Delete</b> <b>Record</b>, and 
  <b>Clear/Cancel</b>. Your form might look something like this: </p>
<p align="center"><img src="images/vb_2010/addressBookForm_p290.jpg"></p>
<p>We'll start with the Update Record button</p>
<p>&nbsp;</p>
<h3 align="left">Updating a Record</h3>
<p>To reference a particular column (item) in a row of the DataSet, the code is 
  this:</p>
<p align="center"><b>ds.Tables(&quot;AddressBook&quot;).Rows(2).Item(1)</b></p>
<p>That will return whatever is at Item 1 on Row 2. </p>
<p>As well as returning a value, you can also set a value. You do it like this:</p>
<p align="center"><b>ds.Tables(&quot;AddressBook&quot;).Rows(2).Item(1) = &quot;Jane&quot;</b></p>
<p>Now Item 1 Row 2 will contain the text &quot;Jane&quot;. This won't, however, 
  effect the database! The changes will just get made to the <b>DataSet</b>. To 
  illustrate this, add the following code to your <b>btnUpdate</b>:</p>
<p class="indent_small_blue">ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(1) = txtFirstName.Text<br>
  ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(2) = txtSurname.Text</p>
<p class="indent_small_blue">MsgBox(&quot;Data updated&quot;)</p>
<p>Run your programme, and click the <b>Next Record</b> button to move to the 
  first record. &quot;John&quot; should be displayed in your first textbox, and 
  &quot;Smith&quot; in the second textbox. Click inside the textboxes and change 
  &quot;John&quot; to &quot;Joan&quot; and &quot;Smith&quot; to &quot;Smithy&quot;. 
  (Without the quotes). Now click your <b>Update Record</b> button. Move to the 
  next record by clicking your <b>Next Record</b> button, and then move back to 
  the first record. You should see that the first record is now &quot;Joan Smithy&quot;.</p>
<p>Close down your programme, then run it again. Click the <b>Next Record</b> 
  button to move to the first record. It will still be &quot;John Smith&quot;. 
  The data you updated has been lost! So here, again, is why:</p>
<p align="center"><b>&quot;Changes are made to the DataSet, and NOT to the Database&quot;</b></p>
<p>To update the database, you need some extra code. Amend your code to this (the 
  new lines are in bold, red text):</p>
<p class="indent_small_red">Dim cb As New OleDb.OleDbCommandBuilder(da)</p>
  <p class="indent_small_blue">ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(1) = txtFirstName.Text<br>
  ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(2) = txtSurname.Text</p>
<p class="indent_small_red">da.Update(ds, &quot;AddressBook&quot;)</p>
<p class="indent_small_blue">MsgBox(&quot;Data updated&quot;)</p>
<p>The first new line is this:</p>
<p align="center"><b>Dim cb As New OleDb.OleDbCommandBuilder(da)</b></p>
<p>To update the database itself, you need something called a <b>Command Builder</b>. 
  The Command Builder will build a SQL string for you. In between round brackets, 
  you type the name of your Data Adapter, <b>da</b> in our case. The command builder 
  is then stored in a variable, which we have called <b>cb</b>.</p>
<p>The second new line is where the action is:</p>
<p align="center"><b>da.Update(ds, &quot;AddressBook&quot;)</b></p>
<p>The <b>da</b> variable is holding our Data Adapter. One of the methods of the 
  Data Adapter is <b>Update</b>. In between the round brackets, you need the name 
  of your DataSet (<b>ds</b>, for us). The &quot;<b>AddressBook</b>&quot; part 
  is optional. It's what we've called our DataSet, and is here to avoid any confusion.<br>
</p>
<p>But the Data Adapter will then contact the database. Because we have a Command 
  Builder, the Data Adapter can then update your database with the values from 
  the DataSet.</p>
<p>Without the Command Builder, though, the Data Adapter can't do it's job. Try 
  this. Comment out the Command Builder line (put a single quote before the &quot;D&quot; 
  of Dim). Run your programme again, and then try and update a record. You'll 
  get this error message:</p>
<p align="center"><img src="images/vb_2010/errorAddBook_p292.jpg" alt="InvalidOperationException error"><br>
</p>
<div align="center"></div>
<p>The error is because you haven't got a command builder - a Valid Update Command. 
  <br>
  Delete the comment from your Command Builder line and the error message goes 
  away.</p>
<p>You should now be able to make changes to the database itself (as long as the 
  Access database isn't Read Only). </p>
<p>Try it out. Run your programme, and change one of the records. Click the <b>Update</b> 
  button. Then close the programme down, and load it up again. You should see 
  your new changes displayed in the textboxes.</p>
<h3>Exercise</h3>
<p>There's one slight problem with the code above, though. Try clicking the <b>Update</b> 
  button before clicking the <b>Next Record</b> button. What happens? Do you know 
  why you get the error message? Write code to stop this happening</p>
<p>&nbsp;</p>
<p>In the next part, we'll see how to add a new record.</p>
<p align="center"><a href='../bookshop/net.html'><img src='vbBanBorder.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE></SECTION><FOOTER> 
<P class="course_links"><a href="nets12p10.html">Learn How to Add a Record to the Database --&gt;</a></P>
		<P><A HREF="vbNet.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.uk/NET/nets12p9.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 07:21:34 GMT -->
</HTML>

