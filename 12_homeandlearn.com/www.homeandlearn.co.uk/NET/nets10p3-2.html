<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets10p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:14 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - The KeyDown Event</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">The KeyDown Event in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>&nbsp;</p>
<p>Another useful event is the KeyDown event. As its name suggest, this allows 
  you to detect when a key on the keyboard was held down. This is useful for things 
  like validating text in a textbox.</p>
<p>To test it out, add a textbox to your form. (If you haven't been following 
  the lessons, just start a new project and add a textbox to your new form.). 
  Change the Text property of the textbox to &quot;<b>Press F1 for help</b>.&quot; 
  Locate the <b>TabIndex</b> property in the Property Box, and change it to zero. 
  (The Tab Index sets which control is selected when the Tab key is pressed on 
  the keyboard. By specifying zero as the TabIndex property, you're saying that 
  this should be the first control selected.)</p>
<p>Bring up your code window and click the arrow that reveals the list of controls 
  and objects in your project:</p>
<p align="center"><img src="images/EventKey-2.gif" alt="Select the Textbox Object"></p>
<P>Click on your textbox from the list to select it, as in the image above. Then 
  click the arrow on the Event drop down box to reveal the events available to 
  the textbox. Scroll down and select the KeyDown event:</p>
<p align="center"><img src="images/EventKey2-2.gif" alt="Select the KeyDown Event"></p>
<P>When you select the KeyDown event, a code stub appears:</p>
<p class="indent_small_blue">Private Sub TextBox1_KeyDown(ByVal sender As Object, 
  ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox1.KeyDown</p>
<p class="indent_small_blue">End Sub</p>
<p>The event that is being Handled is the <b>KeyDown</b> event of TextBox1. Notice, 
  though, that there is a slightly different argument in round brackets (just 
  <b>e As KeyEventArgs</b> in version 2012):</p>
<p align="center"><b>ByVal e As System.Windows.Forms.KeyEventArgs</b></p>
<p>Again, the variable name is still <b>e</b>. But now we have something called 
  <b>KeyEventArgs</b> on the end. This means that the variable <b>e</b> will hold 
  information about the Key on the keyboard that you're trying to detect.</p>
<p>&nbsp;</p>
<p class="links_ads"><a href="../bookshop/net-2.html">No more reading these lessons 
  online - get the eBook here!</a></p>
<p>&nbsp;</p>
<p>To see what properties the e variable has available to it, add the following 
  to your TextBox1_KeyDown code:</p>
<p class="indent_small_blue">If e.KeyCode = Keys.F1 Then</P>
<P class="indent_big_blue">TextBox1.Clear()<br>
  MsgBox(&quot;Help!!!&quot;)</P>
<P class="indent_small_blue">End If</p>
<p>As soon as you type the full stop after the letter &quot;e&quot;, you'll see 
  this pop up box:</p>
<p align="center"><img src="images/EventKeyProps-2.gif" alt="List of Properties and Events for KeyDown"></p>
<p>Double click a property to add it to your code. After you type an equals sign, 
  you'll get another pop up box:</p>
<p align="center"><img src="images/EventKeyProps2-2.gif" alt="Select a Key from the list"></p>
<p>The list is a list of keys on your keyboard, some of which you'll have and 
  others that you won't. Scroll down the list until you come to Keys.F1, and double 
  click the item to add it to your code.</p>
<p>The code for the If Statement just clears the textbox and pops up a message.</p>
<p>Try your programme out. Press F1 (If you set TextIndex to zero then the text 
  in the textbox should be selected, and the cursor already flashing. If it's 
  not, click inside of the textbox and then press F1). When the F1 key is pressed, 
  you should see the message box appear. </p>
<p>Another thing you can do is to record the keystrokes a user makes. For example:</p>
<p class="indent_small_blue">Dim RecordText as String</p>
<p class="indent_small_blue">RecordText = RecordText &amp; Chr( e.KeyCode )</p>
<p class="indent_small_blue">MsgBox(RecordText)</p>
<p>The Chr( ) function converts a KeyCode (which is an integer) to its keyboard 
  character.</p>
<p>But try this exercise.</p>
<p>&nbsp;</p>
<h3>Exercise N</h3>
<p>There is an event available to the textbox called <b>Leave</b>. Add another 
  textbox to your form, and write code so that the letters in a postcode are converted 
  to uppercase when the user clicks from your first textbox and into your second 
  textbox.</p>
<p>So your first textbox might read &quot;ts1 4jh&quot;. When the user clicks 
  inside textbox2, the text from textbox1 should change to &quot;TS1 4JH&quot;. 
  The code can be written in the Leave event of textbox1.</p>
<p align="right"><a href = "vb_answers-2.html#exN" target="_blank">Answer to Exercise 
  N </a></p>
<p>&nbsp;</p>
<p>There are an awful lot of Events to explore, and we'll have a look at just 
  one more - the Form Load Event. We'll do that in the next part.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets10p4-2.html">Learn about the Form Load Event in VB .NET --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets10p3.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:14 GMT -->
</HTML>

