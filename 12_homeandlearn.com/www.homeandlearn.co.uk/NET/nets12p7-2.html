<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p7.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:20 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Navigate a Database</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Navigate a Database with VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>&nbsp;</p>
<p>Part of an ongoing tutorial. The first part of Databases and VB .NET can be 
  found here:</p>
<p align="center"><a href="nets12p4-2.html">Coding your own VB .NET database projects</a></p>
<p>&nbsp;</p>
<P>You saw in the <a href="nets12p6-2.html">previous section</a> that you can navigate 
through the records of a database by incrementing or decrementing the Row number 
of the DataSet. In this section, we're going to see a more practical example of 
how to do that.</P>
<p>To navigate through the dataset, let's change our form. By adding some navigation 
  buttons, we can duplicate <a href="nets12p2ed-2.html">what the wizard did</a>. 
  We'll also need to move the code we already have. So let's start with that.</p>
<p>At the moment, all our code is in the Button we added to the form. We're going 
  to delete this button, so we need to move it out of there. The variable declarations 
  can be moved right to the top of the coding window. That way, any button can 
  see the variables. So move your variables declarations to the top, as in the 
  image below (don't forget to add the <b>Dim inc As Integer</b> line):</p>
<p align="center"><img src="images/vb_2010/addressBookCode_p282-2.jpg" border="1"></p>
<P>We can move a few lines to the Form Load event. So, create a Form Load event, 
  as you did in a previous section. Now move all but the textbox lines to there. 
  Your coding window should then look like this (you can delete the message box 
  lines, or just comment them out):</p>
<p align="center"><img src="images/vb_2010/addressBookCode2_p282_B-2.jpg"></p>
<P>For your button, all you should have left are these two lines:</p>
<P class="indent_small_blue">txtFirstName.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(1)<br>
  txtSurname.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(2)</p>
<p>Since we're going to be deleting this button, this code can be moved. Because 
  all the buttons need to put something into the textboxes, the two lines we have 
  left are an ideal candidate for a Subroutine. So add the following Sub to your 
  code:</p>
<p class="indent_small_blue">Private Sub NavigateRecords()</p>
<p class="indent_big_blue">txtFirstName.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(1)<br>
  txtSurname.Text = ds.Tables(&quot;AddressBook&quot;).Rows(inc).Item(2)</p>
<p class="indent_small_blue">End Sub</p>
<p>When we navigate through the DataSet, we'll call this subroutine.</p>
<p>Now that all of your code has gone from your button, you can delete the button 
  code altogether. Return to you form, click on the button to select it, then 
  press the delete key on your keyboard. This will remove the button itself from 
  your form. (You can also right click on the button, and then select Delete from 
  the menu.)</p>
<p>Here's what your coding window should like:</p>
<p align="center"><img src="images/vb_2010/addressBookCode_p284_B-2.jpg"></p>
<P>Now you can re-design the form. Add four new buttons, and change the Name properties 
  to: btnNext, btnPrevious, btnFirst, and btnLast. Change the Text properties 
  to &gt;, &lt;, &lt;&lt;, and &gt;&gt;. Your form will then look like this:</p>
<p align="center"><img src="images/vb_2010/addressBookForm_p285-2.jpg"></p>
<P>Just a couple of more things to set up before we get started. Add a new variable 
  declaration to the top of your code, just under the Dim inc As Integer line. 
  Add this:</p>
<p class="indent_small_blue">Dim MaxRows As Integer</p>
<p>We can store how many rows are in the DataSet with this variable. You can get 
  how many rows are in the DataSet with this:</p>
<p class="indent_small_blue">MaxRows = ds.Tables(&quot;AddressBook&quot;).Rows.Count</p>
<p>So the Rows property has a Count Method. This simply counts how many rows are 
  in the DataSet. We're passing that number to a variable called MaxRows. You 
  can then test what is in the variable, and see if the inc counter doesn't go 
  past it. You need to do this because VB throws up an error message if try to 
  go past the last row in the DataSet. (Previous versions of VB had some called 
  an EOF and BOF properties. These checked the End of File and Before End of File. 
  These properties have now gone.)</p>
<p>Add the following two lines of code to the Form Load Event of Form1:</p>
<p class="indent_small_blue">MaxRows = ds.Tables(&quot;AddressBook&quot;).Rows.Count<br>
  inc = - 1</p>
<p>Your code should then look like this:</p>
<p align="center"><img src="images/vb_2010/addressBookCode_p286_B-2.jpg"></p>
<p>Notice the other line of code for the Form Load event:</p>
<p class="indent_small_blue">inc = - 1</p>
<p>This line sets the inc variable to minus one when the form loads. When the 
  Buttons are clicked, this will ensure that we're moving the counter on by the 
  correct amount.</p>
<p>&nbsp;</p>
<p>In the next Part, we'll see how the Buttons on the form work.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets12p8-2.html">Learn how to Code for the Navigate Buttons --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p7.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:20 GMT -->
</HTML>

