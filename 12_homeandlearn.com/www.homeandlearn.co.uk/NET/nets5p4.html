<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.uk/NET/nets5p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 07:20:58 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Try ... Catch</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-2.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-2.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2010.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign.html">Web Design</a></LI>
<LI><a href="../javascript/javascript.html">Javascript</a></LI>
<LI><a href="vbNet.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp.html">C# .NET</a></LI>
<LI><a href="../java/java.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Try ... Catch in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center">This lesson is part of an ongoing tutorial. The previous part 
  is here: <a href="nets5p3.html">Runtime Errors</a></p>
<p>&nbsp;</p>
<p>VB.NET has a inbuilt class that deals with errors. The Class is called <b>Exception</b>. 
  When an exception error is found, an <b>Exception object</b> is created. The 
  coding structure VB.NET uses to deal with such Exceptions is called the Try 
  &#133; Catch structure. </p>
<p>In the coding area for your button, type the word <b>Try</b>. Then hit the 
  return key on your keyboard. VB.NET completes the rest of the structure for 
  you:</p>
<p class="indent_big_blue">Try</p>
<p class="indent_big_blue">Catch ex As Exception</p>
<p class="indent_big_blue">End Try</p>
<p>The Try word means &quot;Try to execute this code&quot;. The Catch word means 
  &quot;Catch any errors here&quot;. The ex is a variable, and the type of variable 
  it is is an Exception object.</p>
<p>Move your line of code from the <a href="nets5p3.html">previous section</a> 
  to the Try part:</p>
<p class="indent_small_blue">Try</p>
<p class="indent_big">rt1.LoadFile(&quot;C:\test10.txt&quot;, RichTextBoxStreamType.PlainText)</p>
<p class="indent_small_blue">Catch ex As Exception</p>
<p class="indent_small_blue">End Try</p>
<p>When you run your programme, VB will Try to execute any code in the Try part. 
  If everything goes well, then it skips the Catch part. However, if an error 
  occurs, VB.NET jumps straight to Catch. Add the following to your Catch part:</p>
<p class="indent_big_blue">MsgBox(ex.Message)</p>
<p>Your coding window should look like this:</p>
<p align="center"><img src="images/DEBUG5.JPG" alt="Your coding window" border="1"></p>
<p align="left">Because ex is an object variable, it now has its own Properties 
  and methods. One of these is the Message property. Run your programme and test 
  it out. Click your button. You should see the following error message:</p>
<p align="center"><img src="images/FileNotFound.gif" alt="File Not Found Error"></p>
<p align="left">The message is coming from the &quot;additional Information&quot; 
  section of the error message we saw earlier, the one we didn't handle. But the 
  point about this new message box is that it will not crash your programme. You 
  have handled the Exception, and displayed an appropriate message for the user.</p>
<p>If you know the kind of error that a programme might throw, you can get what 
  Type it is from the Error message box you saw earlier. This one:</p>
<p align="center"><img src="images/errorFileNotFound.gif" alt="The File Not Found error"></p>
<p align="left">If you have version 2010 of Visual Studio Express, click the <b>View 
  Details</b> links under <b>Actions</b> to see the following:</p>
<p align="center"><img src="images/FileNotFound_Details.gif" alt="Details about the error thrown by VB NET"></p>
<p align="left">In version 2012, you can see the same information in the first 
  line: &quot;An unhandled exception of type 'System.IO.FileNotFoundException' 
  occurred in mscorlib.dll&quot;.</p>
<p align="left">The first line tells us the Type of Exception it is:</p>
<p align="center"><b>System.IO.FileNotFoundException</b></p>
<p>You can add this directly to the catch part. Previously, you were just catching 
  any error that might be thrown:</p>
<p align="center"><b>Catch ex As Exception</b></p>
<p>But if you know a &quot;file not found&quot; error might be thrown, you can 
  add that to the Catch line, instead of Exception:</p>
<p align="center"><b>Catch ex As System.IO.FileNotFoundException</b></p>
<p>You can keep the Exception line as well. (You can have as many Catch parts 
  as you want.) This will Catch any other errors that may occur:</p>
<p class="indent_small_blue">Try</p>
<p class="indent_big">rt1.LoadFile(&quot;C:\test10.txt&quot;, RichTextBoxStreamType.PlainText)</p>
<p class="indent_small_blue">Catch ex As System.IO.FileNotFoundException</p>
<p class="indent_big">MsgBox(ex.Message)</p>
<p class="indent_small_blue">Catch ex As Exception</p>
<p class="indent_big">MsgBox(ex.Message)</p>
<p class="indent_small_blue">End Try</p>
<p>There is one last part of the Try &#133; Catch Statement that VB.NET doesn't 
  add for you - <b>Finally</b>:</p>
<p class="indent_big">Try</p>
<p class="indent_big">Catch ex As Exception</p>
<p class="indent_big_blue">Finally</p>
<p class="indent_big">End Try</p>
<p>The <b>Finally</b> part is always executed, whether an error occurs or not. 
  You typically add a Finally part to perform any cleanup operations that are 
  needed. For example, you may have opened a file before going into a Try &#133; 
  Catch Statement. If an error occurs, the file will still be open. Whether an 
  error occurs or not, you still need to close the file. You can do that in the 
  <b>Finally</b> part. </p>
<p>But Microsoft advise that you always use <b>Try &#133; Catch</b> Statements 
  in your code. However, throughout the rest of this course, for convenience sake, 
  we won't be using them much. Even when we should be.But that's no excuse for 
  you not to use them!<br>
</p>
<p align="left">In the next part, we'll take a look at Logic Errors.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets5p5.html">Move on to Logic Errors in VB .NET --&gt;</a></P>
		<P><A HREF="vbNet.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.uk/NET/nets5p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 07:20:58 GMT -->
</HTML>

