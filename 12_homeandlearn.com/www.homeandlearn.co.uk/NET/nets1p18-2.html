<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets1p18.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:06:31 GMT -->
<HEAD>
		<TITLE>The Code for the VB NET Calculator</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">The Code for the VB NET Calculator</H1>
</HEADER> <SECTION> 
<P>In the <a href="nets1p17-2.html">previous part</a>, you designed the NET form 
  for your calculator. We'll now make a start on the code.</P>
<p>You might be thinking that all this is terribly complicated at such an early 
  stage. But it isn't really. All we are doing is transferring the Text Properties 
  from the Buttons to the textbox. And you already know how to do that. The number 
  buttons don't do anything else. All the work is done with the Plus button and 
  the Equals buttons. And there's only two lines of code needed for the Plus button, 
  and three for the Equals button.</p>
<p>For this to work, though, a little word about Scope in VB NET.</p>
<p>So far, when you've set up a variable, you've set them up behind a Private 
  Subroutine. Like this:</p>
<p class="indent_small">Private Sub Button1_Click(ByVal sender As System.Object, 
  _<br>
ByVal e As System.EventArgs) _<br>
Handles Button1.Click</p>
<p class="text_indent_red">Dim MyVariable As String</p>
<p class="indent_small">End Sub</p>
<p>Suppose you had another button on the form, Button2, and the code was this</p>
<p class="indent_small">Private Sub Button2_Click(ByVal sender As System.Object, 
  _<br>
  ByVal e As System.EventArgs) _<br>
  Handles Button2.Click</p>
<p class="text_indent_red">Dim MyOtherVariable As String</p>
<p class="indent_small">End Sub</p>
<p>How can you access what's in <b>MyVariable</b> from Button2? The answer is, 
  you can't. It's like two people sitting at desks in cubicles. Each person has 
  written something on a piece of paper. They can't see into the other person's 
  cubicle, only whatever is their own cubicle. So how do they share their information?</p>
<p>Well suppose there is a screen in front of them. A big screen. They can both 
  see the screen in front of them; it's each other they can't see. What they could 
  do is project their information onto the screen. Then one person could see what 
  the other has written.</p>
<p>Similarly, in VB you can set up your variable declarations outside of the code 
  for a Button. That way, more than one Button can see the code.</p>
<p>You can place your variable declarations right at the top of the code window, 
  just beneath the line that begins &quot;Public Class Form1&quot;. We'll set 
  up two Integer variables there, <b>total1</b> and <b>total2</b>:</p>
<p align="center"><img src="images/GenDec1-2.gif" alt="The General Declarations area in VB NET" border="1"></p>
<P>Now all the controls on your form can see these two variables. 
  Those Buttons you set up can put something in them, and every button has the 
  ability to see what's inside them.</p>
<P>&nbsp;</p>
<p class="links_ads" align="center"><a href="../bookshop/net-2.html">No more reading these lessons online - get the eBook here!</a></p>
<p>&nbsp;</p>
<h3 align="left">The 0 to 9 Buttons</h3>
<P>The Buttons with the Text 0 to 9 only need to do one thing when 
  the button is clicked - have their Text Properties transferred to the Textbox.</p>
<p>So double click the 0 Button and enter the following code:</p>
<p class="indent_small">Private Sub btnZero_Click(ByVal sender As System.Object, 
  _<br>
  ByVal e As System.EventArgs) _<br>
  Handles btnZero.Click<br>
  </P>
  <P class="text_indent_red">txtDisplay.Text = btnZero.Text</p>
<p class="indent_small">End Sub</p>
<p>This code will transfer the Text Property of a Button called btnZero to the 
  Text Property of a Textbox called txtDisplay.</p>
<p>Run your programme and try it out. When the programme is running, click the 
  0 button to see that it does indeed transfer the Text on the Button to the textbox</p>
<p>Except, there's a problem with that code. If you wrote similar code for all 
  ten of your number buttons, the calculator wouldn't be right. Why is that? Have 
  you spotted what's wrong? It's a good idea to set this book aside for a while 
  and think about why this code on it's own wouldn't work. In fact you could write 
  code for a few more of the number buttons and test it out.</p>
<p>What happens when you transfer the number 2 to the Textbox, and then click 
  the number 3? The number 2 will disappear, to be replaced by the number 3. Which 
  is all right if all you wanted to do was add up single numbers, but not much 
  good if you actually wanted the number 23 in the Textbox. With this code, you 
  could have either the number 2 in the Textbox or the number 3, but not both!</p>
<p>So how do we solve this problem? How do we fix it so that we can have two or 
  more numbers appearing in our Textbox?</p>
<p>What we need is a way to get whatever is in the Textbox to stay where it is, 
  and not disappear on us when we click a different number. It's quite easy. It's 
  this:</p>
<p class="text_indent_red">txtDisplay.Text = txtDisplay.Text &amp; btnZero.Text</p>
<p>So now we're saying the textbox doesn't just contain the Text on the Button. 
  It must also keep whatever is inside the textbox as well.</p>
<p>So what you need to do now is to add that code to all of your ten number Buttons. 
  Obviously it won't be exactly the same. For the button called btnOne the code 
  would be this:</p>
<p class="text_indent_red">txtDisplay.Text = txtDisplay.Text &amp; btnOne.Text</p>
<p>When you've finished coding all ten buttons, run the programme and click all 
  ten number button to see if they do indeed transfer the numbers on the caption 
  to the textbox. Not only that, but test to see if you can have more than one 
  number in the textbox.</p>
<p>Now that we can get numbers into our Textbox display area, we'll write code 
  to do something with those numbers - add them together, in other words. We'll 
  do that in the next part. Click the link below to move on.</p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets1p17-2.html">&lt;-- Back One Page</a> <a href="nets1p19-2.html">Move 
          on to the next part --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets1p18.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:06:31 GMT -->
</HTML>

