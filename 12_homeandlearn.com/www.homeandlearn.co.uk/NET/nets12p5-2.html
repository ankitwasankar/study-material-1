<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p5.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:18 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - Data Sets and Data Adapters</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">Data Sets and Data Adapters</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p>Part of an ongoing tutorial. The first part of Databases and VB .NET can be 
  found here:</p>
<p align="center"><a href="nets12p4-2.html">Coding your own VB .NET database projects</a></p>
<p>&nbsp;</p>
<p>In the <a href="nets12p4-2.html">previous part</a>, you learned how to set up 
  a Connection Object. This was so that you could open a connection to the database 
  itself. But that's not the end of it. The data from the database needs to be 
  stored somewhere, so that we can manipulate it. </p>
<p>ADO.NET uses something called a <b>DataSet</b> to hold all of your information 
  from the database (you can also use a DataTable, if all you want to do is read 
  information, and not have people write to your database.). But the <b>DataSet</b> 
  (and Data Table) will hold a copy of the information from the database.</p>
<p>The DataSet is not something you can draw on your form, like a Button or a 
  Textbox. The DataSet is something that is hidden from you, and just stored in 
  memory. Imagine a grid with rows and columns. Each imaginary row of the DataSet 
  represents a Row of information in your Access database. And each imaginary 
  column represents a Column of information in your Access database (called a 
  Field in Access).</p>
<p>This, then, is a DataSet. But what's a Data Adapter?</p>
<p>The Connection Object and the DataSet can't see each other. They need a go-between 
  so that they can communicate. This go-between is called a Data Adapter. The 
  Data Adapter contacts your Connection Object, and then executes a query that 
  you set up. The results of that query are then stored in the DataSet.</p>
<p>The Data Adapter and DataSet are objects. You set them up like this:</p>
<p class="indent_small_blue">Dim ds As New DataSet<br>
  Dim da As OleDb.OleDbDataAdapter</p>
<p class="indent_small_blue">da = New OleDb.OleDbDataAdapter( sql, con )</p>
<p>The code needs a little explaining, though. First, the Data Adapter. </p>
<p>&nbsp;</p>
<h3>The Data Adapter</h3>
<p>The Data Adapter is a property of the OLEDB object, hence the full stop between 
  the two:</p>
<p align="center"><b>OleDb.OleDbDataAdapter</b></p>
<p>We're passing this object to the variable called <b>da</b>. This variable will 
  then hold a reference to the Data Adapter.</p>
<p>While the second line in the code above sets up a reference to the Data Adapter, 
  the third line creates a new Data Adapter object. You need to put two things 
  in the round brackets of the Object declaration: Your SQL string (which we'll 
  get to shortly), and your connection object. Our Connection Object is stored 
  in the variable which we've called <b>con</b>. (Like all variable you can call 
  it practically anything you like. We've gone for something short and memorable.) 
  You then pass the New Data Adapter to your variable (<b>da</b> for us):</p>
<p align="center"><b>da = New OleDb.OleDbDataAdapter(sql, con )</b></p>
<p>We need something else, though. The <b>sql</b> in between the round brackets 
  is the name of a variable. We haven't yet set this up. We'll have a look at 
  SQL in a moment. But bear in mind what the Data Adaptor is doing: <b><i>Acting 
  as a go-between for the Connection Object and the Data Set </i></b></p>
<p>&nbsp;</p>
<p class="links_ads"><a href="../bookshop/net-2.html">No more reading these lessons online - get the eBook here!</a></p>
<p>&nbsp;</p>
<h3>Structured Query Language</h3>
<p>SQL (pronounced SeeKwel), is short for Structured Query Language, and is a 
  way to query and write to databases (not just Access). The basics are quite 
  easy to learn. If you want to grab all of the records from a table in a database, 
  you use the SELECT word. Like this:</p>
<p align="center"><b>SELECT * FROM Table_Name</b></p>
<p>SQL is not case sensitive, so the above line could be written:</p>
<p align="center"><b>Select * from Table_Name</b></p>
<P>But your SQL statements are easier to read if you type the keywords 
  in uppercase letters. The keywords in the lines above are <b>SELECT</b> and 
  <b>FROM</b>. The asterisk means &quot;All Records&quot;. Table_Name is the name 
  of a table in your database. So the whole line reads:
</p>
<p align="center"><b>&quot;SELECT all the records FROM the table called Table_Name&quot;</b></p>
<p>You don't need to select all (*) the records from your database. You can just 
  select the columns that you need. The name of the table in our database is <b>tblContacts</b>. 
  If we wanted to select just the first name and surname columns from this table, 
  we can specify that in our SQL String:</p>
<p align="center"><b>SELECT tblContacts.FirstName, tblContacts.Surname FROM tblContacts</b></p>
<p>When this SQL statement is executed, only the FirstName and Surname columns 
  from the database will be returned.</p>
<p>There are a lot more SQL commands, but for our purposes this is enough. 
</p>
<p>Because we want to SELECT all (*) the records from the table called tblContacts, 
  we pass this string to the string variable we have called sql:</p>
<p align="center"><b>sql = &quot;SELECT * FROM tblContacts&quot;</b></p>
<p>Your code window should now look like this (though the file path to your database 
  might be different):</p>
<p align="center"><img src="images/vb_2010/addressBookCode_p278-2.jpg" border="1"></p>
<p>Now that the Data Adapter has selected all of the records from the table in 
  our database, we need somewhere to put those records - in the <b>DataSet</b>.</p>
<p>&nbsp;</p>
<h3>Filling the DataSet</h3>
<p>The Data Adapter can Fill a DataSet with records from a Table. You only need 
  a single line of code to do this:</p>
<p align="center"><b>da.Fill(ds, &quot;AddressBook&quot;)</b></p>
<p>As soon as you type the name of your Data Adapter (<b>da</b> for us), you'll 
  get a pop up box of properties and methods. Select Fill from the list, then 
  type a pair of round brackets. In between the round brackets, you need two things: 
  the <b>Name</b> of your DataSet (<b>ds</b>, in our case), and an identifying 
  name. This identifying name can be anything you like. But it is just used to 
  identify this particular Data Adapter Fill. We could have called it &quot;Bacon 
  Sandwich&quot;, if we wanted:</p>
<p align="center"><b>da.Fill(ds, &quot;Bacon Sandwich &quot;)</b></p>
<p>The code above still works. But it's better to stick to something a little 
  more descriptive than &quot;Bacon Sandwich&quot;!</p>
<p>Add the new line after the creation of the Data Adaptor:</p>
<p class="indent_small_blue">da = New OleDb.OleDbDataAdapter(sql, con)<br>
  da.Fill(ds, &quot;AddressBook&quot;)</p>
<p>And that's it. The DataSet (<b>ds</b>) will now be filled with the records 
  we selected from the table called <b>tblContact</b>. There's only one slight 
  problem - nobody can see the data yet! We'll tackle that in the next part.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets12p6-2.html">Learn how to display the data in the DataSet --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets12p5.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:18 GMT -->
</HTML>

