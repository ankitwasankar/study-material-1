<!DOCTYPE html>
<HTML>
	
<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:06 GMT -->
<HEAD>
		<TITLE>Visual Basic .NET programming for Beginners - How to Write to a Text File</TITLE>
	<LINK REL=Stylesheet TYPE ="text/css" HREF="two_col_style_1-3.css">
		<meta name="description" content="">
		<meta itemprop="name" content="Home and Learn">
		<meta itemprop="description" content="Free Visual Basic .NET Course">
		<meta itemprop="image" content="../logo5.jpg">
		<link rel="publisher" href="https://plus.google.com/104045712242599534737" />
<link rel="author" href="https://plus.google.com/104045712242599534737" />
		<SCRIPT LANGUAGE="JavaScript" type="text/javascript" src="links-2.js"></SCRIPT>
	</HEAD>


	<BODY>
		<HEADER ID="Banner"><P>&nbsp;</P>
			<H1><SPAN class="Logo_Text">Free</SPAN> <SPAN class="Logo_Text2">Visual Basic .NET</SPAN> <SPAN class="Logo_Text">Course</SPAN></H1>
		</HEADER>
<HR />

		<NAV ID="left_menu">
		<P>&nbsp;</P>
<P>&nbsp;</P>
		<H3>Computer Courses</H3>
<ul>
<LI><a href="../index-3.html">Home</a></LI>
<LI><a href="../BC/BeginnersComputing-2.html">Beginners Computing </a></LI>
<LI><a href="../word2007_2010/Word-2007-2011.html">Word 2007 to 2010</a></LI>
<LI><a href="../MW/MicrosoftWord-2.html">Word 2000 to 2003</a></LI>
<LI><a href="../excel2007/Excel2007-2.html">Excel 2007 to 2010</a></LI>
<LI><a href="../ME/MicrosoftExcel-2.html">Excel to 2003</a></LI>
<LI><a href="../WD/WebDesign-2.html">Web Design</a></LI>
<LI><a href="../javascript/javascript-2.html">Javascript</a></LI>
<LI><a href="vbNet-2.html">Visual Basic .NET</a> <B>&lt; &lt;</B></LI>
<LI><a href="../php/php-2.html">Beginners PHP</a></LI>
<LI><a href="../csharp/csharp-2.html">C# .NET</a></LI>
<LI><a href="../java/java-2.html">Java for Beginners</a></LI>
</ul>
		
</NAV> <SECTION ID="Wrapper"> <ARTICLE> <HEADER> 
<H1 ID="Article">How to Write to a Text File in VB .NET</H1>
</HEADER> <SECTION> 
<p align="center"> 
  <script language="JavaScript">
				writeImageVB()
			</script>
</p>
<p><i>This lesson is part of an ongoing tutorial. The first part is here: <a href="nets8p2-2.html">How 
  to open a Text File in VB .NET</a></i></p>
<p>&nbsp;</p>
<p>Writing to a text file is similar to reading a text file. Again we use System.IO. 
  This time, instead of using the StreamReader we use the <b>StreamWriter</b>. 
  The StreamWriter is used to write a stream of text to a file.</p>
<p>Add another Button to the form you've been working on. Set the <b>Text</b> 
  property of the button to &quot;<b>Write to File</b>&quot;. Double click your 
  new button to open up the coding window. Add the following:</p>
<p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test2.txt&quot;</p>
<p class="indent_small_blue_no_bold">If System.IO.File.Exists(FILE_NAME) = True Then</P>
  
<P class="indent_big_blue_no_bold">Dim objWriter As New System.IO.<b>StreamWriter</b>( 
  FILE_NAME )</P>
  
<P class="indent_big_blue_no_bold">objWriter.<b>Write</b>( TextBox1.Text )<br>
  objWriter.<b>Close</b>()<br>
  MsgBox(&quot;Text written to file&quot;)</P>
  
  <P class="indent_small_blue_no_bold">Else</P>
  <P class="indent_big_blue_no_bold">MsgBox(&quot;File Does Not Exist&quot;)</P>
  <P class="indent_small_blue_no_bold">End If</p>
<p>Run your programme, and then click your new button. </p>
<p>Unless you have a file called &quot;<b>test2.txt</b>&quot;, you should see 
  the message box display: &quot;File Does Not Exist.&quot;</p>
<p>Once again, VB insists that the file must exist before it can actually do something 
  with it. Which is not unreasonable!</p>
<p>Stop your programme and change this line:</p>
<p align="center"><b>Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test2.txt&quot;</b></p>
<p>To this:</p>
<p align="center"><b>Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;</b></p>
<p>In other words, just change the file name back to test.txt. (Hopefully, you 
  haven't deleted the <b>test.txt </b>file from your hard drive!)</p>
<p>Run your programme again. Type something into the textbox, and then click your 
  button. You should see the message box &quot;Text written to file&quot; appear.<br>
</p>
<p>But notice that if you open up the text file itself, any text you had previously 
  will be gone - it has been overwritten, rather than appended to. (We'll see 
  how to append text to a file shortly.)</p>
<p>Let's have a look at the code we wrote, though.</p>
<p>Once again, we check to see if the File Exists. If it's True that the file 
  exists, then the first line that gets executed is setting up our variable:</p>
<p align="center"><b>Dim objWriter As New System.IO.StreamWriter(FILE_NAME)</b></p>
<p>It's almost the same as <a href="nets8p2-2.html">last time</a>. Only two things 
  have changed: we created a new variable name, <b>objWriter</b>, and we're now 
  using <b>StreamWriter</b> instead of <b>StreamReader</b>. Everything else is 
  the same.</p>
<p>To write the text to our file, we've used this:</p>
<p align="center"><b>objWriter.Write( TextBox1.Text )</b></p>
<p>After the name of our variable (objWriter), we typed a full stop. The drop 
  down box appeared showing available properties and methods. The &quot;<b>Write</b>&quot; 
  method was chosen from the list. In between round brackets, you put what it 
  is you want VB to write to your text file. In our case, this was the text in 
  <b>Textbox1</b>. You can also do this:</p>
<p align="center"><b>objWriter.Write( &quot;Your Text Here&quot; )</b></p>
<p>The above uses direct text surrounded by double quotes. This is also acceptable:</p>

<p class="indent_small_blue_no_bold">Dim TheText As String = &quot;Your Text Here&quot;</p>
<p class="indent_small_blue_no_bold">objWriter.Write( TheText )</p>
<p>This time, we've put the text inside of a variable. The name of the variable 
  is then typed inside of the round brackets of &quot;Write&quot;.</p>
<p>But you don't have to write the whole text at once. You can write line by line. 
  In which case, select <b>WriteLine</b> from the available properties and methods. 
  Here's an example of how to use WriteLine:</p>
<p class="indent_small_blue_no_bold">Dim FILE_NAME As String = &quot;C:\Users\Owner\Documents\test.txt&quot;<br>
  Dim i As Integer<br>
  Dim aryText(4) As String</p>
<p class="indent_small_blue_no_bold">aryText(0) = &quot;Mary WriteLine&quot;<br>
  aryText(1) = &quot;Had&quot;<br>
  aryText(2) = &quot;A&quot;<br>
  aryText(3) = &quot;Little&quot;<br>
  aryText(4) = &quot;One&quot;</p>
  
<p class="indent_small_blue_no_bold">Dim objWriter As New System.IO.<b>StreamWriter</b>( 
  FILE_NAME )</p>
  
<p class="indent_small_blue_no_bold">For i = 0 To 4</P>
  
<P class="indent_big_blue_no_bold">objWriter.<b>WriteLine</b>( aryText(i) )</P>
  <P class="indent_small_blue_no_bold">Next</p>
<p class="indent_small_blue_no_bold">objWriter.Close()</p>
<p>The error checking code has been left out here. But notice the new way to write 
  text to the file:</p>
<p align="center"><b>objWriter.WriteLine( aryText(i) )</b></p>
<p>We're looping round and writing the contents of an array. Each line of text 
  from the array gets written to our text file. But each line is appended. That 
  is, the text file doesn't get erased after each line has been written. All the 
  lines from the array will be written to the text file. However, if you were 
  to run the code a second time then the contents of the file are erased before 
  the new <b>WriteLine</b>() springs into action. In other words, you'd only get 
  one version of &quot;Mary WriteLine had a little one&quot; instead of two.</p>
<p>In the next part we'll see how to add text to a file that already contains 
  text - called appending to a file.</p>
<p align="center"><a href='../bookshop/net-2.html'><img src='vbBanBorder-2.gif' alt='Buy our VB NET Book Here' border='0'/></a></p>
</SECTION></ARTICLE> </SECTION> <FOOTER> 
<P class="course_links"><a href="nets8p5-2.html">Learn how to Append Text to a File with VB .NET --&gt;</a></P>
		<P><A HREF="vbNet-2.html">Back to the VB NET Contents Page</A>
      		<P>&copy; All course material copyright Home and Learn</P>
    	</FOOTER>

  </BODY>

<!-- Mirrored from www.homeandlearn.co.ukNET/nets8p4.html by HTTrack Website Copier/3.x [XR&CO'2005], Thu, 24 Jan 2013 08:07:06 GMT -->
</HTML>

