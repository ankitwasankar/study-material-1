<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>

<HEAD>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">
<SCRIPT LANGUAGE="JavaScript">

<!--

function popUp(pPage) {
 var fullURL = document.location;
 var textURL = fullURL.toString();
 var URLlen = textURL.length;
 var lenMinusPage = textURL.lastIndexOf("/");
 lenMinusPage += 1;
 var fullPath = textURL.substring(0,lenMinusPage);
 popUpWin = window.open('','popWin','resizable=yes,scrollbars=no,width=525,height=394');
 figDoc= popUpWin.document;
 zhtm= '<HTML><HEAD><TITLE>' + pPage + '</TITLE>';
 zhtm += '</head>';
 zhtm += '<BODY bgcolor="#FFFFFF">';
 zhtm += '<IMG SRC="' + fullPath + pPage + '">';
 zhtm += '<P><B>' + pPage + '</B>';
 zhtm += '</BODY></HTML>';
 window.popUpWin.document.write(zhtm);
 window.popUpWin.document.close();
 // Johnny Jackson 4/28/98
 }

//-->
                                                                
</SCRIPT>
<link rel="stylesheet" href="ebooks.css" tppabs="http://pbs.mcp.com/includes/stylesheets/ebooks.css">

	<META NAME="GENERATOR" Content="Symantec Visual Page Mac 1.1.1">
	<TITLE>Using Visual Basic 6 -- Ch 7 -- Using Data Types, Constants, and Variables</TITLE>
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF">

<H1 ALIGN="CENTER"><IMG SRC="que.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/que.gif" WIDTH="171" HEIGHT="66" ALIGN="BOTTOM"
BORDER="0"><BR>
Using Visual Basic 6</H1>
<CENTER>
<P><A HREF="ch06.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch06/ch06.htm"><IMG SRC="previous.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/previous.gif" WIDTH="128" HEIGHT="28"
ALIGN="BOTTOM" ALT="Previous chapter" BORDER="0"></A><A HREF="ch08.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch08/ch08.htm"><IMG
SRC="next.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/next.gif" WIDTH="128" HEIGHT="28" ALIGN="BOTTOM" ALT="Next chapter"
BORDER="0"></A><A HREF="index-38.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/index.htm"><IMG SRC="contents.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/contents.gif" WIDTH="128"
HEIGHT="28" ALIGN="BOTTOM" ALT="Contents" BORDER="0"></A> 
<HR>

</CENTER>
<H1 ALIGN="CENTER">- 7 -<BR>
Using Data Types, Constants, and Variables</H1>

<UL>
	<LI><A HREF="#Heading1">Storing Information in Variables</A>
	<UL>
		<LI><A HREF="#Heading2">Declaring Variables</A>
		<LI><A HREF="#Heading3">Naming Variables</A>
		<LI><A HREF="#Heading4">Choosing the Correct Variable Type</A>
	</UL>
	<LI><A HREF="#Heading5">Making Explicit Declarations</A>
	<LI><A HREF="#Heading6">Using Type Suffixes with Variables</A>
	<LI><A HREF="#Heading7">Using Strings</A>
	<UL>
		<LI><A HREF="#Heading8">Using Variable-Length and Fixed-Length Strings</A>
	</UL>
	<LI><A HREF="#Heading9">Determining Where a Variable Can Be Used</A>
	<UL>
		<LI><A HREF="#Heading10">Making Variables Available Globally</A>
		<LI><A HREF="#Heading11">Keeping a Variable Local</A>
	</UL>
	<LI><A HREF="#Heading12">Using Static Variables</A>
	<LI><A HREF="#Heading13">Using Constants</A>
	<UL>
		<LI><A HREF="#Heading14">Using Constants Supplied by Visual Basic</A>
		<LI><A HREF="#Heading15">Creating Your Own Constants</A>
	</UL>
	<LI><A HREF="#Heading16">Using the Assignment Statement</A>
	<LI><A HREF="#Heading17">Revisiting the Addition Program</A>
</UL>

<P>
<HR SIZE="4">

<H1 ALIGN="CENTER"></H1>
<H2><A NAME="Heading1"></A>Storing Information in Variables</H2>
<P>Figure 7.1 shows a simple addition program, AddNum.EXE, from the project Addnum.prj
from the file vb6cp07.zip on the Web site dedicated to this book. The program enables
users to enter two numbers. When they click the + button, the program processes the
total, which is then displayed in a third text box.</P>
<P><A HREF="javascript:popUp('07fig01.gif')"><B>FIGURE 7.1</B></A> <I>AddNum is a
simple addition program that shows you how to use variables.</I></P>
<P>While the data is being processed in your program, it's stored temporarily in
<I>variables</I>. Think of a variable as a cup that can hold various amounts of jelly
beans; you never know how many jelly beans are in the cup at any given time unless
you look in the cup. The same is true for a variable. A variable can hold a different
value at different times. You programmatically look into it to find out its value.</P>
<P>You use variables when you know that you'll have to deal with a quantity at some
point but don't know its present value--such as the balance of your checking account.
You know the account's balance today, but you have no idea what the balance will
be in a week.</P>
<P>
<H3><A NAME="Heading2"></A>Declaring Variables</H3>
<P>You create (that is, declare) a variable by using the following form:</P>
<P>
<PRE>Dim <I>VarName</I> As <I>DataType</I>
</PRE>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Understanding keywords</STRONG></P>
	<P>A keyword, also known as a reserved word, is a word reserved for Visual Basic's
	exclusive use; you can't use keywords for your own programming needs. Words such
	as Dim, As, New, ReDim, If, Then, Else, Loop, While, and End are all Visual Basic
	keywords. By default, Visual Basic uses the font color blue to show all keywords
	that you type in a Code window.<BR>
	Visual Basic has many keywords. You know a word is a keyword if the word changes
	color after you type it in the code window. Also, you can look in the online documentation
	that comes with Visual Basic to obtain a detailed list and explanation of them all.
	
<HR>


</BLOCKQUOTE>

<P>In this syntax,</P>

<UL>
	<LI>Dim is the <I>keyword</I> that tells Visual Basic that you want to declare a
	variable.
	<P>
	<LI><I>VarName</I> is the name of the variable.
	<P>
	<LI>As is the keyword that tells Visual Basic that you're defining the data type
	for the variable.
	<P>
	<LI><I>DataType</I> is the data type of the variable.
</UL>

<P>Thus, the following example creates a variable, i, that's of data type Integer:</P>
<P>
<PRE>Dim i as Integer
</PRE>
<P>Listing 7.1 shows the event procedure for the Click() event of the cmdAdd button.
Three variables--x, y, and z (on lines 3, 6, and 9)--are declared. These variables
are of type Integer. (Data types are discussed later in the chapter. For now, realize
that you are making variables that will accommodate numbers. Also, if you type a
letter such as a in a text box, the code won't work because it's expecting a number.
Preventing this sort of error is addressed at the end of this chapter.) For more
information about avoiding and finding errors in your code see Chapter 21, &quot;Debugging
Your Applications.&quot;</P>
<P>
<H4>LISTING 7.1 07LIST01.TXT--The cmdAdd Event Procedure</H4>
<PRE><B>01 </B>Private Sub cmdAdd_Click()</PRE>
<PRE><B>02 </B>`Declare a variable for the first number</PRE>
<PRE><B>03 </B>Dim x As Integer</PRE>
<PRE><B>04</B></PRE>
<PRE><B>05 </B>`Declare a variable for the second number</PRE>
<PRE><B>06 </B>Dim y As Integer</PRE>
<PRE><B>07</B></PRE>
<PRE><B>08 </B>`Declare a variable to hold the sum of both numbers</PRE>
<PRE><B>09 </B>Dim z As Integer</PRE>
<PRE><B>10</B></PRE>
<PRE><B>11 </B>`Convert the text inputted into the text box</PRE>
<PRE><B>12 </B>`into an integer and assign it to the first variable</PRE>
<PRE><B>13 </B>x = CInt(txtNumOne.Text)</PRE>
<PRE><B>14</B></PRE>
<PRE><B>15 </B>`Convert the text inputted into the text box</PRE>
<PRE><B>16 </B>`into an integer and assign it to the second variable</PRE>
<PRE><B>17 </B>y = CInt(txtNumTwo.Text)</PRE>
<PRE><B>18</B></PRE>
<PRE><B>19 </B>`Add the first two variables together and assign</PRE>
<PRE><B>20 </B>`the result to the third variable</PRE>
<PRE><B>21 </B>z = x + y</PRE>
<PRE><B>22</B></PRE>
<PRE><B>23 </B>`Convert the third variable (which is an integer)</PRE>
<PRE><B>24 </B>`to text and assign it to the text property of the</PRE>
<PRE><B>25 </B>`TextBox for the result.</PRE>
<PRE><B>26 </B>txtTotal.Text = CStr(z)</PRE>
<PRE><B>27 </B>End Sub</PRE>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Commenting code</STRONG></P>
	<P>Notice that some lines of code begin with an apostrophe (`), which tells Visual
	Basic that everything on that line or following the apostrophe isn't code and should
	be ignored by the compiler. Such a line of text offers some remarks or information
	about what your programming intention is. This is called commenting your code. Well-written
	code is heavily commented. Commenting your code helps you remember your thinking
	when you come back to your code at a later time. It also helps those who must maintain
	your code after you've written it. 
<HR>


</BLOCKQUOTE>

<H3><A NAME="Heading3"></A>Naming Variables</H3>
<P>When you declare a variable, you must give it a name. Returning to the cup analogy,
if you have two cups on a table that hold different amounts of jelly beans, you must
be able to distinguish between the cups to work with them. Naming makes each variable
distinct and easy to identify.</P>
<P>In naming a variable, you have tremendous flexibility. Variable names can be simple,
or they can be descriptive of the information they contain. For example, you could
name a counter variable i%, or you might want to use a more descriptive name, such
as NumberOfRedJellyBeansForBob or NumberOfJellyBeansForDorothy. Although you're allowed
great latitude in naming, you need to know about the following restrictions:</P>

<UL>
	<LI>The name must start with a letter, not a number or other character.
	<P>
	<LI>The name can't contain a period.
	<P>
	<LI>The name must be unique within the current procedure or module (this restriction
	depends on the <I>scope</I> of the name, which you'll learn about a little later).
	<P>
	<LI>The name can be no longer than 255 characters.
</UL>

<P>Some examples of incorrect variable naming are as follows:</P>

<UL>
	<LI>1Week--You can't begin a variable with a number.
	<P>
	<LI>Earnings.To.Data--You can't use periods.
	<P>
	<LI>Number One--You can't have spaces between characters.
</UL>

<P>On the other hand, the following examples work perfectly well:</P>
<P>
<PRE>MyNum&amp;
i%
iNumOne
strInputValue
Number2#
</PRE>
<P>To make your code easy to read, your variable names should describe their task
but, to make your code easy to type, they should also be short. Many programmers
use prefixes on their variables to indicate the type of data stored and the scope
of the variable. For example, a prefix of g_int indicates a global or program-level
variable that stores an integer. Table 7.1 describes suggested prefixes you can use
with your variables.</P>
<P>
<H4>TABLE 7.1 Variable and Control Prefixes</H4>
<P>
<TABLE BORDER="1">
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT"><B><I>Prefix</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Variable/Control</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Example</I></B></TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">b</TD>
		<TD ALIGN="LEFT">Boolean</TD>
		<TD ALIGN="LEFT">bLightsOn</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">c</TD>
		<TD ALIGN="LEFT">Currency</TD>
		<TD ALIGN="LEFT">cAmountDue</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">d</TD>
		<TD ALIGN="LEFT">Double</TD>
		<TD ALIGN="LEFT">dDollarPerGallon</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">db</TD>
		<TD ALIGN="LEFT">Database</TD>
		<TD ALIGN="LEFT">dbAccountsPayable</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">ds</TD>
		<TD ALIGN="LEFT">Dynaset</TD>
		<TD ALIGN="LEFT">dsOverDue</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">dt</TD>
		<TD ALIGN="LEFT">Date+time</TD>
		<TD ALIGN="LEFT">dtDateDue</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Prefix</TD>
		<TD ALIGN="LEFT">Variable/Control</TD>
		<TD ALIGN="LEFT">Example</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">td</TD>
		<TD ALIGN="LEFT">TableDef</TD>
		<TD ALIGN="LEFT">tdEmployees</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">h</TD>
		<TD ALIGN="LEFT">Handle</TD>
		<TD ALIGN="LEFT">hWnd</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">i</TD>
		<TD ALIGN="LEFT">Integer</TD>
		<TD ALIGN="LEFT">iCounter</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">l</TD>
		<TD ALIGN="LEFT">Long</TD>
		<TD ALIGN="LEFT">lNum</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">str</TD>
		<TD ALIGN="LEFT">String</TD>
		<TD ALIGN="LEFT">strMessage</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">s</TD>
		<TD ALIGN="LEFT">Single</TD>
		<TD ALIGN="LEFT">sPay</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">a</TD>
		<TD ALIGN="LEFT">Array</TD>
		<TD ALIGN="LEFT">a_iMyArray</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">g</TD>
		<TD ALIGN="LEFT">Global</TD>
		<TD ALIGN="LEFT">g_iTotal</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">m</TD>
		<TD ALIGN="LEFT">Local to module or form</TD>
		<TD ALIGN="LEFT">m_iAmount</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">ani</TD>
		<TD ALIGN="LEFT">Animation button</TD>
		<TD ALIGN="LEFT">aniMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">cbo</TD>
		<TD ALIGN="LEFT">Combo box and drop-down list box</TD>
		<TD ALIGN="LEFT">cboMyList</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">chk</TD>
		<TD ALIGN="LEFT">Check box</TD>
		<TD ALIGN="LEFT">chkDoctorIn</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">clp</TD>
		<TD ALIGN="LEFT">Picture clip</TD>
		<TD ALIGN="LEFT">clpEmblems</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">cmd</TD>
		<TD ALIGN="LEFT">Command button</TD>
		<TD ALIGN="LEFT">cmdFirstName</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">com</TD>
		<TD ALIGN="LEFT">Communications</TD>
		<TD ALIGN="LEFT">comLineOne</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">ctr</TD>
		<TD ALIGN="LEFT">Control (used within procs when the specific type is unknown)</TD>
		<TD ALIGN="LEFT">ctrNext</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">dat</TD>
		<TD ALIGN="LEFT">Data</TD>
		<TD ALIGN="LEFT">datEmployees</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">db</TD>
		<TD ALIGN="LEFT">ODBC database</TD>
		<TD ALIGN="LEFT">dbTaxpayers</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">dir</TD>
		<TD ALIGN="LEFT">Directory list box</TD>
		<TD ALIGN="LEFT">dirProjects</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">dlg</TD>
		<TD ALIGN="LEFT">Common dialog</TD>
		<TD ALIGN="LEFT">dlgSettings</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">drv</TD>
		<TD ALIGN="LEFT">Drive list box</TD>
		<TD ALIGN="LEFT">drvMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">fil</TD>
		<TD ALIGN="LEFT">File list box</TD>
		<TD ALIGN="LEFT">filPictures</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">frm</TD>
		<TD ALIGN="LEFT">Form</TD>
		<TD ALIGN="LEFT">frmMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">fra</TD>
		<TD ALIGN="LEFT">Frame</TD>
		<TD ALIGN="LEFT">fraTeams</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">gau</TD>
		<TD ALIGN="LEFT">Gauge</TD>
		<TD ALIGN="LEFT">gauGas</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Prefix</TD>
		<TD ALIGN="LEFT">Variable/Control</TD>
		<TD ALIGN="LEFT">Example</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">gpb</TD>
		<TD ALIGN="LEFT">Group button</TD>
		<TD ALIGN="LEFT">gpbApps</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">grd</TD>
		<TD ALIGN="LEFT">Grid</TD>
		<TD ALIGN="LEFT">grdMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">hsb</TD>
		<TD ALIGN="LEFT">Horizontal scroll bar</TD>
		<TD ALIGN="LEFT">hsbText</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">img</TD>
		<TD ALIGN="LEFT">Image</TD>
		<TD ALIGN="LEFT">imgMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">key</TD>
		<TD ALIGN="LEFT">Keyboard key status</TD>
		<TD ALIGN="LEFT">keyASCII</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">lbl</TD>
		<TD ALIGN="LEFT">Label</TD>
		<TD ALIGN="LEFT">lblLastName</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">lin</TD>
		<TD ALIGN="LEFT">Line</TD>
		<TD ALIGN="LEFT">linRed</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">lst</TD>
		<TD ALIGN="LEFT">List box</TD>
		<TD ALIGN="LEFT">lstStooges</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">mdi</TD>
		<TD ALIGN="LEFT">MDI child form</TD>
		<TD ALIGN="LEFT">mdiMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">mnu</TD>
		<TD ALIGN="LEFT">Menu</TD>
		<TD ALIGN="LEFT">mnuEdit</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">opt</TD>
		<TD ALIGN="LEFT">Option button</TD>
		<TD ALIGN="LEFT">optGender</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">ole</TD>
		<TD ALIGN="LEFT">OLE client</TD>
		<TD ALIGN="LEFT">oleMain</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">pnl</TD>
		<TD ALIGN="LEFT">3D panel</TD>
		<TD ALIGN="LEFT">pnlFriends</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">shp</TD>
		<TD ALIGN="LEFT">Shape</TD>
		<TD ALIGN="LEFT">shpCircle</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">spn</TD>
		<TD ALIGN="LEFT">Spin control</TD>
		<TD ALIGN="LEFT">spnTemp</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">txt</TD>
		<TD ALIGN="LEFT">Text/edit box</TD>
		<TD ALIGN="LEFT">txtAddress</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">tmr</TD>
		<TD ALIGN="LEFT">Timer</TD>
		<TD ALIGN="LEFT">tmrBreak</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">vsb</TD>
		<TD ALIGN="LEFT">Vertical scrollbar</TD>
		<TD ALIGN="LEFT">vsbComments</TD>
	</TR>
</TABLE>

<H3><A NAME="Heading4"></A>Choosing the Correct Variable Type</H3>
<P>You can store almost anything in a variable. A variable can hold a number, a string
of text, or an instance of an object, including forms, controls, and database objects.
This chapter looks specifically at variables that store numbers, strings, and logical
values.</P>
<P>You can use a variable to hold any type of information, but different types of
variables are designed to work efficiently with different types of information.</P>
<P>Returning to the earlier cup example, you might want to have a type of cup that
can hold only jelly beans, only cherries, or only nails. What the cup is supposed
to hold greatly influences how the cup is constructed. A cup that holds cherries
might have little holes in the bottom for water to pass through. A cup to hold nails
might be made of tough material so that the nails don't puncture or scratch it. The
same is true of variables--the type of variable must match the data it's going to
hold. When you declare a variable to be of a certain type, you're giving instructions
to Visual Basic about how to build the variable to accommodate the type of data that
the variable will have to hold.</P>
<P>Table 7.2 presents the types of variables available in Visual Basic. The table
also shows the range of values that each variable can hold and the amount of memory
required to store the information in the variable (sort of like the cup size). Understanding
memory requirements is important if you want to optimize your code. To conserve system
resources, you should use variables with smaller memory requirements whenever possible,
but don't worry about optimizing code until you're comfortable with the concept of
creating and using variables.</P>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Sizing variables</STRONG></P>
	<P>At some point you may wonder whether you're using a variable of the right size,
	particularly with regard to numbers. A good rule of thumb is to go with the larger
	variable size if you don't have a very good idea of what the limit of your variable
	will be. For example, if you think that your program at some point might be required
	to use numbers with decimals or fractions, you might want to use Double and Single
	variable types instead of Integers and Longs. 
<HR>


</BLOCKQUOTE>

<H4>TABLE 7.2 Variables Store Many Types of Information</H4>
<P>
<TABLE BORDER="1">
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT"><B><I>Type</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Stores</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Memory Requirement</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Range of Values</I></B></TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Integer</TD>
		<TD ALIGN="LEFT">Whole numbers</TD>
		<TD ALIGN="LEFT">2 bytes</TD>
		<TD ALIGN="LEFT">-32,768 to 32,767</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Long</TD>
		<TD ALIGN="LEFT">Whole numbers</TD>
		<TD ALIGN="LEFT">4 bytes</TD>
		<TD ALIGN="LEFT">Approximately +/- 2.1E9</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Single</TD>
		<TD ALIGN="LEFT">Decimal numbers</TD>
		<TD ALIGN="LEFT">4 bytes</TD>
		<TD ALIGN="LEFT">-3.402823E38 to -1.401298E-45 for negative values and 1.401298E-45 to 3.402823E38
			for positive values</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Double</TD>
		<TD ALIGN="LEFT">Decimal numbers (double-precision floating-point)</TD>
		<TD ALIGN="LEFT">8 bytes</TD>
		<TD ALIGN="LEFT">-1.79769313486232E308 to -4.94065645841247E-324 for negative values and 4.94065645841247E-324
			to 1.79769313486232E308 for positive values</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Currency</TD>
		<TD ALIGN="LEFT">Numbers with up to 15 digits left of the decimal and 4 digits right of the decimal</TD>
		<TD ALIGN="LEFT">8 bytes</TD>
		<TD ALIGN="LEFT">922,337,203,685,477.5808 to 922,337,203,685,477.5807</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">String</TD>
		<TD ALIGN="LEFT">Text information</TD>
		<TD ALIGN="LEFT">1 byte per character</TD>
		<TD ALIGN="LEFT">Up to 65,000 characters for fixed-length strings and up to 2 billion characters for
			dynamic strings</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Byte</TD>
		<TD ALIGN="LEFT">Whole numbers</TD>
		<TD ALIGN="LEFT">1 byte</TD>
		<TD ALIGN="LEFT">0 to 255</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Boolean</TD>
		<TD ALIGN="LEFT">Logical values</TD>
		<TD ALIGN="LEFT">2 bytes</TD>
		<TD ALIGN="LEFT">True or False</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Date</TD>
		<TD ALIGN="LEFT">Date and time information</TD>
		<TD ALIGN="LEFT">8 bytes</TD>
		<TD ALIGN="LEFT">Jan 1st 100 to December 31st 9999</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Object</TD>
		<TD ALIGN="LEFT">Pictures and any object reference</TD>
		<TD ALIGN="LEFT">4 bytes</TD>
		<TD ALIGN="LEFT">N/A</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Variant</TD>
		<TD ALIGN="LEFT">Any of the preceding data types</TD>
		<TD ALIGN="LEFT">16 bytes + 1 byte per character</TD>
		<TD ALIGN="LEFT">N/A</TD>
	</TR>
</TABLE>
</P>
<P>You know how to name a variable and what a variable can store, but how do you
tell the program what you want to store? In reality, you don't have to tell Visual
Basic what a variable will contain. Unlike other languages, Visual Basic doesn't
require you to specifically declare a variable before it's used. If a variable isn't
declared, Visual Basic uses a default data type known as a <I>variant</I>, which
can contain any type of information. Read more on variants in the following section.</P>
<P>It's a good idea to declare your variables before they're used. Declaring variables
saves you time in the long run and makes your code much more reliable.</P>
<P>
<H2><A NAME="Heading5"></A>Making Explicit Declarations</H2>
<P><I>Explicit declaration</I> means that you must use a statement to define a variable.
Each of the following statements can be used to explicitly declare a variable's type:</P>
<P>
<PRE>Dim <I>VarName</I> [As <I>VarType</I>][, <I>VarName2</I> [As<I> VarType2</I>]]
Private <I>VarName</I>[As <I>VarType</I>][, <I>VarName2</I>[As <I>VarType2</I>]]
Static <I>VarName</I>[As <I>VarType</I>][, <I>VarName2</I>[As <I>VarType2</I>]]
Public <I>VarName</I>[As <I>VarType</I>][, <I>VarName2</I>[As <I>VarType2</I>]]
</PRE>
<P>Dim, Private, Static, and Public are Visual Basic keywords that define how and
where the variable can be used. <I>VarName</I> and <I>VarName2</I> represent the
names of the variables that you want to declare. As indicated in the syntax, you
can specify multiple variables in the same statement as long as you separate the
variables by commas. (The syntax shows only two variables, but you can specify any
number.)</P>
<P><I>VarType</I> and <I>VarType2</I> represent the type name of the respective variables.
The <I>type</I> <I>name</I> is a keyword that tells Visual Basic what kind of information
will be stored in the variable. The type can be one of those specified in Table 7.2
or a user-defined type.</P>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>What's a variant?</STRONG></P>
	<P>A variant is a data type that knows how to be any data type. If you declare a
	variable to be of type variant, it can be an Integer, Double, String...whatever.
	Variables have a definite use in advanced programming. If you are a beginning programmer,
	however, you shouldn't use variants to avoid the labor of learning to use the proper
	data type for the proper situation. 
<HR>


</BLOCKQUOTE>

<P>As mentioned earlier, declaring a variable type is optional. If you include the
variable type, you must include the keyword As. If you don't include a variable type,
the Variant type (the default) is used. Using a variant for general information has
two major drawbacks, however: it can waste memory resources, and the variable type
can produce unpredictable default value behaviors, particularly with arrays.</P>
<P>The following code lines show the use of these declaration statements for explicitly
declared variables:</P>
<P>
<PRE>Private iNumVal As Integer
Private iAvgVal As Integer, dInputval As Double
Static sCalcAverage As Single
Dim strInputMsg As String
</PRE>
<P>In Visual Basic, you don't have to use the keywords Dim, Private, Static, or Public.
In Visual Basic, you can use a variable name such as MyVal. If you were to put this
code in your project, you would make a variable named MyVal as type Variant. MyVal
would have a default value of empty. Whenever you use implicit declaration, Visual
Basic considers that variable as type Variant. Using implicit declaration isn't recommended,
however. Making a variable without a formal declaration is asking for trouble. If
you use implicit declaration, then any time you make a spelling mistake or syntax
error, Visual Basic will think that you're <I>implicitly</I> declaring another variable,
which can lead to headaches beyond imagination. By using implicit declaration, the
code below would return a zero from a &quot;mistake&quot; variable:</P>
<P>
<PRE>`Declare a variable to hold the value fo the winner
Dim iTheWinnner as Integer
`Assign a value to the winner variable
iTheWinner = 100
`This code will show you a message that says
`The winner has won: 0
`because you typed, iTheWhiner by mistake
MsgBox &quot;The winner has won: &quot; &amp; CStr(iTheWhiner)
</PRE>
<P>You can protect yourself. You can make the Visual Basic IDE force you to <I>explicitly</I>
declare a variable. All you need to do is enter the keywords Option Explicit in the
first line of the General section of your form or module. You can also configure
the IDE to automatically do this for you whenever you add a form or module.</P>
<P><B>Configure the IDE to automatically require variable declaration</B>

<DL>
	<DT></DT>
	<DD><B>1. </B>From the <B>Tools</B> menu, choose <B>Options</B>.
	<P>
	<DT></DT>
	<DD><B>2. </B>On the <B>Editor</B> page of the Options dialog, select the <B>Require
	Variable Declaration</B> check box (see Figure 7.2).
	<P><B>3. </B>Click OK.</P>
</DL>

<P><A HREF="javascript:popUp('07fig02.gif')"><B>FIGURE 7.2</B></A> <I>Itís always
preferable to configure the VB IDE to require you to declare your variables.</I></P>

<P><BR>
After you set Option Explicit, if you fail to declare a variable, you'll receive
the message Variable not defined when you try to compile your code. Visual Basic's
integrated debugger highlights the offending variable and halts the compilation of
your program. The benefit of this is that it helps you avoid code errors possibly
caused by typographical mistakes. For example, you might declare a variable with
the following statement:</P>

<P></P>
<PRE>Dim strMyName As String
</PRE>
<P>If, in a later statement, you mistype the variable name, Visual Basic will catch
the error for you. For example, the following statement would cause an error:</P>
<P>
<PRE>strMyNme = &quot;Clark Kent&quot;
</PRE>
<H2><A NAME="Heading6"></A>Using Type Suffixes with Variables</H2>
<P>In previous code examples, you saw that you use the As keyword to assign a data
type to a variable. You can use another method to declare a variable and assign a
data type to it--<I>data-type suffixes</I>. With this type of declaration, a special
character is used at the end of the variable name when the variable is first assigned
a value. Doing this automatically &quot;types&quot; (assigns a type to) the variables.
There's no need to use the As keyword. The characters for each variable type are
shown in Table 7.3.</P>
<P>
<H4>TABLE 7.3 Variable Suffixes</H4>
<P>
<TABLE BORDER="1">
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT"><B><I>Variable Type</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Suffix</I></B></TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Integer</TD>
		<TD ALIGN="LEFT">%</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Long</TD>
		<TD ALIGN="LEFT">&amp;</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Single</TD>
		<TD ALIGN="LEFT">!</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Double</TD>
		<TD ALIGN="LEFT">#</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Currency</TD>
		<TD ALIGN="LEFT">@</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">String</TD>
		<TD ALIGN="LEFT">$</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Byte</TD>
		<TD ALIGN="LEFT">None</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Boolean</TD>
		<TD ALIGN="LEFT">None</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Variable Type</TD>
		<TD ALIGN="LEFT">Suffix</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Date</TD>
		<TD ALIGN="LEFT">None</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Object</TD>
		<TD ALIGN="LEFT">None</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">Variant</TD>
		<TD ALIGN="LEFT">None</TD>
	</TR>
</TABLE>
</P>
<P>The code back in the section &quot;Using Explicit Declarations&quot; could be
rewritten with type suffixes as follows:</P>
<P>
<PRE>Private NumVal%
Private AvgVal%, Inputval#
Static CalcAverage!
Dim InputMsg$
</PRE>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>A controversy around suffixes</STRONG></P>
	<P>A controversy within the Visual Basic developer community surrounds the use of
	suffixes and prefixes. Some developers support the use of suffixes; others prefer
	the use of prefixes only. Whether to use suffixes, prefixes, or both is a decision
	usually made by the programming group to which you belong. Most programming groups
	have a document that defines the coding standard that you use during the course of
	a project. If you program with others, this is the standard that you should follow.
	The most important thing to remember is that your code must be easy to read, easy
	to maintain, and predictable to others with whom you work. 
<HR>


</BLOCKQUOTE>

<P>Using suffixes to assign a type to your variables is a quick, handy way to declare
a variable. Also, using a suffix adds a new element of readability to your variable
name. For example, now when you run across the variable NumVal% in your code, you
know that the variable is of type Integer (from reading the suffix) and that its
function is to be a value for a number (from reading the variable name).</P>
<P>
<H2><A NAME="Heading7"></A>Using Strings</H2>
<P>A <I>string</I> is a collection of characters. The following are examples of different
string values:</P>
<P>
<PRE>&quot;Cheese&quot;
&quot;You have made an error!&quot;
&quot;a&quot;
&quot;July 4, 1776&quot;
&quot;75&quot;
</PRE>
<P>Notice that each collection of characters is enclosed by quotation marks (&quot;&quot;).
The quotation marks are very important; they tell Visual Basic that the enclosed
characters are a <I>string value</I>. Characters not enclosed in quotation marks
are considered to be a variable or a part of the language.</P>
<P>You might find the string value &quot;75&quot; a bit baffling. You might think
that it's a value for an integer, but it's not. The following example illustrates
the string-ness of &quot;75&quot;:</P>
<P><B>strNum$ = &quot;7&quot; &amp; &quot;5&quot;</B></P>
<P>Another use of strings that use numeric characters are ZIP codes and phone numbers.
Notice that declaring the following ZIP code and phone number as strings allows you
to use the - character:</P>
<P>
<PRE>strMyZipCode = &quot;50311-0921&quot;
strPhone = &quot;1-515-555-1212&quot;
</PRE>
<P>Also, because they aren't number data types, you wouldn't and can't perform mathematical
operations on them, such as addition and multiplication.</P>
<P>Some beginning programmers have trouble with this concept; it takes a bit of getting
used to. If you look at the code in Listing 7.1, you'll see that the user's input
into the text boxes is treated as numeric string characters that must be converted
to integers (lines 13 and 17). Chapter 12, &quot;Working with Strings and Typecasting,&quot;
provides a more detailed look at this.</P>
<P>
<H3><A NAME="Heading8"></A>Using Variable-Length and Fixed-Length Strings</H3>
<P>Most strings that you will use in your programs are of the type known as <I>variable-length
strings</I>, which can contain any amount of text up to 64,000 characters. As information
is stored in the variable, the size of the variable adjusts to accommodate the length
of the string. There is, however, a second type of string in Visual Basic--the <I>fixed-length
string</I>.</P>
<P>As the name implies, a fixed-length string remains the same size, regardless of
the information assigned to it. If a fixed-length string variable is assigned an
expression shorter than the defined length of the variable, the remaining length
of the variable is filled with the space character. If the expression is longer than
the variable, only the characters that fit in the variable are stored; the rest are
discarded.</P>
<P>A fixed-length string variable can be declared only by using an explicit declaration
of the form, such as the following:</P>
<P>
<PRE>Dim <I>VarName</I> As String * <I>strlength</I>
</PRE>
<P>Therefore, to make a string, strMyString, that's always 128 characters long, you
would declare it as follows:</P>
<P>
<PRE>Dim strMyString As String * 128
</PRE>
<P>Notice that this declaration varies slightly from the previous declaration of
a string variable. The declaration of a fixed-length string variable contains an
asterisk (*) to tell Visual Basic that the string will be a fixed length. The final
parameter, <I>strlength</I>, tells the program the number of characters that the
variable can contain.</P>
<P>In the beginning, you probably won't have much need for fixed-length strings.
As you advance, you will use them, particularly when it's time to program directly
to Windows with the Windows API (Application Programming Interface).</P>
<P>
<H2><A NAME="Heading9"></A>Determining Where a Variable Can Be Used</H2>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Scope relates to declaration location</STRONG></P>
	<P>The scope of a variable is determined by not only the type of declaration used
	but also the declaration's location. For instance, the Dim keyword assumes different
	meanings in different parts of a form's code. You can use only the Private keyword
	on variables in the Declaration section. 
<HR>


</BLOCKQUOTE>

<P>In addition to telling Visual Basic what you want to be able to store in a variable,
a declaration statement tells Visual Basic where the variable can be used. This area
of use is called the <I>scope</I> of the variable. This is analogous to your phone
number. You might have a phone number 555-2576, which can be reached by anyone inside
your area code. However, if anyone outside your area code calls 555-2576, they will
get that number as it applies within their area code. If you want to be reached from
anywhere in the country, the person trying to reach you must use your area code before
your local number. Conceptually, the scope of a variable is similar. You can have
variables that can be seen locally only within a procedure, for instance, and you
can have variables that can be seen globally from anywhere within a form, module,
or even the whole program.</P>
<P>By default, a variable declared with a keyword such as Dim is local to the procedure
in which it's created. For example, if you declare a variable in the event procedure
for a CommandButton's Click() event procedure, it resides and is visible only within
that event procedure. Therefore, to create variables that have a scope other than
local, you must modify your declaration statement.</P>
<P>
<H3><A NAME="Heading10"></A>Making Variables Available Globally</H3>
<P>In most programs, unless you have only one form and no code modules, you'll find
that you need some variables that can be accessed from anywhere in the code. These
are called Public variables. (Other programming languages might refer to these as
global variables.) These variables are typically for holding information that's used
throughout the program. They can also be used to indicate various conditions in the
program.</P>
<P>To create a Public variable, you place a declaration statement with the Public
keyword in the Declarations section of a module of your program. The following line
shows the Public declaration of a variable of type Boolean (True/False):</P>
<P>
<PRE>Public bLightsOn as Boolean
</PRE>
<P>In a form, the Public keyword has a special meaning. Variables defined as Public
are considered to be very much like a property of the form and can be &quot;seen&quot;
from anywhere in the program. These properties are referenced like the built-in properties
of a form or control instead of like a variable. For example, you can have a string
variable, strMyName, declared Public in the form frmMain, and you would access the
string variable by using the following expression:</P>
<P>
<PRE>strSomeString = frmMain.strMyName
</PRE>
<P>You can use the Public properties to pass information between forms and other
parts of your program.</P>
<P>If you don't need to access a variable from everywhere in your program, you don't
want to use the Public keyword in a declaration. Instead, you use the keyword Dim
within a procedure. When the variable is declared inside a procedure, it can be used
only within that procedure. This is typically known as a <I>local variable</I>.</P>
<P>The keyword Private is used within a form or module's Declaration section to make
the variable visible only to the form or module within which it's created. This is
typically known as a <I>form-</I> or <I>module-level variable</I>.</P>
<P>
<H3><A NAME="Heading11"></A>Keeping a Variable Local</H3>
<P>At first glance, you might think that making all variables global is the easiest
thing to do, but as your programs grow, this practice won't serve you well in the
long run.</P>
<P>You saw in the preceding section that each <I>procedure</I> in a VB program can
have its own variables. Each procedure can have variable names that might be common
across other procedures, but because they are local to that procedure, none of the
others know about them. Thus, you avoid what are called <I>name collisions</I>.</P>
<P>Think of it this way: You might have two procedures, ProcA and ProcB. ProcA creates
two variables, x% and y%, and ProcB also creates two variables x% and y%. In ProcA,
x% and y% are assigned values that, in turn, are passed as values to the Left and
Top properties of a CommandButton, Command1.</P>
<P>In ProcB, the variable y% is assigned a value that's twice the value of x%. Both
procedures have variables of the same name. However, because each set of variables
was declared local to a distinct procedure, they are available only to the procedures
in which they were declared (see Figure 7.3) .</P>
<P><A HREF="javascript:popUp('07fig03.gif')"><B>FIGURE 7.3</B></A> <I>Properly scoping
your variables makes your code more reusable.</I></P>
<P>
<H2><A NAME="Heading12"></A>Using Static Variables</H2>
<P>Most variables created inside a procedure are discarded by Visual Basic when the
procedure is finished. Sometimes, however, you want to preserve the value of a variable
even after the procedure runs. This often is the case when you call the procedure
multiple times, and the value of a variable for one call to the procedure depends
on the value left over from previous calls.</P>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Using the Static keyword when declaring a procedure</STRONG></P>
	<P>If you use the Static keyword to declare a procedure, all variables in the procedure
	are treated as static. 
<HR>


</BLOCKQUOTE>

<P>To create a variable that retains its value even after the procedure is through
running, you use the Static keyword in the variable declaration. This tells Visual
Basic that the variable can be referenced only within the procedure but to hold on
to the value because it will be needed again. For example, to declare a static variable
for an integer, you use the following:</P>
<P><B>Static iNumOfClicks as Integer</B></P>
<P>A good use of a static variable would be where you needed to know how many times
somebody clicked a CommandButton. If you Dim a counting variable in a click event
procedure, the variable disappears when the click event is over and the variable
goes out of scope; thus, you couldn't know how many times it was clicked. If you
made the variable static, however, the value persists from click to click. Thus,
if you put the preceding line into a click event, you have a permanent way to keep
track of the number of clicks:</P>
<P>
<PRE>Sub MyButton_Click()
    Static iNumOfClicks as Integer
    iNumOfClicks = iNumOfClicks + 1
    MsgBox &quot;Number of Clicks: &quot; &amp; CStr(iNumOfClicks)
End Sub
</PRE>
<P>Static variables are commonly used in timer event procedures. You will read more
about this in Chapter 16, &quot;Working with Time and Timers.&quot;</P>
<P>
<H2><A NAME="Heading13"></A>Using Constants</H2>
<P>Variables are only one way of storing information in the memory of a computer.
Another way is to use <I>constants</I>. Constants in a program are treated a special
way. After you define them (or they're defined for you by Visual Basic), you can't
change them later in the program by using an assignment statement. If you try, Visual
Basic generates an error when you run your program.</P>
<P>Constants are most often used to replace a hard-to-remember value, such as the
color value for the Windows title bar. It's easier to remember the constant vbActiveTitleBar
than the value 2147483646. You can also use a constant to avoid typing long strings
if they're used in a number of places. For example, you could set a constant such
as ERR_FILE_FOUND containing the string &quot;The requested file was not found&quot;.</P>
<P>Often, constants are also used for conversion factors, such as 12 inches per foot
or 3.3 feet per meter. The following code example shows how constants and variables
are used:</P>
<P>
<PRE>Const METER_TO_FEET = 3.3
Meters# = CDbl(InputBox(&quot;Enter a distance in meters&quot;))
DistFeet# = Meters# * METER_TO_FEET
MsgBox &quot;The distance in feet is: &quot; &amp; CStr(DistFeet#)
</PRE>
<H3><A NAME="Heading14"></A>Using Constants Supplied by Visual Basic</H3>
<P>Visual Basic (as of version 4.0) supplies a number of sets of constants for various
activities. There are color-definition constants, data-access constants, keycode
constants, and shape constants, among others. The VB-supplied constants begin with
the prefix vb.</P>
<P>The constants that you need for most functions are defined in the help topic for
the function. If you want to know the value of a particular constant, you can use
the Object Browser (see Figure 7.4). Access the Object Browser by clicking its icon
in the Visual Basic toolbar or pressing the F2 key. You can use the list to find
the constant that you want. When you select it, its value and function are displayed
in the text area at the bottom of the dialog.</P>
<P><A HREF="javascript:popUp('07fig04.gif')"><B>FIGURE 7.4</B></A> <I>Select the
appropriate constants from the Classes list to view the constants internal to Visual
Basic.</I></P>
<P>
<H3><A NAME="Heading15"></A>Creating Your Own Constants</H3>
<P>Although Visual Basic defines a large number of constants for many activities,
sometimes you need to define your own constants. Constants are defined with the Const
keyword statement to give the constant a name and a value, as shown in the following
syntax:</P>
<P>
<PRE>Const <I>CONSTANT_NAME</I> [As <I>ConstantType</I>] = <I>value</I>
</PRE>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Naming conventions for constants</STRONG></P>
	<P>Constants are typically named with all uppercase characters and, if necessary,
	with an underscore character (_) to separate the characters into words: SECRET_NUMBER
	= 42. Now that Visual Basic supports its own constants and constants dedicated to
	classes, however, it's conventional to name constants in mixed case, with a lowercase
	prefix: snNumber = 42. 
<HR>


</BLOCKQUOTE>

<P>This statement appears similar to the declaration of a variable. As with declaring
a variable, you provide a name for the constant and optionally specify the type of
data it will hold. The Const keyword at the beginning of the statement tells Visual
Basic that this statement defines a constant. This distinguishes the statement from
one that just assigns a value to a variable. In declaring the type of a constant,
you use the same types as you did for defining variables (refer to Table 7.2). Finally,
to define a constant, you must include the equal sign (=) and the value to be assigned.
If you're defining a string, remember to enclose the value in quotes (&quot;&quot;).</P>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>What's a function?</STRONG></P>
	<P>A function is a named section of code that returns a value. You can reuse functions
	many times within your program. For calculation purposes, you can pass information
	into functions. The information that you pass into a function is called a parameter,
	also known as an argument. For more information about functions, see Chapter 18,
	&quot;Writing Reusable Code with Subs and Functions.&quot; 
<HR>


</BLOCKQUOTE>

<H2><A NAME="Heading16"></A>Using the Assignment Statement</H2>
<P>To use variables efficiently, you must also be able to assign information to the
variable and manipulate that information. After you set up a variable, you need to
store information in it. This is the job of the assignment statement. In the <I>assignment
statement</I>, you specify a variable whose value you want to set. To assign a value
to a variable, place an equal sign after the variable name and follow this with the
expression that represents the value you want stored. The expression can be a literal
value, a combination of other variables and constants, or functions that return a
value. There's no limit on the complexity of the expression you use. However, even
though Visual Basic will attempt to automatically convert mismatching data types,
you should try to assign the correct type to the values that you assign to your program's
variables. The following statements illustrate different assignment statements:</P>
<P>
<PRE>NumStudents% = 25
SumScores% = 2276
AvgScore% = SumScores% / NumStudents%
TopStudent$ = &quot;Janet Simon&quot;
BadStudent$ = txtStudent.Text
</PRE>
<P>You can consider most properties of forms and controls as variables. They can
be set at design time but also can be changed at runtime with an assignment statement.
You can also use a property on the right side of a statement to assign its value
to a variable for further processing. You saw this done in Listing 7.1. After the
addition program shown in Figure 7.1 calculates the sum of the two entered numbers,
it assigns the result to a third TextBox, as shown in lines 23-26:</P>
<P>
<PRE>`Convert the third variable (which is an integer)
`to text and assign it to the text property of the
`TextBox for the result.
txtTotal.Text = CStr(z)
</PRE>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Understanding type mismatch errors</STRONG></P>
	<P>A type mismatch error occurs when you try to assign a value to a variable that's
	not the expected data type. For example, if you create a variable x% of type Integer
	and try to assign a string value to it, you commit a type mismatch and receive a
	type mismatch error:</P>
	<PRE>Dim x%
`Next line causes
`type mismatch error
x% = &quot;Happy Birthday!&quot;</PRE>
	<P>
<HR>
</P>
	<PRE></PRE>

</BLOCKQUOTE>

<H2><A NAME="Heading17"></A>Revisiting the Addition Program</H2>
<P>Now that you've explored what variables are about and how to use them, you should
have a better sense of what's going on in the addition program shown earlier in the
chapter. If you look closely, though, you'll see that the programmer made an assumption
about user input, which will result in a serious error. What happens when users don't
enter a number into a text box but instead another sort of string value (see Figure
7.5)?</P>
<P><A HREF="javascript:popUp('07fig05.gif')"><B>FIGURE 7.5</B></A> <I>Don't assume
that users will always enter the data type that your program requires.</I></P>
<P>The result is a <I>crash</I>.</P>
<P>To prevent such an occurrence, you could use the Visual Basic IsNumeric() function
to check the value to make sure that the entry is indeed a numeric value. For example,
before line 13 in Listing 7.1, you would enter the following line to prevent users
from assigning any non-numeric character to the variable x%:</P>
<P>
<PRE>If IsNumeric(txtNumOne.Text) then
      x = CInt(txtNumOne.Text)
End if
</PRE>
<P>Obviously, making sure that the right type of data is assigned to the right type
of variable (what's referred to as <I>data validation</I>) is more than an academic
exercise--it's a critical programming skill. You'll find out how to solve this problem
in Chapter 9, &quot;Working with Conditional Statements&quot;; Chapter 21, &quot;Debugging
Your Applications&quot;; and Chapter 12, &quot;Working with Strings and Typecasting.&quot;</P>
<H1></H1>
<CENTER>
<P>
<HR>
<A HREF="ch06.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch06/ch06.htm"><IMG SRC="previous.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/previous.gif" WIDTH="128" HEIGHT="28"
ALIGN="BOTTOM" ALT="Previous chapter" BORDER="0"></A><A HREF="ch08.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch08/ch08.htm"><IMG
SRC="next.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/next.gif" WIDTH="128" HEIGHT="28" ALIGN="BOTTOM" ALT="Next chapter"
BORDER="0"></A><A HREF="index-38.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/index.htm"><IMG SRC="contents.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/contents.gif" WIDTH="128"
HEIGHT="28" ALIGN="BOTTOM" ALT="Contents" BORDER="0"></A></P>

<P>&copy; <A HREF="copy.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/copy.htm">Copyright</A>, Macmillan Computer Publishing. All
rights reserved.
</CENTER>

</BODY>

</HTML>
