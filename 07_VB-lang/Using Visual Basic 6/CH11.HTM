<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>

<HEAD>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">
<SCRIPT LANGUAGE="JavaScript">

<!--

function popUp(pPage) {
 var fullURL = document.location;
 var textURL = fullURL.toString();
 var URLlen = textURL.length;
 var lenMinusPage = textURL.lastIndexOf("/");
 lenMinusPage += 1;
 var fullPath = textURL.substring(0,lenMinusPage);
 popUpWin = window.open('','popWin','resizable=yes,scrollbars=no,width=525,height=394');
 figDoc= popUpWin.document;
 zhtm= '<HTML><HEAD><TITLE>' + pPage + '</TITLE>';
 zhtm += '</head>';
 zhtm += '<BODY bgcolor="#FFFFFF">';
 zhtm += '<IMG SRC="' + fullPath + pPage + '">';
 zhtm += '<P><B>' + pPage + '</B>';
 zhtm += '</BODY></HTML>';
 window.popUpWin.document.write(zhtm);
 window.popUpWin.document.close();
 // Johnny Jackson 4/28/98
 }

//-->
                                                                
</SCRIPT>
<link rel="stylesheet" href="ebooks.css" tppabs="http://pbs.mcp.com/includes/stylesheets/ebooks.css">

	<META NAME="GENERATOR" Content="Symantec Visual Page Mac 1.1.1">
	<TITLE>Using Visual Basic 6 -- Ch 11 --Working with Arrays</TITLE>
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF">

<H1 ALIGN="CENTER"><IMG SRC="que.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/que.gif" WIDTH="171" HEIGHT="66" ALIGN="BOTTOM"
BORDER="0"><BR>
Using Visual Basic 6</H1>
<CENTER>
<P><A HREF="ch10.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch10/ch10.htm"><IMG SRC="previous.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/previous.gif" WIDTH="128" HEIGHT="28"
ALIGN="BOTTOM" ALT="Previous chapter" BORDER="0"></A><A HREF="ch12.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch12/ch12.htm"><IMG
SRC="next.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/next.gif" WIDTH="128" HEIGHT="28" ALIGN="BOTTOM" ALT="Next chapter"
BORDER="0"></A><A HREF="index-38.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/index.htm"><IMG SRC="contents.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/contents.gif" WIDTH="128"
HEIGHT="28" ALIGN="BOTTOM" ALT="Contents" BORDER="0"></A> 
<HR>

</CENTER>
<H1 ALIGN="CENTER">- 11 -<BR>
Working with Arrays</H1>
<H1></H1>

<UL>
	<LI><A HREF="#Heading1">What Is an Array?</A>
	<LI><A HREF="#Heading2">Declaring Arrays</A>
	<UL>
		<LI><A HREF="#Heading3">Declaring an Array like Declaring a Single Variable</A>
		<LI><A HREF="#Heading4">Declaring an Array with the To Keyword</A>
	</UL>
	<LI><A HREF="#Heading5">Changing the Number of Elements in an Array</A>
	<LI><A HREF="#Heading6">Multidimensional Arrays</A>
	<UL>
		<LI><A HREF="#Heading7">Using Loops to Traverse an Array</A>
	</UL>
	<LI><A HREF="#Heading8">Adding Items to ListBoxes and ComboBoxes</A>
	<LI><A HREF="#Heading9">Selecting Items from a List</A>
	<LI><A HREF="#Heading10">Removing Items from a List</A>
	<LI><A HREF="#Heading11">Clearing a List</A>
	<LI><A HREF="#Heading12">Understanding ComboBox Styles</A>
	<LI><A HREF="#Heading13">Using Arrays, ComboBoxes, and ListBoxes in a Sample Program</A>
	<LI><A HREF="#Heading14">Examining ScoreKeeper's Event Procedures</A>
</UL>

<P>
<HR SIZE="4">

<H2><A NAME="Heading1"></A>What Is an Array?</H2>
<P>A collection of similar variables, in which each has the same name and all are
of the same type, is an <I>array</I>. Remember that a variable can be thought of
as a cup that holds an unknown value or an always changing value (see Figure 11.1).</P>
<P><A HREF="javascript:popUp('11fig01.gif')"><B>FIGURE 11.1</B></A> <I>A variable
is a placeholder for a specific type of value.</I></P>
<P>Think of an array, then, as a collection of cups. Each cup in the collection can
hold the same type of data, and every cup in the collection has the same name. Each
cup within the collection is an <I>element</I> and has a number assigned to it that
reflects its position within the collection. The first element of an array usually
has a position number of 0 (zero).</P>
<P>Arrays can be different sizes (see Figure 11.2). One array might have three elements,
another might have 30 elements, and it's even possible for an array to have no elements
at all--only the possibility of having elements that are created at a later time.</P>
<P><A HREF="javascript:popUp('11fig02.gif')"><B>FIGURE 11.2</B></A> <I>An array is
a collection of variables.</I></P>
<P>
<H2><A NAME="Heading2"></A>Declaring Arrays</H2>
<P>You can declare, or<I> dimension</I>, an array in two ways: as you would a single
variable and by using the To keyword.</P>
<P>
<H3><A NAME="Heading3"></A>Declaring an Array like Declaring a Single Variable</H3>
<P>To declare an array as you would a single variable, you use the following syntax:</P>
<P>
<PRE>Dim|Public|Private <I>ArrayName</I>(<I>Subscript</I>) As <I>DataType</I>
</PRE>
<P>In this syntax,</P>

<UL>
	<LI>Dim, Public, and Private are Visual Basic keywords that declare the array and
	its scope. If you use Dim, the array is private to the procedure in which it is declared.
	Public makes the array visible from anywhere in the program, and Private (within
	the General section of a form or module) makes the array visible only to the form
	or module in which it's declared. If you use Dim within a module's procedure, the
	array will be available to only that procedure, but if you use Dim in the module's
	Declarations section, the array will be available to all procedures within the module.
	<P>
	<LI><I>ArrayName</I> is the name of the array.
</UL>



<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Option base</STRONG></P>
	<P>When you declare an array, the first element of the array is usually 0 (zero).
	It's possible, however, to force the first element of an array to be 1. To do this,
	insert the statement Option Base 1 in the General section of a module within your
	project. You have to do this only when you want the first element of your array to
	be element number 1. 
<HR>


</BLOCKQUOTE>


<UL>
	<LI><I>Subscript</I> is the number of the highest element in the array. Remember
	that the first element in an array is usually zero, so if you declare an array in
	which Subscript is 6, you'll have seven element positions and, therefore, seven elements.
	<P>
	<LI>As is the Visual Basic keyword that signifies a type declaration.
	<P>
	<LI><I>DataType</I> is any valid Visual Basic data type, such as Integer or Double.
</UL>

<P>Therefore, to declare an array of integers with five elements in it, you would
use the following:</P>
<P>
<PRE>Dim iMyArray(4) As Integer
</PRE>
<P>To assign a value to each element in the array iMyArray, you would use the following:</P>
<P>
<PRE>iMyArray(0) = 9
iMyArray(1) = 342
iMyArray(2) = 2746
iMyArray(3) = 0
iMyArray(4) = 8901
</PRE>
<P>To change the value of the fourth element of the array iMyArray from 0 (zero)
to 45, you would do as follows:</P>
<P>
<PRE>iMyArray(3) = 45
</PRE>
<P>To declare an array of nine strings global to your entire program, you would use
the code in Listing 11.1.</P>
<P>
<H4>LISTING 11.1&nbsp;&nbsp;11LIST01.TXT--Assigning Values to an Array's Elements</H4>
<PRE>01 Public strMyArray(8) As String</PRE>
<PRE>02</PRE>
<PRE>03 strMyArray(0) = &quot;I am a pitcher.&quot;</PRE>
<PRE>04 strMyArray(1) = &quot;I am a catcher.&quot;</PRE>
<PRE>05 strMyArray(2) = &quot;I play first base.&quot;</PRE>
<PRE>06 strMyArray(3) = &quot;I play second base.&quot;</PRE>
<PRE>07 strMyArray(4) = &quot;I play third base.&quot;</PRE>
<PRE>08 strMyArray(5) = &quot;I play shortstop.&quot;</PRE>
<PRE>09 strMyArray(6) = &quot;I play left field.&quot;

10 strMyArray(7) = &quot;I play center field.&quot;</PRE>
<PRE>11 strMyArray(8) = &quot;I play right field.&quot;</PRE>
<P>
<H3><A NAME="Heading4"></A>Declaring an Array with the To Keyword</H3>
<P>You can also declare an array by using the To keyword within the subscript syntax.
For example, if you want to create an array of five Integer variables in which the
first element is number 1 and the last element is number 5, you use</P>
<P>
<PRE>Dim iMyArray(1 To 5) as Integer
</PRE>
<P>This method provides an easy way to start your element numbering at a value other
than 0 (zero).</P>
<P>
<H2><A NAME="Heading5"></A>Changing the Number of Elements in an Array</H2>
<P>Although you usually set the number of elements in an array when you declare it,
it's possible to alter the size of the array. When you change the number of elements
in an existing array, you <I>redimension </I>it. To do so, use the ReDim keyword
in the following syntax:</P>
<P>
<PRE>ReDim [Preserve] <I>ArrayName</I>(<I>Subscript</I>) As <I>DataType</I>
</PRE>
<P>In this syntax,</P>

<UL>
	<LI>ReDim is the Visual Basic keyword denoting that the array is being redimensioned.
	<P>
	<LI>Preserve is an optional Visual Basic keyword that forces all pre-existing elements
	in the array to hold their values. If you don't use the Preserve keyword when you
	redimension the array, the value of all elements will be changed to zero for numeric
	data types, and a zero-length string (&quot;&quot;) for variable-length strings.
	Fixed-length strings will be filled with zeros, and variants will be initialized
	to EMPTY, which could be either zero or a zero-length string, depending on the expression.
	<P>
	<LI><I>ArrayName</I> is the name of the array.
	<P>
	<LI><I>Subscript</I> is the subscript for the highest element in the array.
	<P>
	<LI>As is the Visual Basic keyword that signifies a type declaration. When redimensioning
	an array, the As keyword is optional.
	<P>
	<LI><I>DataType</I> is any valid Visual Basic data type, such as Integer or Double.
	When redimensioning an array, the <I>DataType</I> is optional and can't be changed
	with the Redim keyword unless the array is of type Variant.
</UL>



<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Using ReDim in your code</STRONG></P>
	<P>The actual implementation of the ReDim statement is different from this conceptual
	illustration. If you create an array that you'll later redimension, you can't hard
	code the element size of the array when you first declare it. Therefore, in practice,
	the code here won't redimension the array declared in Listing 11.1. 
<HR>


</BLOCKQUOTE>

<P>The following code shows how, conceptually, to redimension the array strMyArray
(from Listing 11.1) to contain 10 elements:</P>
<P>
<PRE>ReDim Preserve strMyArray(9)
strMyArray(9) = &quot;I am the designated hitter.&quot;
</PRE>
<P>To create an array that you'll later resize, you must first create the array without
any elements. Listing 11.2 shows the proper way to create an array that you'll later
redimension.</P>
<P>
<H4>LISTING 11.2&nbsp;&nbsp;11LIST02.TXT--Diming an Array Without Any Elements Before
<BR>
ReDiming It</H4>
<PRE>01 `Create an array without any elements</PRE>
<PRE>02 Dim strMyArray() as String</PRE>
<PRE>03</PRE>
<PRE>04 `Dimension the array for 9 elements</PRE>
<PRE>05 ReDim strMyArray(8)</PRE>
<PRE>06</PRE>
<PRE>07 `Assign values to the array elements</PRE>
<PRE>08 strMyArray(0) = &quot;I am a pitcher.&quot;</PRE>
<PRE>09 strMyArray(1) = &quot;I am a catcher.&quot;</PRE>
<PRE>10 strMyArray(2) = &quot;I play first base.&quot;</PRE>
<PRE>11 strMyArray(3) = &quot;I play second base.&quot;</PRE>
<PRE>12 strMyArray(4) = &quot;I play third base.&quot;</PRE>
<PRE>13 strMyArray(5) = &quot;I play shortstop.&quot;</PRE>
<PRE>14 strMyArray(6) = &quot;I play left field.&quot;</PRE>
<PRE>15 strMyArray(7) = &quot;I play center field.&quot;</PRE>
<PRE>16 strMyArray(8) = &quot;I play right field.&quot;</PRE>
<PRE>17</PRE>
<PRE>18 `Add an element and make it so all the values</PRE>
<PRE>19 `of the previous elements are kept intact</PRE>
<PRE>20 ReDim Preserve strMyArray(9)</PRE>
<PRE>21</PRE>
<PRE>22 `Assign a value to the new array element</PRE>
<PRE>23 strMyArray(9) = &quot;I am the designated hitter.&quot;</PRE>
<P>Notice in Listing 11.2 that the first ReDim statement (line 5) doesn't use the
Preserve keyword. You can do this because initially there are no values within the
array to preserve. In the second ReDim statement on line 20, however, the Preserve
keyword is very important because the pre-existing elements have assigned values
that you don't want to lose. If you didn't use the Preserve keyword in the second
ReDim statement, strMyArray would have the following values:</P>
<P>
<PRE>strMyArray (0) = &quot;&quot;
strMyArray (1) = &quot;&quot;
strMyArray (2) = &quot;&quot;
strMyArray (3) = &quot;&quot;
strMyArray (4) = &quot;&quot;
strMyArray (5) = &quot;&quot;
strMyArray (6) = &quot;&quot;
strMyArray (7) = &quot;&quot;
strMyArray (8) = &quot;&quot;
strMyArray (9) = &quot;I am the designated hitter.&quot;
</PRE>
<P>Remember, arrays are tricky. Be careful!</P>
<P>
<H2><A NAME="Heading6"></A>Multidimensional Arrays</H2>
<P>So far, the arrays in this chapter have been <I>one-dimensional</I> <I>arrays</I>--that
is, they are a one-row collection of variables, as seen in Figure 11.2. In Visual
Basic, however, you can create arrays that have up to 60 dimensions. Usually, two-dimensional
arrays will suffice for most introductory programming projects, and most likely you
won't need to make an array of more than three dimensions.</P>
<P>Think of a two-dimensional array as a tic-tac-toe board--a set of columns and
rows that intersect to form a grid. Each grid cell has a location defined as <I>ColumnNumber</I>,
<I>RowNumber</I>. Figure 11.3 is a conceptual illustration of iVar(2,4), a two-dimensional
array of integers. Notice that each element is defined by the coordinates of the
column position and the row position. For example, the array element iVar(0, 0) is
5 and the element iVar(2,2) is 49.</P>
<P>To create a two-dimensional array, use the following syntax:</P>
<P>
<PRE>Dim|Public|Private ArrayName(<I>SubscriptOfCols</I>, _
                             <I>SubscriptOfRows</I>) As <I>DataType</I>
</PRE>
<P>In this syntax,</P>

<UL>
	<LI>Dim, Public, and Private are Visual Basic keywords that declare the array and
	its scope. If you use Dim, the array is private to the procedure in which it's declared.
	Public makes the array visible from anywhere in the program, and Private (within
	a form or module's General section) makes the array visible only to the form or module
	in which it's declared. Using Dim within a module automatically makes the array available
	anywhere in the program, as if the Public keyword were used.
	<P>
	<LI><I>ArrayName</I> is the name of the array.
	<P>
	<LI><I>SubscriptOfCols</I> is the number of the highest column in the array.
	<P>
	<LI><I>SubscriptOfRows</I> is the number of the highest row in the array.
	<P>
	<LI>As is the Visual Basic keyword that denotes type declaration.
	<P>
	<LI><I>DataType</I> is any valid Visual Basic data type.
</UL>

<P><A HREF="javascript:popUp('11fig03.gif')"><B>FIGURE 11.3</B></A> <I>Think of a
two-dimensional array as a collection of cups arranged in columns and rows.</I></P>
<P>Therefore, to declare the array shown in Figure 11.3, you would use the following
syntax:</P>
<P>
<PRE>Dim iVar(2,4) as Integer
</PRE>
<P>Whereas you can consider a two-dimensional array to be a rectangle, you can consider
a three-dimensional array to be a rectangular block. To declare a three-dimensional
array of integers, use</P>
<P>
<PRE>Dim iVar(1,2,1) as Integer
</PRE>
<P>Figure 11.4 is a conceptual illustration of the three-dimensional array defined
in the preceding line.</P>
<P><A HREF="javascript:popUp('11fig04.gif')"><B>FIGURE 11.4</B></A> <I>A three-dimensional
array (1,2,1) has 12 elements. It's two columns wide by three rows tall by two planes
deep.</I></P>
<P>In the array iVar, the value assigned to each element, as depicted in Figure 11.4,
is as follows:</P>
<P>
<PRE>iVar(0,0,0) = 5
iVar(0,1,0) = 187
iVar(0,2,0) = 16
iVar(1,0,0) = 12
iVar(1,1,0) = 55
iVar(1,2,0) = 7
iVar(0,0,1) = 34
iVar(0,1,1) = 13
iVar(0,2,1) = 4500
iVar(1,0,1) = 612
iVar(1,1,1) = 9
iVar(1,2,1) = 784
</PRE>
<P>Just as with a one-dimensional array, you can use the To keyword when declaring
the subscript range of each dimension in a multidimensional array. Thus, the line</P>
<P>
<PRE>Dim dMyArray(1 To 5,  3 To 8,  3 To 5) As Double
</PRE>
<P>would declare a three-dimensional array of Double values, five columns wide by
six rows tall by three planes deep.</P>
<P>You can also use the Redim keyword to resize a multidimensional array. If you
use the Preserve keyword, however, only the last dimension of a multidimensional
array can be resized, and the number of dimensions can't be changed.</P>
<P>
<H3><A NAME="Heading7"></A>Using Loops to Traverse an Array</H3>
<P>You can use the For...Next loop that you learned about in Chapter 10, &quot;Working
with Loops,&quot; to move through, or <I>traverse</I>, an array. This can be useful
when you want to change or report values in an array.</P>
<P>Listing 11.3 is an example of using a For...Next loop to traverse an array. The
listing is the event procedure for a button click, in which an array of 20 elements
is created. A For...Next loop is used twice--first to assign values to every element
in the array, and then to find the value assigned to every element and make a string
that reports the value of that element (see Figure 11.5).</P>
<P>
<H4>LISTING 11.3&nbsp;&nbsp;11LIST03.TXT--Using For...Next Loops to Traverse an Array</H4>
<PRE>01 Private Sub cmdTraverse_Click()</PRE>
<PRE>02 Dim i%</PRE>
<PRE>03 Dim iMyArray%(19) As Integer</PRE>
<PRE>04 Dim BeginMsg$</PRE>
<PRE>05 Dim MidMsg$</PRE>
<PRE>06 Dim LoopMsg$</PRE>
<PRE>07 Dim FullMsg$</PRE>
<PRE>08</PRE>
<PRE>09 `Assign a value to each element in the array</PRE>
<PRE>10 `by using a loop to traverse to each element</PRE>
<PRE>11 `in the array.</PRE>
<PRE>12 For i% = 0 To 19</PRE>
<PRE>13 `Make the value of the element to be</PRE>
<PRE>14 `twice the value of i%</PRE>
<PRE>15 iMyArray%(i%) = i% * 2</PRE>
<PRE>16 Next i%</PRE>
<PRE>17</PRE>
<PRE>18 `Create the BeginMsg$ string</PRE>
<PRE>19 BeginMsg$ = &quot;The element is: &quot;</PRE>
<PRE>20 MidMsg$ = &quot;, The value is: &quot;</PRE>
<PRE>21 `Go through the array again and make</PRE>
<PRE>22 `a string to display</PRE>
<PRE>23 For i% = 0 To 19</PRE>
<PRE>24 LoopMsg$ = LoopMsg$ &amp; BeginMsg$ &amp; CStr(i%)</PRE>
<PRE>25 LoopMsg$ = LoopMsg$ &amp; MidMsg$ &amp; iMyArray(i%)</PRE>
<PRE>26</PRE>
<PRE>27 `Concatenate the loop message to the</PRE>
<PRE>28 `full message. Also add a line break</PRE>
<PRE>29 FullMsg$ = FullMsg$ &amp; LoopMsg$ &amp; vbCrLf</PRE>
<PRE>30</PRE>
<PRE>31 `Clean out the loop message so that</PRE>
<PRE>32 `new value next time through the loop</PRE>
<PRE>33 LoopMsg$ = &quot;&quot;</PRE>
<PRE>34 Next i%</PRE>
<PRE>35</PRE>
<PRE>36 txtTraverse.Text = FullMsg$</PRE>
<PRE>37 End Sub</PRE>
<P><A HREF="javascript:popUp('11fig05.gif')"><B>FIGURE 11.5</B></A> <I>This program
sets the value of each array element to twice its element number.</I></P>
<P>The code in Listing 11.3 is simple. Remember that a For...Next loop increments
a counting variable as it loops. You assign this counting variable to the element
position of the array. Then, set the lower bound of the array (the lowest element
number) to the start point of the loop and set the upper bound of the array (the
highest element number) to the end point of the loop. When you run the loop, the
counting variable will always be at an element of the array.</P>
<P>
<H2><A NAME="Heading8"></A>Adding Items to ListBoxes and ComboBoxes</H2>
<P>Of all the standard controls, the ListBox and ComboBox are best suited for categorizing
and listing information from which users can make choices and selections. These controls
are closely related, and the manner in which you manipulate them is almost identical.
The difference is that the ComboBox combines a ListBox control with a TextBox (hence
the name) and allows users to select from a list or type a new value.</P>
<P>Both the ListBox and ComboBox controls can handle lists. In Visual Basic, a <I>list</I>
is an array of strings formally referred to with the List property. (The List property
is common to the ListBox and ComboBox controls.) Most work that you do with ListBoxes
and ComboBoxes involves adding and removing strings from the List property. You can
add strings to the List property of a ListBox or ComboBox at design time or runtime.</P>
<P><B>Add strings to a ListBox or ComboBox at design time</B>

<DL>
	<DT></DT>
	<DD><B>1. </B>Add a ListBox or a ComboBox control to the form.
	<P>
	<DT></DT>
	<DD><B>2. </B>Select this control on the form.
	<P>
	<DT></DT>
	<DD><B>3. </B>In the Properties window, select the List property (see Figure 11.6)
	and type the strings for the List property in the drop-down box. To add multiple
	lines to the List property, press Ctrl+Enter to add a new line to it (see Figure
	11.7).
	<P>
</DL>

<P>At design time, the strings you added to the List property will appear in the
ListBox on the form (see Figure 11.8).</P>
<P><A HREF="javascript:popUp('11fig06.gif')"><B>FIGURE 11.6</B></A> <I>You can add
strings to a ListBox or a ComboBox at design time by entering values in the List
property drop-down list.</I></P>
<P><A HREF="javascript:popUp('11fig07.gif')"><B>FIGURE 11.7</B></A> <I>To add multiple
items to a ListBox list at design time, press Ctrl+Enter.</I></P>
<P><A HREF="javascript:popUp('11fig08.gif')"><B>FIGURE 11.8</B></A> <I>You can view
a ListBox's list at design time.</I></P>
<P>This design-time method for populating the List property is useful when your program
starts up. Because the contents of a ListBox or ComboBox can change frequently while
your program is running, however, you need to be able to add and remove items to
and from the List property while it's running. To do this, the ListBox and CombBox
controls make extensive use of the AddItem, RemoveItem, and Clear methods.</P>
<P>To add a string to the List of a Listbox or ComboBox during runtime, use the AddItem
method, which has the following syntax:</P>
<P>
<PRE><I>Object</I>.AddItem <I>StringToAdd</I>
</PRE>
<P>In this syntax,</P>

<UL>
	<LI><I>Object</I> is the Name property of the ListBox or ComboBox.
	<P>
	<LI>AddItem is the Visual Basic keyword for the method.
	<P>
	<LI><I>StringToAdd</I> is the string that you want to add to the control's list.
</UL>

<P>Listing 11.4 shows you how to use the AddItem method in a form's Load event procedure
to add strings to the List of a ListBox. Figure 11.9 shows the result of the form's
Load event.</P>
<P>
<H4>LISTING 11.4&nbsp;&nbsp;11LIST04.TXT--Using the AddItem Method to Add Items to
a ListBox Control</H4>
<PRE>01 Private Sub Form_Load()</PRE>
<PRE>02 lstHero.AddItem &quot;Superman&quot;</PRE>
<PRE>03 lstHero.AddItem &quot;Batman&quot;</PRE>
<PRE>04 lstHero.AddItem &quot;Green Lantern&quot;</PRE>
<PRE>05 lstHero.AddItem &quot;Aquaman&quot;</PRE>
<PRE>06 lstHero.AddItem &quot;SpiderMan&quot;</PRE>
<PRE>07 lstHero.AddItem &quot;Daredevil&quot;</PRE>
<PRE>08 lstHero.AddItem &quot;Hulk&quot;</PRE>
<PRE>09 End Sub</PRE>
<P><A HREF="javascript:popUp('11fig09.gif')"><B>FIGURE 11.9</B></A> <I>You can use
the AddItem method in a formís Load event to initialize the List property of a ListBox
control.</I></P>

<P>
<H2><A NAME="Heading9"></A>Selecting Items from a List</H2>
<P>To understand how Visual Basic determines the value of a string selected in the
List of a ListBox or ComboBox, you need to understand that a List is an array of
strings. As you learned earlier in this chapter, an array is declared as follows:</P>
<P>
<PRE>Dim <I>ArrayName</I>(<I>Subscript</I>) As <I>DataType</I>
</PRE>
<P>Therefore, if you declared a four-element array as MyArray(3), you would list
the elements in that array as follows:</P>
<P>
<PRE>MyArray(0)
MyArray(1)
MyArray(2)
MyArray(3)
</PRE>
<P>If you want to determine the value assigned to the second element, you could use
the following statement (remember, by default the first element is MyArray(0)):</P>
<P>
<PRE>MyValue = MyArray(1)
</PRE>
<P>The ListBox and ComboBox controls use a similar format. The property List is the
general term that Visual Basic uses to refer to the entire array of strings within
a ListBox or ComboBox. Therefore, to find the value of the second string in the ListBox
called lstHero (from Listing 11.4), you would use the following statement:</P>
<P>
<PRE>SecondString$ = lstHero.List(1)
</PRE>
<P>The value of SecondString$ is &quot;Batman&quot;.</P>
<P>For a ListBox or ComboBox, the selected item in a list is contained in the ListIndex
property. When you select a string in a ListBox, Visual Basic assigns the position
number of that string to the ListIndex property of the control. Therefore, to determine
the value of the selected string in lstHero (from Listing 11.4), you would use the
following code:</P>
<P>
<PRE>Private Sub lstHero_Click()
    lblHero.Caption = lstHero.List(lstHero.ListIndex)
End Sub
</PRE>
<P>This is the event procedure for the Click event of the lstHero ListBox control.
When the user clicks a string in the ListBox, the code executes and reports back
the value of the selection within the Caption property of the Label named lblHero.
Figure 11.10 shows what happens when the user selects a string.</P>
<P><A HREF="javascript:popUp('11fig10.gif')"><B>FIGURE 11.10</B></A> <I>You can program
the Click, MouseUp, or MouseDown events of a ListBox to find the value of a user's
selection.</I></P>
<P>A faster way to find out the value of the string a user selects in a ListBox or
ComboBox is to use the Text property. For example, you can use the following for
a ListBox:</P>
<P>
<PRE>Dim strMyStr as String
strMyStr = List1.Text
</PRE>
<P>For a ComboBox, use the following:</P>
<P>
<PRE>Dim strMyStr as String
strMyStr = Combo1.Text
</PRE>
<H2><A NAME="Heading10"></A>Removing Items from a List</H2>
<P>You remove a string from a list in a ListBox or ComboBox by using the RemoveItem
method:</P>
<P>
<PRE><I>Object</I>.RemoveItem <I>Index</I>
</PRE>
<P>In this syntax</P>

<UL>
	<LI><I>Object</I> is the Name property of the ListBox or ComboBox.
	<P>
	<LI>RemoveItem is the Visual Basic keyword for the method used to remove items from
	a list.
	<P>
	<LI><I>Index</I> is the position in the List property of the string that you want
	to remove from the control. To remove a selected item from a list, use the ListIndex
	property of the control.
</UL>

<P>Figure 11.11 shows an enhancement to the program presented in Figure 11.10. A
button has been added to remove the string that the user selects from the ListBox.
Listing 11.5 shows the RemoveItem method used in code.</P>
<P>
<H4>LISTING 11.5&nbsp;&nbsp;11LIST05.TXT--Using the RemoveItem Method to Remove a
String <BR>
from a ListBox</H4>
<PRE>01 Private Sub cmdRemove_Click()</PRE>
<PRE>02 lstHero.RemoveItem (lstHero.ListIndex)</PRE>
<PRE>03 lblHero.Caption = &quot;&quot;</PRE>
<PRE>04 End Sub</PRE>
<P>When you remove an item from a ListBox or ComboBox, make sure that you clear the
text from the Caption property of the Label control lblHero, as shown in line 3 of
Listing 11.5. If you don't do this, the user will remove the string from the ListBox,
but it will remain in the Label control.</P>
<P><A HREF="javascript:popUp('11fig11.gif')"><B>FIGURE 11.11</B></A> <I>A CommandButton
provides a way for the user to remove an item from a list.</I></P>
<P>
<H2><A NAME="Heading11"></A>Clearing a List</H2>
<P>If you want to remove all the strings contained in a ListBox or ComboBox, use
the Clear method:</P>
<P>
<PRE><I>Object</I>.Clear
</PRE>
<P>In this syntax</P>

<UL>
	<LI><I>Object</I> is the Name property of the ListBox or ComboBox.
	<P>
	<LI>Clear is the Visual Basic keyword for the method that removes all items from
	a list.
</UL>

<P>Thus, one line of code can be used to clear all the strings in the ListBox of
the program shown in Figure 11.11:</P>
<P>
<PRE>lstHero.Clear
</PRE>
<H2><A NAME="Heading12"></A>Understanding ComboBox Styles</H2>
<P>The ListBox and ComboBox controls have much in common, but each has a distinct
use. A ListBox takes up more room than a ComboBox, and when using a ListBox, you
can't select or input unlisted data. A ComboBox offers more flexibility and uses
a form's space more efficiently.</P>
<P>A ComboBox's Style property enables you to change the operational characteristics
and appearance of the control. Table 11.1 describes these styles, and Figure 11.12
shows the ComboBox styles applied to a form. You can also download this code from
<A target="_new" HREF="javascript:if(confirm('http://www.mcp.com/info  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mcp.com/info'" tppabs="http://www.mcp.com/info">http://www.mcp.com/info</A>. You will be asked
for an ISBN. Enter 078971633x and click the <B>Search</B> button to go to the <I>Using
Visual Basic 6</I> page.</P>


<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Using a simple combo ComboBox</STRONG></P>
	<P>When you first add a ComboBox with the 1 - Simple Combo style to a form, the ComboBox
	is sized so that none of the ListBox is displayed. Increase the Height property to
	display more of the ListBox. 
<HR>


</BLOCKQUOTE>

<H4>TABLE 11.1&nbsp;&nbsp;Values for the ComboBox Style Property</H4>
<P>
<TABLE BORDER="1">
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT"><B><I>Setting</I></B></TD>
		<TD ALIGN="LEFT"><B><I>Description</I></B></TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">0 - Drop-down Combo</TD>
		<TD ALIGN="LEFT">A drop-down list. However, users can also enter new data to the ComboBox by inputting
			text directly into the TextBox portion of the ComboBox.</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">1 - Simple Combo</TD>
		<TD ALIGN="LEFT">A combination of a TextBox and a ListBox that doesn't drop down. Users can select
			data from the ListBox or type new data into the TextBox. The size of a simple ComboBox
			includes both edit and list portions.</TD>
	</TR>
	<TR ALIGN="LEFT" VALIGN="TOP">
		<TD ALIGN="LEFT">2 - Drop-down List</TD>
		<TD ALIGN="LEFT">A read-only drop-down list from which users can only select data. Users can't enter
			data into the control.</TD>
	</TR>
</TABLE>
</P>
<P><A HREF="javascript:popUp('11fig12.gif')"><B>FIGURE 11.12</B></A> <I>Notice that
with a drop-down ComboBox style, you can add new data to the control at runtime.</I></P>
<P>The most common ComboBox styles are 0 - Drop-down Combo and 2 - Drop-down List.
As mentioned earlier, you use a drop-down ComboBox style when you want to let users
add new data that's not in the ComboBox's list. You use the drop-down list style
when you want users to choose from data that's only in the drop-down list of the
ComboBox.</P>
<P>
<H2><A NAME="Heading13"></A>Using Arrays, ComboBoxes, and ListBoxes in a Sample Program</H2>
<P>The Baseball ScoreKeeper program uses many things you've just learned. It uses
arrays to keep track of each inning's score throughout the game and uses For...Next
loops to traverse arrays to set and get particular values of an array's elements.
It also uses arrays with a ListBox to present a team's roster and to display which
player is now at bat.</P>
<P>To use the program, users pick the team now at bat by clicking the appropriate
OptionButton at the left of the form. Then users can select the current player from
a ListBox that lists the players on the team. At the end of an inning, users enter
the inning number and the number of runs scored into two TextBoxes at the bottom
of the form. Then users click the Add Runs button to display the runs scored during
the inning and the total score in the appropriate scoreboard and total score Label
controls (see Figure 11.13).</P>
<P><A HREF="javascript:popUp('11fig13.gif')"><B>FIGURE 11.13</B></A> <I>The Baseball
ScoreKeeper program can be found at </I><A target="_new" HREF="javascript:if(confirm('http://www.mcp.com/ info  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.mcp.com/%20info'" tppabs="http://www.mcp.com/%20info"><I>http://www.mcp.com/
info</I></A><I>.</I></P>
<P>
<H2><A NAME="Heading14"></A>Examining ScoreKeeper's Event Procedures</H2>
<P>The bulk of the work in the Baseball ScoreKeeper program takes place within the
code of two event procedures, Form_Load() and cmdAddRun_Click().</P>
<P><B>How the <I>Form_Load()</I> procedure initializes the program</B>

<DL>
	<DT></DT>
	<DD><B>1. </B>It declares local variables for scorekeeping and the scoreboard string
	and declares one array for each team's roster. Finally, it redimensions the two global
	scorekeeping arrays (these are declared in the module modBaseBall, one for each team)
	to nine elements. The elements of these arrays will hold the score for each inning.
	<P>
	<DT></DT>
	<DD><B>2. </B>It uses a For...Next loop to traverse each element in the Team One
	scorekeeping array, gTeamOneInnings(). Within each iteration of the loop, it takes
	the value in each element and adds it to the variable TotalScore%, which holds the
	total score for all the innings. Then Form_Load converts the value in each element
	to a character by using the CStr() function and combines this converted character
	with the | character to form a larger scorekeeping string variable, InningString$
	(you'll learn more about this in Chapter 12, &quot;Working with Strings and Typecasting&quot;).
	Next, the value of the InningString$ variable is assigned to the Caption property
	of the Scoreboard label, and the value of the TotalScore% variable is assigned to
	the Caption property of the total runs Label. Finally, the InningString$ variable
	is reset, and this step is repeated for Team Two.
	<P>
	<DT></DT>
	<DD><B>3. </B>It redimensions the team roster arrays for both teams to have nine
	elements. Then it adds the names and playing positions of each player to the element
	that corresponds to the player's position in the batting order.
	<P>
	<DT></DT>
	<DD><B>4. </B>It uses a For...Next loop with the AddItem method of each team's ListBox
	to traverse the roster arrays of each team and add the value of each element in the
	array (player name and playing position) to the respective ListBox.
	<P>
</DL>

<P>Listing 11.6 shows these steps within the code of the Form_Load() event procedure.</P>
<P>
<H4>LISTING 11.6&nbsp;&nbsp;11LIST.06.TXT--Initializing the Main Form of the Baseball
<BR>
Scorekeeper Application with the Form_Load() Event Procedure</H4>
<PRE>01 Private Sub Form_Load()</PRE>
<PRE>02 `=====================STEP ONE====================</PRE>
<PRE>03 Dim i% `Counter variable

04 Dim TotalScore%</PRE>
<PRE>05 Dim InningsString$ `String to display score for inning</PRE>
<PRE>06 Dim TeamOneRoster$() `Array to hold players' names</PRE>
<PRE>07 Dim TeamTwoRoster$() `Array to hold players' names</PRE>
<PRE>08 `Redimension the global score arrays</PRE>
<PRE>09 `DEFAULT_INNINGS is a constant declared in the module,</PRE>
<PRE>10 `modBaseBall</PRE>
<PRE>11 ReDim gTeamOneInnings(DEFAULT_INNINGS - 1)</PRE>
<PRE>12 ReDim gTeamTwoInnings(DEFAULT_INNINGS - 1)</PRE>
<PRE>13</PRE>
<PRE>14 `=====================STEP TWO====================</PRE>
<PRE>15 `Initialize the default score for Team One</PRE>
<PRE>16</PRE>
<PRE>17 TotalScore% = 0</PRE>
<PRE>18 For i% = 0 To DEFAULT_INNINGS - 1</PRE>
<PRE>19</PRE>
<PRE>20 InningsString$ = InningsString$ _</PRE>
<PRE>&amp; CStr(gTeamOneInnings(i%)) &amp; &quot; | &quot;</PRE>
<PRE>21 Next i%</PRE>
<PRE>22</PRE>
<PRE>23 `Display the concatenated string in the score label</PRE>
<PRE>24 lblTeamOne.Caption = InningsString$</PRE>
<PRE>25 `Display the total score for Team One</PRE>
<PRE>26 lblTeamOneScore.Caption = CStr(TotalScore%)</PRE>
<PRE>27</PRE>
<PRE>28 `Clean out score string for new trip through</PRE>
<PRE>29 `Team Two's score</PRE>
<PRE>30 InningsString$ = &quot;&quot;</PRE>
<PRE>31</PRE>
<PRE>32 `Initialize the default score for Team Two</PRE>
<PRE>33 For i% = 0 To DEFAULT_INNINGS - 1</PRE>
<PRE>34 InningsString$ = InningsString$ _</PRE>
<PRE>&amp; CStr(gTeamTwoInnings(i%)) &amp; &quot; | &quot;</PRE>
<PRE>35 Next i%</PRE>
<PRE>36 `Display the concatenated string in the score label</PRE>
<PRE>37 lblTeamTwo.Caption = InningsString$</PRE>
<PRE>38 `Display the total score for Team Two</PRE>
<PRE>39 lblTeamTwoScore.Caption = CStr(TotalScore%)</PRE>
<PRE>40 `=====================STEP THREE====================</PRE>
<PRE>41 `Make room in the roster arrays for 9 players</PRE>
<PRE>42 ReDim TeamOneRoster$(8) `Array elements begin at zero</PRE>
<PRE>43 ReDim TeamTwoRoster$(8)</PRE>
<PRE>44</PRE>
<PRE>45 `Add the players for Team One to the roster array</PRE>
<PRE>46 TeamOneRoster$(0) = &quot;Phillips, lf&quot;</PRE>
<PRE>47 TeamOneRoster$(1) = &quot;Palmero, cf&quot;</PRE>
<PRE>48 TeamOneRoster$(2) = &quot;Erstad, 1b&quot;</PRE>
<PRE>49 TeamOneRoster$(3) = &quot;Hollins, 3b&quot;</PRE>
<PRE>50 TeamOneRoster$(4) = &quot;Salmon, rf&quot;</PRE>
<PRE>51 TeamOneRoster$(5) = &quot;Leyritz, dh&quot;</PRE>
<PRE>52 TeamOneRoster$(6) = &quot;Garne, c&quot;</PRE>
<PRE>53 TeamOneRoster$(7) = &quot;Gerbeck, 2b&quot;</PRE>
<PRE>54 TeamOneRoster$(8) = &quot;DiScensa, ss&quot;</PRE>
<PRE>55</PRE>
<PRE>56 `Add the players for Team Two to the roster array</PRE>
<PRE>57 TeamTwoRoster$(0) = &quot;Garciaparra, ss&quot;</PRE>
<PRE>58 TeamTwoRoster$(1) = &quot;Valentibn, 3b&quot;</PRE>
<PRE>59 TeamTwoRoster$(2) = &quot;Vaughn, 1b&quot;</PRE>
<PRE>60 TeamTwoRoster$(3) = &quot;Jefferson, dh&quot;</PRE>
<PRE>61 TeamTwoRoster$(4) = &quot;Cordero, lf&quot;</PRE>
<PRE>62 TeamTwoRoster$(5) = &quot;O'Leary, rf&quot;</PRE>
<PRE>63 TeamTwoRoster$(6) = &quot;Mack, cf&quot;</PRE>
<PRE>64 TeamTwoRoster$(7) = &quot;Hittenberg, c&quot;</PRE>
<PRE>65 TeamTwoRoster$(8) = &quot;Frey, 2b&quot;</PRE>
<PRE>66</PRE>
<PRE>67 `=====================STEP FOUR====================</PRE>
<PRE>68 `Traverse the roster arrays and add the contents</PRE>
<PRE>69 `the the roster listboxes.</PRE>
<PRE>70 For i% = 0 To 8</PRE>
<PRE>71 lstTeamOne.AddItem (TeamOneRoster(i%))</PRE>
<PRE>72 lstTeamTwo.AddItem (TeamTwoRoster(i%))</PRE>
<PRE>73 Next i%</PRE>
<PRE>74</PRE>
<PRE>75 End Sub</PRE>
<P>The cmdAddRun_Click() event procedure is the code that adds the runs scored in
a given inning to the Scoreboard when the user clicks the Add Runs button.</P>


<BLOCKQUOTE>
	<P><B>How the <I>cmdAddRun_Click()</I> procedure works</B>

</BLOCKQUOTE>


<DL>
	<DT></DT>
	<DD><B>1. </B>It creates variables that reflect the current inning and current score.
	It also creates a counter variable and variables that hold the total score and the
	scoreboard string.
	<P>
</DL>



<BLOCKQUOTE>
	<P>
<HR>
<STRONG>Using <I>IsNumeric()</I></STRONG></P>
	<P>IsNumeric() is a Visual Basic function that checks a string number to see whether
	it looks like a number. If the string looks like a number, IsNumeric() returns True;
	otherwise, it returns False. IsNumeric() is often used to validate user input. 
<HR>


</BLOCKQUOTE>


<DL>
	<DT></DT>
	<DD><B>2. </B>It takes the text entered in the Inning TextBox, inspects it to make
	sure that it's a number by using the IsNumeric() function, and makes sure that the
	user didn't enter a number higher than the number of innings in the game so far.
	If this value is acceptable, the procedure assigns it to the current inning variable,
	CurrentInning%. cmdAddRun_Click() does the same sort of IsNumeric() check on the
	text in the Runs Scored TextBox, txtRuns. If this is acceptable, the procedure assigns
	it to the current score variable, CurrentScore%.
	<P>
	<DT></DT>
	<DD><B>3. </B>The procedure checks the value of the OptionButton for Team One. If
	the OptionButton is selected, its value will be True and the value in the current
	score variable, CurrentScore%, will be assigned to an element in gTeamOneInnings(),
	the global array that holds the values for Team One's per-inning score. The current
	score is assigned to the element position that's one less than the value of the current
	inning variable, CurrentInning%. This is because the first element in the gTeamOneInnings
	array is zero. If the value of the OptionButton for Team One is False, the OptionButton
	for Team Two must have been selected and this step should be done in terms of Team
	Two.
	<P>
	<DT></DT>
	<DD><B>4. </B>It traverses the global arrays that hold the value of every inning's
	score for each team to determine the total runs scored for each team. Then the procedure
	constructs the scoreboard string and assigns the results to the appropriate controls.
	(This is an exact repeat of the work done in the fourth step of the Form_Load() event
	procedure.)
	<P>
</DL>

<P>Listing 11.7 shows the event procedure for the cmdAddRuns_Click event.</P>
<P>
<H4>LISTING 11.7&nbsp;&nbsp;11LIST07.TXT--Determining the Team and Inning to Which
the<BR>
Scored Runs Apply</H4>
<PRE>01 Private Sub cmdAddRun_Click()</PRE>
<PRE>02 `=====================STEP One====================</PRE>
<PRE>03 Dim CurrentInning%</PRE>
<PRE>04 Dim CurrentScore%</PRE>
<PRE>05 Dim i%</PRE>
<PRE>06 Dim TotalScore%</PRE>
<PRE>07 Dim InningsString$</PRE>
<PRE>08</PRE>
<PRE>09 `=====================STEP TWO====================</PRE>
<PRE>10 `Convert the text in the txtInning to an Integer if</PRE>
<PRE>11 `indeed the text looks like a number</PRE>
<PRE>12 If IsNumeric(txtInning.Text) Then</PRE>
<PRE>13 CurrentInning% = CInt(txtInning.Text)</PRE>
<PRE>14 Else</PRE>
<PRE>15 CurrentInning% = 1</PRE>
<PRE>16 End If</PRE>
<PRE>17</PRE>
<PRE>18 `Make sure the inning number is not more than 9</PRE>
<PRE>19 If CurrentInning% &gt; DEFAULT_INNINGS Then</PRE>
<PRE>20 CurrentInning% = DEFAULT_INNINGS</PRE>
<PRE>21 End If</PRE>
<PRE>22</PRE>
<PRE>23 `Convert the text in the txtRuns to an Integer if</PRE>
<PRE>24 `indeed the text looks like a number</PRE>
<PRE>25 If IsNumeric(txtRuns.Text) Then</PRE>
<PRE>26 CurrentScore% = CInt(txtRuns.Text)</PRE>
<PRE>27 Else</PRE>
<PRE>28 CurrentScore% = 0</PRE>
<PRE>29 End If</PRE>
<PRE>30 `=====================STEP THREE===================</PRE>
<PRE>31 `Set the score to the designated inning for the team</PRE>
<PRE>32 `identified by the check option box.</PRE>
<PRE>33 If opTeamOne.Value = True Then</PRE>
<PRE>34 gTeamOneInnings(CurrentInning% - 1) = CurrentScore%</PRE>
<PRE>35 Else</PRE>
<PRE>36 `If TeamOne.Value is not true, then TeamTwo.Value must</PRE>
<PRE>37 `be True. It's a logic thing!</PRE>
<PRE>38 gTeamTwoInnings(CurrentInning% - 1) = CurrentScore%</PRE>
<PRE>39 End If</PRE>
<PRE>40</PRE>
<PRE>41 `Set the new score for Team One</PRE>
<PRE>42 For i% = 0 To DEFAULT_INNINGS - 1</PRE>
<PRE>43 TotalScore% = TotalScore% + gTeamOneInnings(i%)</PRE>
<PRE>44 InningsString$ = InningsString$ _</PRE>
<PRE>&amp; CStr(gTeamOneInnings(i%)) &amp; &quot; | &quot;</PRE>
<PRE>45 Next i%</PRE>
<PRE>46 `=====================STEP FOUR===================</PRE>
<PRE>47 `Display the concatenated string in the score label</PRE>
<PRE>48 lblTeamOne.Caption = InningsString$</PRE>
<PRE>49 `Display the total score for Team One</PRE>
<PRE>50 lblTeamOneScore.Caption = CStr(TotalScore%)</PRE>
<PRE>51</PRE>
<PRE>52 `Clean out score string for new trip through</PRE>
<PRE>53 `Team Two's score</PRE>
<PRE>54 InningsString$ = &quot;&quot;</PRE>
<PRE>55 `Clean out the total score integer variable</PRE>
<PRE>56 TotalScore% = 0</PRE>
<PRE>57</PRE>
<PRE>58 `Set the new score for Team Two</PRE>
<PRE>59 For i% = 0 To DEFAULT_INNINGS - 1</PRE>
<PRE>60 TotalScore% = TotalScore% + gTeamTwoInnings(i%)</PRE>
<PRE>61 InningsString$ = InningsString$ _</PRE>
<PRE>&amp; CStr(gTeamTwoInnings(i%)) &amp; &quot; | &quot;</PRE>
<PRE>62 Next i%</PRE>
<PRE>63</PRE>
<PRE>64 `Display the concatenated string in the score label</PRE>
<PRE>65 lblTeamTwo.Caption = InningsString$</PRE>
<PRE>66 `Display the total score for Team One</PRE>
<PRE>67 lblTeamTwoScore.Caption = CStr(TotalScore%)</PRE>
<PRE>68</PRE>
<PRE>69 End Sub</PRE>
<P>The last thing that the program does is report who is at bat. This occurs in the
Click event of the ListBox for each team's roster whenever the user selects a player.
Listing 11.8 shows the code for Team One's ListBox Click event procedure. This code
uses the List and ListIndex properties that you learned about in the section &quot;Selecting
Items from a List.&quot;</P>
<P>
<H4>LISTING 11.8&nbsp;&nbsp;11LIST08.TXT--Code for the lstTeamOne_Click Procedure</H4>
<PRE>01 Private Sub lstTeamOne_Click()</PRE>
<PRE>02 `Have the name that the user clicks appear in the</PRE>
<PRE>03 `at bat label</PRE>
<PRE>04 lblTeamOneAtBat.Caption = lstTeamOne.List(lstTeamOne.ListIndex)</PRE>
<PRE>05 End Sub</PRE>
<P>The only difference between the lstTeamOne_Click and lstTeamTwo_Click event procedures
is that the first references the Team One at bat Label and ListBox, and the other
references the Team Two at bat Label and ListBox.</P>
<P>Some potential problems still exist:</P>

<UL>
	<LI>What happens if the user enters a letter character such as &quot;a&quot; in the
	Runs Scored or Inning text box? You need to provide an error check on these text
	boxes, possibly using the IsNumeric() function.
	<P>
	<LI>What if a game goes into extra innings? You need to Redim the scorekeeping arrays.
	<P>
	<LI>How do you remind users to change the player at bat if they forget, and what
	happens if users forget to change the team at bat? You might set a variable that
	tracks the most recently accessed player or team and provide a message box if this
	variable matches the new player or team when the Add Runs button is clicked.
</UL>

<P>You can easily solve these and other problems; for the most part, you possess
the tools you need to address them. All that's required is a little thought and some
experimentation.</P>
<H1></H1>
<CENTER>
<P>
<HR>
<A HREF="ch10.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch10/ch10.htm"><IMG SRC="previous.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/previous.gif" WIDTH="128" HEIGHT="28"
ALIGN="BOTTOM" ALT="Previous chapter" BORDER="0"></A><A HREF="ch12.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/ch12/ch12.htm"><IMG
SRC="next.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/next.gif" WIDTH="128" HEIGHT="28" ALIGN="BOTTOM" ALT="Next chapter"
BORDER="0"></A><A HREF="index-38.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/index.htm"><IMG SRC="contents.gif" tppabs="http://pbs.mcp.com/ebooks/078971633X/button/contents.gif" WIDTH="128"
HEIGHT="28" ALIGN="BOTTOM" ALT="Contents" BORDER="0"></A> <BR>
</P>

<P>&copy; <A HREF="copy.htm" tppabs="http://pbs.mcp.com/ebooks/078971633X/copy.htm">Copyright</A>, Macmillan Computer Publishing. All
rights reserved.
</CENTER>

</BODY>

</HTML>
