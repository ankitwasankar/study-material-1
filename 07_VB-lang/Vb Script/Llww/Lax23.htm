<HTML>
<HEAD>
<TITLE>lax23.htm </TITLE>
<LINK REL="ToC" HREF="httoc.htm">
<LINK REL="Index" HREF="htindex.htm">
<LINK REL="Next" HREF="laxxa.htm">
<LINK REL="Previous" HREF="lax22.htm"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080">
<A NAME="I0"></A><P ALIGN=CENTER>
<A HREF="lax22.htm" TARGET="_self"><IMG SRC="blanprev.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Previous Page"></A>
<A HREF="httoc.htm" TARGET="_self"><IMG SRC="blantoc.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="TOC"></A>
<A HREF="laxxa.htm" TARGET="_self"><IMG SRC="blannext.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Next Page"></A>
<A HREF="http://www.mcp.com/sams/" TARGET="_self"><IMG SRC="blanhome.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="See Page"></A>
<HR ALIGN=CENTER>
<P>
<UL>
<UL>
<UL>
<LI>
<A HREF="#E68E109" >Example 1: XYZ Inc. Corporate Intranet</A>
<UL>
<LI>
<A HREF="#E69E153" >Techniques Applied</A></UL></UL></UL></UL>
<HR ALIGN=CENTER>
<A NAME="E66E46"></A>
<H1 ALIGN=CENTER>
<CENTER>
<FONT SIZE=6 COLOR="#FF0000"><B>- 23 -</B>
<BR><B>Real-Life Examples IV</B></FONT></CENTER></H1>
<BR>
<UL>
<LI>Example 1: XYZ Inc. Corporate Intranet
<BR>
<BR>
</UL>
<P>This chapter describes a sample Web application created using VBScript. The example is
<BR>
<UL>
<UL>
<P><B>Example 1.</B> XYZ Inc. Corporate Intranet
<BR>
</UL></UL>
<BR>
<A NAME="E68E109"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B>Example 1: XYZ Inc. Corporate Intranet</B></FONT></CENTER></H3>
<BR>
<P><B>Document title:</B> XYZ Corporate Intranet
<BR>
<P><B>Files:</B>
<BR>
<P>Page files:
<BR>
<UL>
<LI>menudemo.htm
<BR>
<BR>
<LI>menu.htm
<BR>
<BR>
<LI>welcome.htm
<BR>
<BR>
<LI>b.htm
<BR>
<BR>
</UL>
<P>Images: 
<BR>
<UL>
<LI>file.gif
<BR>
<BR>
<LI>cust.gif
<BR>
<BR>
<LI>prod.gif
<BR>
<BR>
<LI>users.gif
<BR>
<BR>
<LI>external.gif
<BR>
<BR>
<LI>help.gif
<BR>
<BR>
<LI>leftend.gif
<BR>
<BR>
<LI>rightend.gif
<BR>
<BR>
</UL>
<P>ActiveX controls used: 
<BR>
<UL>
<LI>IeMenu
<BR>
<BR>
<LI>Label
<BR>
<BR>
<LI>IeTimer
<BR>
<BR>
</UL>
<P><B>Description</B>: This example shows how to implement an ActiveX menu control.  To aid maintenance and to speed the addition of further menu items, the text for each menu item and the associated location for each menu item are held within arrays, which are transferred to the menu at runtime. The other method of populating a menu is to specify a menu item as a parameter, &lt;PARAM MenuItem[1]... &gt;, within the &lt;OBJECT&gt; tag. However, the maintenance of these menus can become somewhat confusing when there are a large number of menus and menu items.
<BR>
<P>The maintenance of the locations that are loaded when a menu item is clicked is also enhanced because the locations are held within arrays, which are specified at the beginning of the script. 
<BR>
<P>The example also demonstrates how to implement a continuous clock within the menu bar, using an ActiveX label and an ActiveX timer control.
<BR>
<P>The menu bar is displayed within the upper frame of a borderless frameset. The lower frame is used to display the content pages for the Web site.
<BR>
<BR>
<A NAME="E69E153"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>Techniques Applied</B></FONT></CENTER></H4>
<BR>
<P><B>ActiveX controls:</B> (See Chapters 1, 12, 13, and 14.) The example uses a range of ActiveX controls. The example also demonstrates changing properties at runtime&#151;in this case, to populate the menus.
<BR>
<P><B>Arrays:</B> (See Chapter 10, &quot;Using the Power of Arrays.&quot;) The menu items and the locations, which are loaded when you click a menu item, are held within multidimension static arrays.
<BR>
<P><B>Programming elements:</B> (See Chapter 9, &quot;Making Your Program Flow.&quot;) A range of VBScript language elements are used.
<BR>
<P>The example uses a frameset document (menudemo.htm), which creates an upper frame into which the menu document is loaded (menu.htm) and a lower frame that contains the main pages, as shown in Figure 23.1.
<BR>
<P><B><A HREF="23lax01.gif">Figure 23.1. The menu bar and opening page.</A></B>
<BR>
<P>When the user clicks on a menu item, the particular menu pops up, as shown in Figures 23.2 and 23.3. 
<BR>
<P><B><A HREF="23lax02.gif">Figure 23.2. The File menu.</A></B>
<BR>
<P><B><A HREF="23lax03.gif">Figure 23.3. The Customers menu.</A></B>
<BR>
<P>Clicking on a menu item causes the page associated with that menu item to be loaded in the lower frame, as shown in Figure 23.4.
<BR>
<P><B><A HREF="23lax04.gif">Figure 23.4. One of the Web pages loaded into the lower frame.</A></B>
<BR>
<P>A timer control is used to display a clock at the end of the menu bar. At predetermined intervals, the timer event (shown in Figure 23.5) is fired, causing the clock display to be updated. 
<BR>
<P><B><A HREF="23lax05.gif">Figure 23.5. The script to operate the clock.</A></B>
<BR>
<P>As the application is loading, the OnLoad event handler (shown in Figure 23.6) creates the menus from the data stored in the arrays.
<BR>
<P><B><A HREF="23lax06.gif">Figure 23.6. The onLoad event handler.</A></B>
<BR>
<P>The menu's Click event, shown in Figure 23.7, loads the required page into the lower frame. The value of the menu caption is passed to a form and is used in this example to display the correct caption on the page (b.htm) in the lower frame.
<BR>
<P><B><A HREF="23lax07.gif">Figure 23.7. The menu's Click event handler.</A></B>
<BR>
<P>The menu objects are defined within the HTML code. They are shown in the ActiveX Control Pad in Figure 23.8.
<BR>
<P><B><A HREF="23lax08.gif">Figure 23.8. The menu object definitions. </A></B>
<BR>
<P>Listing 23.1 shows the HTML code for the frameset document menudemo.htm. 
<BR>
<P>
<FONT COLOR="#000080"><B>Listing 23.1. The menudemo.htm code.</B></FONT>
<BR>
<PRE>
<FONT COLOR="#000080">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;XYZ Inc. Intranet&lt;/TITLE&gt;
&lt;/HEAD&gt;
 &lt;FRAMESET ROWS=8%,92% FRAMEBORDER=0 FRAMESPACING=0&gt;
  &lt;FRAME SRC=&quot;menu.htm&quot; NAME=&quot;menubar&quot; MARGINWIDTH=0 MARGINHEIGHT=0 SCROLLING=No NORESIZE&gt;
  &lt;FRAME SRC=&quot;welcome.htm&quot; NAME=&quot;mainbody&quot;&gt;
 &lt;/FRAMESET&gt;
&lt;/HTML&gt;</FONT></PRE>
<P>Listing 23.2 shows the complete source code for the menu document, menu.htm. 
<BR>
<P>
<FONT COLOR="#000080"><B>Listing 23.2. The menu.htm code.</B></FONT>
<BR>
<PRE>
<FONT COLOR="#000080">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;New Page&lt;/TITLE&gt;
    &lt;SCRIPT LANGUAGE=&quot;vbscript&quot;&gt;
&lt;!--
Dim NewPage
Dim MenuItems(6,10)
Dim MenuLocations(6,10)
Dim MaxItems(6)
Dim FILE_MENU, CUST_MENU, PROD_MENU, USERS_MENU, EXTERNAL_MENU, HELP_MENU
FILE_MENU = 0
CUST_MENU = 1
PROD_MENU = 2
USERS_MENU = 3
EXTERNAL_MENU = 4
HELP_MENU = 5
MenuItems(FILE_MENU,1) = &quot;Welcome Page&quot;
MenuItems(FILE_MENU,2) = &quot;Latest Company News&quot;
MenuItems(FILE_MENU,3) = &quot;New and Updated Areas&quot;
MenuLocations(FILE_MENU,1) = &quot;welcome.htm&quot;
MenuLocations(FILE_MENU,2) = &quot;b.htm&quot;
MenuLocations(FILE_MENU,3) = &quot;b.htm&quot;
MaxItems(FILE_MENU) = 3
MenuItems(CUST_MENU,1) = &quot;Search Customer Database&quot;
MenuItems(CUST_MENU ,2) = &quot;Browse Customer Database&quot;
MenuItems(CUST_MENU ,3) = &quot;Add New Customer Record&quot;
MenuItems(CUST_MENU ,4) = &quot;Edit Customer Record&quot;
MenuLocations(CUST_MENU ,1) = &quot;b.htm&quot;
MenuLocations(CUST_MENU ,2) = &quot;b.htm&quot;
MenuLocations(CUST_MENU ,3) = &quot;b.htm&quot;
MenuLocations(CUST_MENU ,4) = &quot;b.htm&quot;
MaxItems(CUST_MENU) = 4
MenuItems(PROD_MENU,1) = &quot;Search Product Database&quot;
MenuItems(PROD_MENU,2) = &quot;Browse Product Database&quot;
MenuItems(PROD_MENU,3) = &quot;Add New Product Record&quot;
MenuItems(PROD_MENU,4) = &quot;View Product Technical Reports&quot;
MenuItems(PROD_MENU,5) = &quot;Add Product Comment&quot;
MenuLocations(PROD_MENU,1) = &quot;b.htm&quot;
MenuLocations(PROD_MENU,2) = &quot;b.htm&quot;
MenuLocations(PROD_MENU,3) = &quot;b.htm&quot;
MenuLocations(PROD_MENU,4) = &quot;b.htm&quot;
MenuLocations(PROD_MENU,5) = &quot;b.htm&quot;
MaxItems(PROD_MENU) = 5
MenuItems(USERS_MENU,1) = &quot;Search User Database&quot;
MenuItems(USERS_MENU,2) = &quot;User EMail Addresses&quot;
MenuItems(USERS_MENU,3) = &quot;Change your password&quot;
MenuItems(USERS_MENU,4) = &quot;Employee Forum&quot;
MenuItems(USERS_MENU,5) = &quot;Technical Forum&quot;
MenuLocations(USERS_MENU,1) = &quot;b.htm&quot;
MenuLocations(USERS_MENU,2) = &quot;b.htm&quot;
MenuLocations(USERS_MENU,3) = &quot;b.htm&quot;
MenuLocations(USERS_MENU,4) = &quot;b.htm&quot;
MenuLocations(USERS_MENU,5) = &quot;b.htm&quot;
MaxItems(USERS_MENU) = 5
MenuItems(EXTERNAL_MENU,1) = &quot;Microsoft&quot;
MenuItems(EXTERNAL_MENU,2) = &quot;SAMS.Net&quot;
MenuItems(EXTERNAL_MENU,3) = &quot;vbscripts.com&quot;
MenuLocations(EXTERNAL_MENU,1) = &quot;http://www.microsoft.com/&quot;
MenuLocations(EXTERNAL_MENU,2) = &quot;http://www.mcp.com/sams/&quot;
MenuLocations(EXTERNAL_MENU,3) = &quot;http://www.vbscripts.com/&quot;
MaxItems(EXTERNAL_MENU) = 3
MenuItems(HELP_MENU,1) = &quot;Search Help Topics&quot;
MenuItems(HELP_MENU,2) = &quot;Contact Support Desk&quot;
MenuItems(HELP_MENU,3) = &quot;Contact Support Desk&quot;
MenuLocations(HELP_MENU,1) = &quot;b.htm&quot;
MenuLocations(HELP_MENU,2) = &quot;b.htm&quot;
MenuLocations(HELP_MENU,3) = &quot;b.htm&quot;
MaxItems(HELP_MENU) = 3
Sub window_onLoad()
For i = 1 to MaxItems(FILE_MENU)
 call FileMenu.AddItem(MenuItems(FILE_MENU,i), i)
Next
For i = 1 to MaxItems(CUST_MENU)
 call CustomerMenu.AddItem(MenuItems(CUST_MENU,i), i)
Next
For i = 1 to MaxItems(PROD_MENU)
 call ProductMenu.AddItem(MenuItems(PROD_MENU,i), i)
Next
For i = 1 to MaxItems(USERS_MENU)
 call UsersMenu.AddItem(MenuItems(USERS_MENU,i), i)
Next
For i = 1 to MaxItems(EXTERNAL_MENU)
 call ExternalMenu.AddItem(MenuItems(EXTERNAL_MENU,i), i)
Next
For i = 1 to MaxItems(HELP_MENU)
 call HelpMenu.AddItem(MenuItems(HELP_MENU,i), i)
Next
End sub
  Sub File_OnClick
    FileMenu.PopUp
  End Sub
  Sub Customers_OnClick
    CustomerMenu.PopUp
  End Sub
  Sub Products_OnClick
    ProductMenu.PopUp
  End Sub
  Sub Users_OnClick
    UsersMenu.PopUp
  End Sub
  Sub External_OnClick
    ExternalMenu.PopUp
  End Sub
  Sub Help_OnClick
    HelpMenu.PopUp
  End Sub
Sub FileMenu_Click(ByVal item)
 Parent.mainbody.Location.hRef = MenuLocations(FILE_MENU, item)
 Document.Form1.NewPage.Value = MenuItems(FILE_MENU, item)
end sub
Sub CustomerMenu_Click(item)
 Parent.mainbody.Location.hRef = MenuLocations(CUST_MENU, item)
 Document.Form1.NewPage.Value = MenuItems(CUST_MENU, item)
end sub
Sub ProductMenu_Click(item)
 Parent.mainbody.Location.hRef = MenuLocations(PROD_MENU, item)
 Document.Form1.NewPage.Value = MenuItems(PROD_MENU, item)
end sub
Sub UsersMenu_Click(item)
 Parent.mainbody.Location.hRef = MenuLocations(USERS_MENU, item)
 Document.Form1.NewPage.Value = MenuItems(USERS_MENU, item)
end sub
Sub ExternalMenu_Click(ByVal item)
 top.Location.hRef = MenuLocations(EXTERNAL_MENU, item)
end sub
Sub HelpMenu_Click(item)
 Parent.mainbody.Location.hRef = MenuLocations(HELP_MENU, item)
 Document.Form1.NewPage.Value = MenuItems(HELP_MENU, item)
end sub
--&gt;
    &lt;/SCRIPT&gt;
&lt;/HEAD&gt;
&lt;BODY BGCOLOR=&quot;white&quot;&gt;
&lt;CENTER&gt;
&lt;IMG SRC=&quot;leftend.gif&quot;&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;File&quot;&gt;&lt;IMG SRC=&quot;file.gif&quot; BORDER=0&gt;&lt;/A&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;Customers&quot;&gt;&lt;IMG SRC=&quot;cust.gif&quot; BORDER=0&gt;&lt;/A&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;Products&quot;&gt;&lt;IMG SRC=&quot;prod.gif&quot; BORDER=0&gt;&lt;/A&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;Users&quot;&gt;&lt;IMG SRC=&quot;users.gif&quot; BORDER=0&gt;&lt;/A&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;External&quot;&gt;&lt;IMG SRC=&quot;external.gif&quot; BORDER=0&gt;&lt;/A&gt;
&lt;A HREF=&quot;menu.htm&quot; ID=&quot;Help&quot;&gt;&lt;IMG SRC=&quot;help.gif&quot; BORDER=0&gt;&lt;/A&gt;
    &lt;OBJECT ID=&quot;TimeLabel&quot; WIDTH=95 HEIGHT=22
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;15066597&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;268435483&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Current Time:&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2505;529&quot;&gt;
        &lt;PARAM NAME=&quot;BorderColor&quot; VALUE=&quot;16711680&quot;&gt;
        &lt;PARAM NAME=&quot;BorderStyle&quot; VALUE=&quot;1&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
&lt;IMG SRC=&quot;rightend.gif&quot;&gt;&lt;BR&gt;
    &lt;FORM NAME=&quot;form1&quot;&gt;
        &lt;INPUT TYPE=hidden NAME=&quot;NewPage&quot;&gt;
    &lt;/FORM&gt;
    &lt;SCRIPT LANGUAGE=&quot;vbscript&quot;&gt;
&lt;!--
Sub IeTimer1_Timer()
 TimeLabel.Caption = &quot;Current Time: &quot; &amp; Time()
end sub
--&gt;
    &lt;/SCRIPT&gt;
    &lt;OBJECT ID=&quot;IeTimer1&quot; WIDTH=19 HEIGHT=19
     CLASSID=&quot;CLSID:59CCB4A0-727D-11CF-AC36-00AA00A47DD2&quot;&gt;
        &lt;PARAM NAME=&quot;_ExtentX&quot; VALUE=&quot;503&quot;&gt;
        &lt;PARAM NAME=&quot;_ExtentY&quot; VALUE=&quot;503&quot;&gt;
        &lt;PARAM NAME=&quot;Interval&quot; VALUE=&quot;100&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;FileMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;CustomerMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;ProductMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;UsersMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;ExternalMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;HelpMenu&quot; WIDTH=10 HEIGHT=10
     CLASSID=&quot;CLSID:7823A620-9DD9-11CF-A662-00AA00C066D2&quot;&gt;
    &lt;/OBJECT&gt;
&lt;/CENTER&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</FONT></PRE>
<BR><P ALIGN=CENTER>
<A HREF="lax22.htm" TARGET="_self"><IMG SRC="blanprev.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Previous Page"></A>
<A HREF="#I0" TARGET="_self"><IMG SRC="blantop.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Page Top"></A>
<A HREF="httoc.htm" TARGET="_self"><IMG SRC="blantoc.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="TOC"></A>
<A HREF="laxxa.htm" TARGET="_self"><IMG SRC="blannext.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Next Page"></A>
<A HREF="http://www.mcp.com/sams/" TARGET="_self"><IMG SRC="blanhome.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="See Page"></A>
</BODY></HTML>
