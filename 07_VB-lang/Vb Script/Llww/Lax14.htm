<HTML>
<HEAD>
<TITLE>lax14.htm </TITLE>
<LINK REL="ToC" HREF="httoc.htm">
<LINK REL="Index" HREF="htindex.htm">
<LINK REL="Next" HREF="lax15.htm">
<LINK REL="Previous" HREF="lax13.htm"></HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080">
<A NAME="I0"></A><P ALIGN=CENTER>
<A HREF="lax13.htm" TARGET="_self"><IMG SRC="blanprev.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Previous Page"></A>
<A HREF="httoc.htm" TARGET="_self"><IMG SRC="blantoc.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="TOC"></A>
<A HREF="lax15.htm" TARGET="_self"><IMG SRC="blannext.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Next Page"></A>
<A HREF="http://www.mcp.com/sams/" TARGET="_self"><IMG SRC="blanhome.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="See Page"></A>
<HR ALIGN=CENTER>
<P>
<UL>
<UL>
<UL>
<UL>
<LI>
<A HREF="#E69E100" >An Overview of the HTML Layout Control</A>
<LI>
<A HREF="#E69E101" >The HTML Layout Control Tool Box</A></UL>
<LI>
<A HREF="#E68E73" ><IMG SRC="task.gif">Adding New Controls to the HTML Layout Control Tool Box.</A>
<UL>
<LI>
<A HREF="#E69E102" >The HTML Layout Control Tool Bar</A></UL>
<LI>
<A HREF="#E68E74" ><IMG SRC="task.gif">Adding Controls to a Layout</A>
<LI>
<A HREF="#E68E75" ><IMG SRC="task.gif">Accessing a Control's Properties</A>
<LI>
<A HREF="#E68E76" ><IMG SRC="task.gif">Aligning Controls on a Layout</A>
<LI>
<A HREF="#E68E77" ><IMG SRC="task.gif">Managing Overlapping Controls</A>
<LI>
<A HREF="#E68E78" ><IMG SRC="task.gif">Creating a Form Using the HTML Layout Control</A>
<LI>
<A HREF="#E68E79" ><IMG SRC="task.gif">Adding the HTML Layout Form to a Web Page</A>
<LI>
<A HREF="#E68E80" ><IMG SRC="task.gif">Adding VBScript to an HTML Layout</A>
<UL>
<LI>
<A HREF="#E69E103" >Workshop Wrap-Up</A>
<LI>
<A HREF="#E69E104" >Next Steps</A></UL>
<LI>
<A HREF="#E68E81" >Q&amp;A</A></UL></UL></UL>
<HR ALIGN=CENTER>
<A NAME="E66E28"></A>
<H1 ALIGN=CENTER>
<CENTER>
<FONT SIZE=6 COLOR="#FF0000"><B>- 14 -</B>
<BR><B>Using the HTML Layout Control</B></FONT></CENTER></H1>
<BR>
<P>In this chapter, you
<BR>
<UL>
<LI>Learn how to use the HTML Layout Control
<BR>
<BR>
<LI>See how to add new and additional controls to the HTML Layout Control tool box
<BR>
<BR>
<LI>Learn how to manage overlapping controls
<BR>
<BR>
<LI>Learn how to quickly and easily align controls
<BR>
<BR>
<LI>Learn how to change the properties of many controls at once.
<BR>
<BR>
<LI>Create a Form using the HTML Layout Control
<BR>
<BR>
<LI>See how to add a layout to a Web page
<BR>
<BR>
<LI>See how to add VBScript to an HTML layout
<BR>
<BR>
</UL>
<P>Tasks in this chapter:
<BR>
<UL>
<LI>Adding additional controls to the HTML Layout Control
<BR>
<BR>
<LI>Adding controls to an HTML layout
<BR>
<BR>
<LI>Aligning controls on an HTML layout
<BR>
<BR>
<LI>Aligning controls on an HTML layout
<BR>
<BR>
<LI>Creating a form using the HTML Layout Control
<BR>
<BR>
<LI>Inserting an HTML layout form into a Web page
<BR>
<BR>
<LI>Adding VBScript to an HTML layout
<BR>
<BR>
</UL>
<P>As you have seen so far in this book, the combination of ActiveX Controls and VBScript enables you to build Web pages and Web applications that have the look, feel, and functionality of Windows applications. However, one final piece needs to be fitted into the puzzle to make this picture complete: on-screen positioning.
<BR>
<P>Using HTML, paragraphs, text, graphics, and controls are positioned on-screen basically in the order that the browser finds them within the HTML source code. Recent developments such as Tables have improved the situation somewhat, but it is still not possible within HTML to position a control at an exact location on the screen, nor is it possible to position controls independent of other controls.
<BR>
<P>The HTML Layout Control gives you the ability to position controls on-screen to the nearest pixel. The HTML Layout Control is a true Windows form that is included or embedded into your HTML document as a single ActiveX Control. The Layout Control handles all the individual controls you place within it, and using controls within a Layout affords a wider range of events, properties, and methods, enhancing the functionality of the ActiveX controls even further.
<BR>
<BR>
<A NAME="E69E100"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>An Overview of the HTML Layout Control</B></FONT></CENTER></H4>
<BR>
<P>The HTML Layout control is another ActiveX Control, with one difference: It contains and handles other ActiveX Controls. You can build a Layout quickly and easily using the drag and drop metaphor. It is a true visual development environment. If you have experience using other visual programming environments such as Visual Basic, Visual C++, or Delphi, you will almost instantly be familiar with the HTML Layout Control.
<BR>
<P>The definitions and declarations of the ActiveX controls contained within a particular HTML Layout control and the associated scripts are all held within one file, which is easily added to the HTML document. Another advantage of the Layout Control is that the object definition in the HTML document doesn't change. Therefore, you can make modifications to your Layout Control without changing the HTML document. Furthermore, the same Layout can be used in multiple documents&#151;for example, as a shared tool bar or menu.
<BR>
<P>To create a Layout, you use the HTML Layout Control development area, which is accessed via the ActiveX Control Pad. Open the ActiveX Control Pad and select New HTML Layout from the File menu.
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>From the user's perspective, the HTML Layout Control is very similar to other ActiveX Controls, and a runtime version is loaded with the full installation of MSIE3.0.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>A blank layout and the HTML Layout tool box are then displayed, as shown in Figure 14.1.
<BR>
<P><B><A HREF="14lax01.gif">Figure 14.1. A new Layout.</A></B>
<BR>
<P>Now let's have a look at the features of the Layout development environment and how they work together. 
<BR>
<BR>
<A NAME="E69E101"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>The HTML Layout Control Tool Box</B></FONT></CENTER></H4>
<BR>
<P>The HTML Layout Control tool box, shown in Figure 14.2, contains the ActiveX Controls that you have available to use in your new Layout.
<BR>
<P><B><A HREF="14lax02.gif">Figure 14.2. The HTML Layout Control tool box.</A></B>
<BR>
<P>When you first load the Layout Control, the tool box consists of two pages. However, you can add further pages to the tool box as required later.
<BR>
<P>The first page, named Standard, holds the controls that will always work with MSIE3.0. These are the Microsoft Forms 2.0 controls that you have used so far in the ActiveX Control Pad, plus a couple of MSIE specific controls&#151;the Image and the Hot Spot controls.
<BR>
<P>The standard ActiveX Controls are as follows: 
<BR>
<UL>
<LI>Label
<BR>
<BR>
<LI>Text Box
<BR>
<BR>
<LI>Drop Down List (Combo Box)
<BR>
<BR>
<LI>List
<BR>
<BR>
<LI>Check Box
<BR>
<BR>
<LI>Radio Button
<BR>
<BR>
<LI>Toggle Button
<BR>
<BR>
<LI>Command Button
<BR>
<BR>
<LI>Tab Strip
<BR>
<BR>
<LI>Scroll Bar
<BR>
<BR>
<LI>Spin Button
<BR>
<BR>
<LI>Image Control
<BR>
<BR>
<LI>Hot Spot
<BR>
<BR>
</UL>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>The item at the top left of the tool box showing the arrow icon is not a control. It denotes that you are in selection mode.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>The second page, and any subsequent pages, of the tool box that you create are for you to add further ActiveX Controls. Note that new controls that you download from the Web are not automatically available in the Tool Box. (See Chapter 13, &quot;Implementing an ActiveX Menu Control.&quot;) Let's look at how you add further controls to the tool box. 
<BR>
<BR>
<A NAME="E68E73"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Adding New Controls to the HTML Layout Control Tool Box.</B></FONT></CENTER></H3>
<BR>
<P>To add a new control that you have downloaded from the Web, follow these steps: 
<BR>
<OL>
<LI>Select the New Page tab on the tool box.
<BR>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>It's best not to add new controls to the standard page of the tool box, because these are controls that will always work with MSIE3.0.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<LI>Right-click anywhere on the page, and a pop-up menu is displayed, as shown in Figure 14.3.
<BR>
<BR><B><A HREF="14lax03.gif">Figure 14.3. The HTML Layout Control tool box menu.</A></B>
<BR>
<BR>
<LI>Select Additional Controls from the pop-up menu. A list of all available ActiveX controls is then displayed in the Additional Controls dialog box, as shown in Figure 14.4.
<BR>
<BR><B><A HREF="14lax04.gif">Figure 14.4. The Additional Control</B><A NAME="I2"></A><B>s dialog box.</A></B>
<BR>
<BR>
<LI>To add the BtnMenu Control that you downloaded from the Microsoft Site Builder Web Site in the last chapter, simply check the box to the left of the control's name.
<BR>
<BR>
<LI>Click OK. The control's icon is added to the tool box (as shown in Figure 14.5), and the control is now ready for you to use in a new layout.
<BR>
<BR>
</OL>
<P><B><A HREF="14lax05.gif">Figure 14.5. The new control added to the tool box.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>If you run out of room on a tool box page, you can either resize the tool box by dragging the sides and bottom, or you can add more pages. Simply right-click the tab at the top of a page to display the page management pop-up menu. Development teams can also share complete pages of controls using the import and export page facility. </NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<BR>
<A NAME="E69E102"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>The HTML Layout Control Tool Bar</B></FONT></CENTER></H4>
<BR>
<P>The HTML Layout control tool bar is the same tool bar you have used in the Control Pad (refer to Figure 14.1). However, when you have more than one control on the layout, the four <I>layering</I> buttons are enabled (see Figure 14.6).
<BR>
<P><B><A HREF="14lax06.gif">Figure 14.6. The HTML Layout Control tool bar.</A></B>
<BR>
<P>The layer buttons enable you to position overlapping controls in a second dimension&#151;depth. The four buttons allow you to move a control forward, backward, to the front, and to the back. Later in the chapter, you'll see how this works in practice.
<BR>
<P>The tool bar itself is dockable,  which means that it can be dragged from its usual place under the menu and can be free-floating or docked to the left, the right, or even the bottom of the screen.
<BR>
<P>Before you begin to create a real example, you need to know the following main functions of the HTML Layout Control:
<BR>
<UL>
<LI>Adding controls to a Layout
<BR>
<BR>
<LI>Accessing a control's properties
<BR>
<BR>
<LI>Aligning controls on a Layout
<BR>
<BR>
<LI>Managing overlapping controls
<BR>
<BR>
</UL>
<BR>
<A NAME="E68E74"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Adding Controls to a Layout</B></FONT></CENTER></H3>
<BR>
<P>As you pass your mouse pointer over the tool box, the control icons become clickable buttons. Adding a control to the Layout is as simple as clicking the control's icon in the tool box and then clicking on the layout in the approximate position where you need the control. Follow these steps to add a Command Button to your new Layout:
<BR>
<OL>
<LI>Pass your mouse over the Command Button icon in the tool box, and click the icon.
<BR>
<BR>
<LI>Now move your mouse onto the Layout background and click. A new Command Button will be placed in the approximate area where you clicked, as shown in Figure 14.7.
<BR>
<BR>
</OL>
<P><B><A HREF="14lax07.gif">Figure 14.7. A Command Button added to the Layout.</A></B>
<BR>
<P>You can move and resize the button by dragging it using the mouse. 
<BR>
<BR>
<A NAME="E68E75"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Accessing a Control's Properties</B></FONT></CENTER></H3>
<BR>
<P>The majority of a control's properties are available and can be amended at design time. To launch the Properties window, either right-click the control and select Properties from the pop-up menu, or select Properties from the View menu.
<BR>
<P>The Properties window for the Command Button that you just added to the Layout is shown in Figure 14.8.
<BR>
<P><B><A HREF="14lax08.gif">Figure 14.8. The Properties window for the Command Button.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>To access the properties for the Layout itself, right-click the Layout background, not a control.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<BR>
<A NAME="E68E76"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Aligning Controls on a Layout</B></FONT></CENTER></H3>
<BR>
<P>Let's look at how you can very quickly size and align multiple controls on a Layout. For this demonstration, you need to add two more Command Buttons to the Layout.
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>Unlike adding ActiveX controls to an HTML file in the ActiveX Control Pad, when you add new controls of the same type to a layout, the IDs are automatically numbered sequentially. For example, if you add a series of command buttons, their IDs are numbered CommandButton1, CommandButton2, and so on.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>The Layout control has a wide variety of menu options for sizing, spacing, and aligning controls, making the job of form building very quick and easy. To align the three buttons, follow these steps:
<BR>
<OL>
<LI>Select the first button. Then hold down the Shift key and select the other two buttons in turn.
<BR>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>A quick method of selecting more than one control is to drag the mouse around the outside of the controls that you want to select so that the marquee encloses the controls.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<LI>From the Layout menu, select Align, as shown in Figure 14.9.
<BR>
<BR>
<P><B><A HREF="14lax09.gif">Figure 14.9. The Layout and Align menus.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>The Layout control uses the alignment or size properties of one of the controls to align or size the others. This control is called the <I>dominant control</I>, and it is differentiated from the other controls by its white sizing handles.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<LI>Select Lefts from the Alignment menu. All the buttons now align to the same left position on the Layout.
<BR>
<BR>
<LI>With all three Command Buttons still selected, choose Vertical Spacing from the Format menu.
<BR>
<BR>
<LI>Select Make Equal from the <B>V</B>ertical Spacing menu. The buttons should now be perfectly aligned and positioned on the Layout, as shown in Figure 14.10. 
<BR>
<BR>
</OL>
<P><B><A HREF="14lax10.gif">Figure 14.10. The buttons aligned and spaced.</A></B>
<BR>
<BR>
<A NAME="E68E77"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Managing Overlapping Controls</B></FONT></CENTER></H3>
<BR>
<P>One of the unique benefits of the Layout Control is its capability to layer controls (place one control on top of another), which is impossible in standard HTML.
<BR>
<P>To see how this works, drag the buttons so that CommandButton2 sits on top of CommandButton1 and CommandButton3 sits on top of CommandButton2. Then select CommandButton2, as shown in Figure 14.11.
<BR>
<P><B><A HREF="14lax11.gif">Figure 14.11. The buttons placed on top of each other.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>Note that the layering buttons on the tool bar are enabled when more than one control is present on the Layout.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>To change the layer in which CommandButton2 resides, use one of the following methods:
<BR>
<UL>
<LI>Use the Layering buttons on the tool bar.
<BR>
<BR>
<LI>Use one of the layer options from the Format menu.
<BR>
<BR>
<LI>Right-click the control and select one of the layer options from the Controls pop-up menu.
<BR>
<BR>
</UL>
<P>Using any of the preceding methods, you can move the button in these directions: To The Front, Forward One Layer, Back One Layer, To The Back.
<BR>
<P>Take a moment to play around with the different commands. The button is shown moved to the front layer in Figure 14.12.
<BR>
<P><B><A HREF="14lax12.gif">Figure 14.12. CommandButton2 brought to the front.</A></B>
<BR>
<P>Layering buttons in this way doesn't have many practical uses&#151;at least none that I can think of. But how often would you have liked to overlay one .gif or .jpg image on top of another? Combine this with the fact that you can change a control's position at runtime, and you're into the realms of very easy animation with relatively small graphics files. For an example of this, see Chapter 16, &quot;Real Life Examples II.&quot; 
<BR>
<BR>
<A NAME="E68E78"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Creating a Form Using the HTML Layout Control</B></FONT></CENTER></H3>
<BR>
<P>Now that you've experienced the main functionality of the Layout Control, it's time to create a real layout. You will create a form, which you will then add to an HTML Page. Then you add some scripting to the form to do some rudimentary validation.
<BR>
<OL>
<LI>To begin, open a new HTML Layout and resize the layout to approximately 300 pixels wide and 200 pixels high.  Note that the size of the layout when you save it is the size that will be included in the HTML page.
<BR>
<BR>
<LI>Now change the BackColor property of the layout to white by right-clicking on the layout and selecting the Properties option from the control pop-up menu. Select BackColor and click the ellipsis button at the top of the Properties box to launch the color palette. Then simply click the white color box and click OK.
<BR>
<BR>
<LI>Add a label control to the layout and drag it so that it is at the top of the layout and about three quarters of the width across the layout.
<BR>
<BR>
<LI>Change the Caption property of the Label to A HTML Layout Control Form.
<BR>
<BR>
<LI>Change the ForeColor property of the Label to a gray color. (Which one you choose is not important.)
<BR>
<BR>
<LI>Change the Font property to 14 point MS Sans Serif Bold. The Layout should now resemble the one shown in Figure 14.13.
<BR>
<BR><B><A HREF="14lax13.gif">Figure 14.13. The example form with the first label in place.</A></B>
<BR>
<BR>
<LI>Change the BackStyle property of the label to Transparent.
<BR>
<BR>You will have a label with a shadow on this form. The label that you just created is actually the shadow.
<BR>
<BR>
<LI>Select the label and copy it to the clipboard by pressing Ctrl+C, clicking the copy tool bar button, or selecting Copy from the Edit menu. You could even use the edit options on the control's own pop-up menu by right-clicking the control. 
<BR>
<BR>
<LI>Now click anywhere on the Layout and paste the copied label onto the layout. Again you can use the hot key (Ctrl+V), the Edit menu, or the paste tool bar button.
<BR>
<BR>
<LI>You now have two identical labels. Change the ForeColor property of the second label to a shade of blue. (Again, it's not important which blue for this exercise.) 
<BR>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>Note that the Layout Control has automatically incremented the ID of the copied label to Label2.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<LI>To give the appearance of a drop shadow, drag the blue label over the gray label so that they are slightly offset to each other, as shown in Figure 14.14. Because the BackStyle of the labels has been set to transparent, the Gray label shows through.
<BR>
<BR>
<P><B><A HREF="14lax14.gif">Figure 14.14. The &quot;zero bandwidth&quot; drop shadow.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>To find out how you can create similar effects in a normal HTML page, see &quot;Cascading Style Sheets&quot; on the Microsoft Site Builder Workshop site.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<LI>Now add three text boxes.  Follow the earlier instructions to align them, space them vertically, and size them equally. See Figure 14.15.
<BR>
<BR><B><A HREF="14lax15.gif">Figure 14.15. Three equally sized, spaced, and aligned text boxes.</A></B>
<BR>
<BR>
<LI>You now need to add three labels&#151; one to the left of each text box. As you can probably guess, these labels will denote what data is to be entered in the text box. Apart from their positions within the form and the caption properties, all the other properties of these labels will be the same (font face, color, and so on). Therefore, you can set these properties for all three labels at the same time. 
<BR>
<BR>
<LI>Select all three labels and, on any one of the three, right-click and select Properties from the pop-up menu. Notice that in the Properties window, some properties&#151;those that are the same for all the selected controls&#151;are shown as their actual values. Other properties&#151;those that are different for each selected control&#151;say mixed, as shown in Figure 14.16. 
<BR>
<BR><B><A HREF="14lax16.gif">Figure 14.16. Labels with shared properties.</A></B>
<BR>
<BR>Using this single property window, you can amend the properties for all three labels at the same time.
<BR>
<BR>
<LI>Change the Font property to 10pt MS Sans Serif.
<BR>
<BR>
<LI>Change the ForeColor property to the same shade of blue used for the main label.
<BR>
<BR>
<LI>Change the BackStyle property to Transparent.
<BR>
<BR>
<LI>You can also give each control the same Left property (10 pixels), which aligns all of them to the left.
<BR>
<BR>Your form should now resemble the one shown in Figure 14.17.
<BR>
<BR><B><A HREF="14lax17.gif">Figure 14.17. The properties for all three labels are changed at the same time.</A></B>
<BR>
<BR>
<LI>Change the Caption properties for each label individually: Name, Email, and URL.
<BR>
<BR>
<LI>Add a Command Button toward the bottom of the form, and change its Caption property to Submit. Your completed form should now look like the one in Figure 14.18.
<BR>
<BR><B><A HREF="14lax18.gif">Figure 14.18. The completed layout.</A></B>
<BR>
<BR>
<LI>Save the layout as myform.alx by selecting Save from the File menu. Note that all layouts have the extension .alx. You are now ready to use the layout in an HTML page. 
<BR>
<BR>
</OL>
<BR>
<A NAME="E68E79"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Adding the HTML Layout Form to a Web Page</B></FONT></CENTER></H3>
<BR>
<P>Adding a prebuilt layout control to an HTML page is as easy, if not easier, than adding an ActiveX control.
<BR>
<OL>
<LI>Move to the HTML template, and change the background color to White.
<BR>
<BR>
<LI>Add a &lt;CENTER&gt; tag between the body tags.
<BR>
<BR>
<LI>Place the cursor between the center tags, and select Insert HTML Layout from the Edit menu. The file dialog for .alx files is then displayed, as shown in Figure 14.19.
<BR>
<BR><B><A HREF="14lax19.gif">Figure 14.19. Inserting a Layout into an HTML page.</A></B>
<BR>
<BR>
<LI>Select myform.alx, and click OK. The ActiveX Control Pad generates the required code to place the Layout on the HTML page, as shown in Figure 14.20.
<BR>
<BR><B><A HREF="14lax20.gif">Figure 14.20. The HTML code to call the layout control.</A></B>
<BR>
<BR>
<LI>Now simply save the HTML page as myform.htm, and load it into the browser. It should appear as shown in Figure 14.21. 
<BR>
<BR>
</OL>
<P><B><A HREF="14lax21.gif">Figure 14.21. The Web page, complete with Layout form.</A></B>
<BR>
<BR>
<A NAME="E68E80"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B><IMG SRC="task.gif">Adding VBScript to an HTML Layout</B></FONT></CENTER></H3>
<BR>
<P>Adding script to an HTML Layout using the Script Wizard is as easy as using the ActiveX Control Pad. In this part of the example, you add two further labels, which will act as a warning to the user that his input is invalid. The labels are only made visible if a conditional test on the input fails.
<BR>
<OL>
<LI>Open the layout created earlier: myform.alx.
<BR>
<BR>
<LI>Add two further labels. One label should be placed to the right of the Email text box, and the other should be placed to the left of the URL text box.
<BR>
<BR>
<LI>Change the ID property of the first label to InvalidEMail.
<BR>
<BR>
<LI>Change the ID property of the second label to InvalidURL.
<BR>
<BR>
<LI>Amend these properties for both labels to the following values:
<BR>
<BR>
</OL>
<UL>
<LI>ForeColor = Red
<BR>
<BR>
<LI>Caption = Invalid Input
<BR>
<BR>
<LI>Visible = False
<BR>
<BR>
<LI>Font = 10pt MS Sans Serif Bold
<BR>
<BR>
</UL>
<P>Your layout form should now look like the one in Figure 14.22.
<BR>
<P><B><A HREF="14lax22.gif">Figure 14.22. The form with the warning label added.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>Note that even if a control's Visible property is set to False, the control is still visible at design time.</NOTE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>With the layout control still open, start the Script Wizard.
<BR>
<P>Locate the TextBox2 Control in the left actions pane, and select the control's Change event. Enter the following code in the Change event handler.
<BR>
<PRE>
<FONT COLOR="#000080">If InStr(TextBox2.Text,&quot;@&quot;)=0 Then
 EMailInvalid.Visible = True
Else
 EMailInvalid.Visible = False
End If</FONT></PRE>
<P>The code searches for the @ symbol somewhere within the user's entry. If it is found, the entry is considered valid; if it is not found, Instr() returns 0, the entry is considered invalid, and the warning label is shown (visible=True). 
<BR>
<P>The code within the event handler is shown in Figure 14.23.
<BR>
<P><B><A HREF="14lax23.gif">Figure 14.23. The event handler for the TextBox2 Change event.</A></B>
<BR>
<P>Now select the Change event for TextBox3, and enter the following code:
<BR>
<PRE>
<FONT COLOR="#000080">If Left(TextBox3.Text,4) &lt;&gt; &quot;http&quot; Then
 URLInvalid.Visible = True
Else
 URLInvalid.Visible = False
End If</FONT></PRE>
<P>This code simply makes sure that the first four characters are http. The rest of the event handler is similar to the first one. The completed event handler is shown in Figure 14.24.
<BR>
<P><B><A HREF="14lax24.gif">Figure 14.24. The completed event handler for the TextBox3 Change event.</A></B>
<BR>
<P>Click OK and the Script Wizard adds the required code to the Layout Control's source. Save the layout.
<BR>
<P>There is no need to make any changes to the HTML page that uses the layout control. Run the page though the browser. If you still have the browser open, you can simply click Refresh.
<BR>
<P>Figure 14.25 shows the page with the scripted Layout Control working.
<BR>
<P><B><A HREF="14lax25.gif">Figure 14.25. The Web page, complete with scripted layout form.</A></B>
<BR>
<BLOCKQUOTE>
<BLOCKQUOTE>
<HR ALIGN=CENTER>
<BR>
<NOTE>To run this control and Web page from a Web server, simply change the ALXPATH parameter in the HTML Object definition, like this: </NOTE>
<BR>
<BR>
<PRE>
<FONT COLOR="#000080">&lt;PARAM NAME=&quot;ALXPATH&quot; REF VALUE=&quot;http://www.mydomain.com/subdir/myform.alx&quot;&gt;</FONT></PRE>
<BR>
<HR ALIGN=CENTER>
</BLOCKQUOTE></BLOCKQUOTE>
<P>You might wonder where the VBScript code and all the definitions for the Layout Control you just created went. You can open myform.alx in Notepad or a similar text editor; or within the Layout Control, right-click any of the controls on the Layout (or click the Layout itself), and select View Source Code from the pop-up menu. The full source code held within myform.alx looks like this: 
<BR>
<PRE>
<FONT COLOR="#000080">&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
Sub TextBox3_Change()
 If Left(TextBox3.Text,4) &lt;&gt; &quot;http&quot; Then
  URLInvalid.Visible = True
 Else
  URLInvalid.Visible = False
 End If
end sub
--&gt;
&lt;/SCRIPT&gt;
&lt;SCRIPT LANGUAGE=&quot;VBScript&quot;&gt;
&lt;!--
Sub TextBox2_Change()
 If InStr(TextBox2.Text,&quot;@&quot;)=0 Then
  EMailInvalid.Visible = True
 Else
  EMailInvalid.Visible = False
 End If
end sub
--&gt;
&lt;/SCRIPT&gt;
&lt;DIV BACKGROUND=&quot;#ffffff&quot; ID=&quot;Layout1&quot; STYLE=&quot;LAYOUT:FIXED;WIDTH:320pt;HEIGHT:178pt;&quot;&gt;
    &lt;OBJECT ID=&quot;Label1&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:11pt;LEFT:26pt;WIDTH:218pt;HEIGHT:19pt;ZINDEX:0;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;12632256&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;8388627&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;A HTML Layout Control Form&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;7673;661&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;280&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label2&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:11pt;LEFT:23pt;WIDTH:218pt;HEIGHT:19pt;ZINDEX:1;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;16711680&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;8388627&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;A HTML Layout Control Form&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;7673;661&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;280&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;TextBox1&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:41pt;LEFT:79pt;WIDTH:146pt;HEIGHT:18pt;TABINDEX:2;ZINDEX:2;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;5159;635&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;0&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;TextBox2&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:77pt;LEFT:79pt;WIDTH:146pt;HEIGHT:18pt;TABINDEX:3;ZINDEX:3;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;5159;635&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;0&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;TextBox3&quot;
     CLASSID=&quot;CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3&quot; STYLE=&quot;TOP:113pt;LEFT:79pt;WIDTH:146pt;HEIGHT:18pt;TABINDEX:4;ZINDEX:4;&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;746604571&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;5159;635&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;0&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label3&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:45pt;LEFT:10pt;WIDTH:49pt;HEIGHT:11pt;ZINDEX:5;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;16711680&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;8388627&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Name&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;1720;397&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label4&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot;STYLE=&quot;TOP:79pt;LEFT:10pt;WIDTH:53pt;HEIGHT:11pt;ZINDEX:6;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;16711680&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;8388627&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;EMail&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;1852;397&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;Label5&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:116pt;LEFT:10pt;WIDTH:60pt;HEIGHT:11pt;ZINDEX:7;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;16711680&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;VariousPropertyBits&quot; VALUE=&quot;8388627&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;URL&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2117;397&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;CommandButton1&quot;
     CLASSID=&quot;CLSID:D7053240-CE69-11CD-A777-00DD01143C57&quot; STYLE=&quot;TOP:143pt;LEFT:128pt;WIDTH:72pt;HEIGHT:24pt;TABINDEX:8;ZINDEX:8;&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Submit&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2540;846&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;ParagraphAlign&quot; VALUE=&quot;3&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;0&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;EMailInvalid&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:79pt;LEFT:233pt;WIDTH:83pt;HEIGHT:11pt;DISPLAY:NONE;ZINDEX:9;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;255&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Invalid Entry&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2911;397&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
    &lt;OBJECT ID=&quot;URLInvalid&quot;
     CLASSID=&quot;CLSID:978C9E23-D4B0-11CE-BF2D-00AA003F40D0&quot; STYLE=&quot;TOP:116pt;LEFT:233pt;WIDTH:83pt;HEIGHT:11pt;DISPLAY:NONE;ZINDEX:10;&quot;&gt;
        &lt;PARAM NAME=&quot;ForeColor&quot; VALUE=&quot;255&quot;&gt;
        &lt;PARAM NAME=&quot;BackColor&quot; VALUE=&quot;16777215&quot;&gt;
        &lt;PARAM NAME=&quot;Caption&quot; VALUE=&quot;Invalid Entry&quot;&gt;
        &lt;PARAM NAME=&quot;Size&quot; VALUE=&quot;2910;397&quot;&gt;
        &lt;PARAM NAME=&quot;FontEffects&quot; VALUE=&quot;1073741825&quot;&gt;
        &lt;PARAM NAME=&quot;FontHeight&quot; VALUE=&quot;200&quot;&gt;
        &lt;PARAM NAME=&quot;FontCharSet&quot; VALUE=&quot;0&quot;&gt;
        &lt;PARAM NAME=&quot;FontPitchAndFamily&quot; VALUE=&quot;2&quot;&gt;
        &lt;PARAM NAME=&quot;FontWeight&quot; VALUE=&quot;700&quot;&gt;
    &lt;/OBJECT&gt;
&lt;/DIV&gt;</FONT></PRE>
<BR>
<A NAME="E69E103"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>Workshop Wrap-Up</B></FONT></CENTER></H4>
<BR>
<P>In this chapter, you've seen the HTML Layout Control, an excellent way to create reusable forms, menus, and in fact, any sort of ActiveX Web page. It's quick and easy, and above all, it can reduce the maintenance time on the overall Web site. The HTML Layout Control is a truly visual development environment for your Web pages, giving results that rival or exceed those produced using professional Windows development tools.
<BR>
<BR>
<A NAME="E69E104"></A>
<H4 ALIGN=CENTER>
<CENTER>
<FONT SIZE=4 COLOR="#FF0000"><B>Next Steps</B></FONT></CENTER></H4>
<BR>
<P>See the following chapters for more information and examples of using the HTML Layout Control:
<BR>
<UL>
<LI>To see the HTML Layout Control in action again, this time using graphic animation in a young children's learning game, see Chapter 16, &quot;Real Life Examples II.&quot;
<BR>
<BR>
<LI>A good example of a commercial application produced using the Layout Control is shown in Chapter 23, &quot;Real Life Examples IV.&quot;
<BR>
<BR>
</UL>
<BR>
<A NAME="E68E81"></A>
<H3 ALIGN=CENTER>
<CENTER>
<FONT SIZE=5 COLOR="#FF0000"><B>Q&amp;A</B></FONT></CENTER></H3>
<BR>
<P><B>Q: What if I use nonstandard controls in my HTML Layout?</B>
<BR>
<P><B>A:</B> Using nonstandard controls in an HTML Layout is the same as using them directly on a Web page. You need to put a copy of a control on your server, and then set the CodeBase property of the control to point to your server.
<BR>
<P ALIGN=CENTER>
<A HREF="lax13.htm" TARGET="_self"><IMG SRC="blanprev.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Previous Page"></A>
<A HREF="#I0" TARGET="_self"><IMG SRC="blantop.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Page Top"></A>
<A HREF="httoc.htm" TARGET="_self"><IMG SRC="blantoc.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="TOC"></A>
<A HREF="lax15.htm" TARGET="_self"><IMG SRC="blannext.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="Next Page"></A>
<A HREF="http://www.mcp.com/sams/" TARGET="_self"><IMG SRC="blanhome.gif" WIDTH = 37 HEIGHT = 37 BORDER = 0 ALT="See Page"></A>
</BODY></HTML>
