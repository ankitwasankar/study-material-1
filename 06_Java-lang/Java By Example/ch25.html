<HTML>

<HEAD>

<TITLE>Chapter 25 -- Mouse and Keyboard Events</TITLE>



<META>

</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#CE2910">

<H1><FONT SIZE=6 COLOR=#Ff0000>Chapter&nbsp;25</FONT></H1>

<H1><FONT SIZE=6 COLOR=#Ff0000>Mouse and Keyboard Events</FONT>

</H1>

<HR>

<P>

<CENTER><B><FONT SIZE=5><A NAME="CONTENTS">CONTENTS</A></FONT></B></CENTER>

<UL>

<LI><A HREF="#TheEventObject">

The Event Object</A>

<LI><A HREF="#TheMouse">

The Mouse</A>

<UL>

<LI><A HREF="#HandlingMouseClicks">

Handling Mouse Clicks</A>

<LI><A HREF="#ExampleUsingMouseClicksinanApplet">

Example: Using Mouse Clicks in an Applet</A>

<LI><A HREF="#HandlingMouseMovement">

Handling Mouse Movement</A>

<LI><A HREF="#ExampleRespondingtoMouseMovementinanApplet">

Example: Responding to Mouse Movement in an Applet</A>

</UL>

<LI><A HREF="#TheKeyboard">

The Keyboard</A>

<UL>

<LI><A HREF="#RespondingtoKeyPresses">

Responding to Key Presses</A>

<LI><A HREF="#PredefinedKeyConstants">

Predefined Key Constants</A>

<LI><A HREF="#KeyModifiers">

Key Modifiers</A>

<LI><A HREF="#ExampleUsingKeyPressesinanApplet">

Example: Using Key Presses in an Applet</A>

</UL>

<LI><A HREF="#HandlingEventsDirectly">

Handling Events Directly</A>

<UL>

<LI><A HREF="#ExampleOverridingIhandleEventIinanApplet">

Example: Overriding <I>handleEvent()</I> in an Applet</A>

</UL>

<LI><A HREF="#Summary">

Summary</A>

<LI><A HREF="#ReviewQuestions">

Review Questions</A>

<LI><A HREF="#ReviewExercises">

Review Exercises</A>

</UL>



<HR>

<P>

Up until now, your applets have responded to events generated

by Java components like buttons, text fields, and list boxes.

You've yet to examine how to respond to events generated by the

most basic of a computer's controls, the mouse and the keyboard.

Because virtually every computer has these important hardware

controls, you can confidently take advantage of them in your applets

to collect various types of input. In this chapter, you learn

the secrets of mouse and keyboard handling in Java applets.

<H2><A NAME="TheEventObject"><FONT SIZE=5 COLOR=#Ff0000>

The Event Object</FONT></A></H2>

<P>

In order to understand how to respond to various types of events,

you need to know more about Java's <TT>Event</TT> class, an object

of which is passed to any event-handling method. When you want

to respond to a Java button control, for example, you override

the <TT>action()</TT> method, whose first argument is an <TT>Event</TT>

object. You then examine the <TT>target</TT> field of the <TT>Event</TT>

object to determine whether it was the button control that generated

the event. The <TT>Event</TT> class, however, defines many constants

and data fields that provide information about the event represented

by the object.

<P>

First, the <TT>Event</TT> class defines constants for all of the

events to which an event-handling method can respond. In this

chapter, you'll learn about some of these constants, which include

<TT>MOUSE_DOWN</TT>, <TT>MOUSE_UP</TT>, and <TT>KEY_PRESS</TT>.

The class also defines constants for special keys, such as <TT>f1</TT>,

<TT>PGUP</TT>, <TT>PGDN</TT>, <TT>HOME</TT>, and so on. Finally,

the <TT>Event</TT> class defines the data fields shown in Table

25.1. How you use these data fields depends on the type of event

represented by the <TT>Event</TT> object.<BR>

<P>

<CENTER><B>Table 25.1&nbsp;&nbsp;Data Fields of the </B><I>Event</I><B>

Class.</B></CENTER>

<P>

<CENTER>

<TABLE BORDER=1 WIDTH=80%>

<TR VALIGN=TOP><TD WIDTH=157><I><B>Field</B></I></TD><TD WIDTH=434><I><B>Description</B></I>

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>Object arg</TT></TD><TD WIDTH=434>Event-specific information. With a button event, for example, this field is the button's label.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int clickCount</TT></TD><TD WIDTH=434>The click count for mouse events. A value of 1 means a single click, and 2 means a double-click.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int id</TT></TD><TD WIDTH=434>The event's type, such as <TT>MOUSE_DOWN</TT>, <TT>MOUSE_MOVE</TT>, <TT>KEY_PRESS</TT>, etc.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int key</TT></TD><TD WIDTH=434>The key for a key-related event. For a <TT>KEY_PRESS</TT> event, for example, this would be the key that was pressed.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int modifiers</TT></TD><TD WIDTH=434>The key modifiers, including the shift and control keys. The <TT>Event</TT> class defines constants such as <TT>SHIFT_MASK</TT> and <TT>CTRL_MASK</TT>.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>Object target</TT></TD><TD WIDTH=434>The type of object-such as Button, TextField, and so on-that generated the event.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>long when</TT></TD><TD WIDTH=434>The event's time stamp.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int x</TT></TD><TD WIDTH=434>The X coordinate associated with the event, usually used with mouse events to indicate the mouse's position at the time of the event.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=157><TT>int y</TT></TD><TD WIDTH=434>The Y coordinate associated with the event, usually used with mouse events to indicate the mouse's position at the time of the event.

</TD></TR>

</TABLE>

</CENTER>

<H2><A NAME="TheMouse"><FONT SIZE=5 COLOR=#Ff0000>

The Mouse</FONT></A></H2>

<P>

Most people use their computer's mouse darn near as much as its

keyboard. I can vouch for this from first-hand experience, because

my only bout with RSI (repetitive strain injury) came not from

typing furiously all day, but from maneuvering my mouse to mark

paragraphs, highlight words, click buttons, make list selections,

bring up menus, and any number of other mousely tasks. I'm not

looking for your sympathy, though. My point is that the mouse

is one of the most important input devices attached to your computer.

To write complete applets, you're going to have to master responding

to mouse events in your Java programs.

<P>

Luckily, responding to mouse input is a simple matter. Because

responding to the events generated by the mouse are such an important

and common task in modern programming, Java's classes already

include special methods for responding to these events. Exactly

what events are you expected to handle? A mouse generates six

types of event messages that you can capture in your applets.

These events are listed below, along with their descriptions and

the method that handles them:

<UL>

<LI><TT>MOUSE_DOWN</TT>-This event, which is handled by the <TT>mouseDown()</TT>

method, is caused when the user presses the mouse button.

<LI><TT>MOUSE_UP</TT>-This event, which is handled by the <TT>mouseUp()</TT>

method, is caused when the user releases the left mouse button.

<LI><TT>MOUSE_MOVE</TT>-This event, which is handled by the <TT>mouseMove()</TT>

method, occurs when the user moves the mouse pointer on the screen.

<LI><TT>MOUSE_DRAG</TT>-This event, which is handled by the <TT>mouseDrag()</TT>

method, is generated when the user moves the mouse pointer while

holding down the left mouse button.

<LI><TT>MOUSE_ENTER</TT>-This event, which is handled by the <TT>mouseEnter()</TT>

method, is sent when the mouse pointer enters the area owned by

an applet or component.

<LI><TT>MOUSE_EXIT</TT>-This event, which is handled by the <TT>mouseExit()</TT>

method, occurs when the mouse pointer leaves the area owned by

an applet or a component.

</UL>

<P>

In the sections that follow, you'll learn more about the most

commonly used of these mouse events.

<H3><A NAME="HandlingMouseClicks">

Handling Mouse Clicks</A></H3>

<P>

Without a doubt, the most commonly used mouse event in Java programs

(and any other program written for a graphical user interface)

is the <TT>MOUSE_DOWN</TT> event, which is generated whenever

the user clicks within an applet. It's the <TT>MOUSE_DOWN</TT>

event, for example, that lets Java know when an on-screen button

component has been clicked. You don't have to worry about clicks

on on-screen buttons (usually), because they're handled by Java.

However, you can respond to <TT>MOUSE_DOWN</TT> events in your

applets in order to accomplish other input tasks.

<P>

Java provides a couple of methods by which you can respond to

mouse events. The easiest way to capture a <TT>MOUSE_DOWN</TT>

event is to override the applet's <TT>mouseDown()</TT> method.

Java automatically calls <TT>mouseDown()</TT> whenever the <TT>MOUSE_DOWN</TT>

event is generated, which makes responding to this event easier

than melting butter with a blowtorch. The <TT>mouseDown()</TT>

method's signature looks like this:

<BLOCKQUOTE>

<PRE>

public boolean mouseDown(Event evt, int x, int y)

</PRE>

</BLOCKQUOTE>

<P>

The arguments passed to the function are an <TT>Event</TT> object

and the X,Y coordinates of the mouse event. Although Java has

already extracted the X,Y mouse coordinates for you, you can also

get them from the <TT>Event</TT> object by examining the values

stored in the <TT>x</TT> and <TT>y</TT> data fields, as described

in Table 25.1. (Because Java has already extracted the coordinates

for you, though, it makes more sense to use the <TT>x</TT> and

<TT>y</TT> parameters sent to the function.) What you do with

these coordinates depends, of course, on your applet. In the next

section, you'll see how to use the coordinates to display graphics

on the screen.

<P>

<CENTER>

<TABLE BORDER=1 WIDTH=80%>

<TR VALIGN=TOP><TD><B>NOTE</B></TD></TR>

<TR VALIGN=TOP><TD>

<BLOCKQUOTE>

Although most of Java's event-handling methods automatically receive as arguments the basic information you need about a specific event (such as the coordinates of a mouse click), you can extract whatever additional information you need from the 
<TT>Event</TT> object, which is always the first parameter in a message-handling method.

</BLOCKQUOTE>



</TD></TR>

</TABLE>

</CENTER>

<P>

<H3><A NAME="ExampleUsingMouseClicksinanApplet">

Example: Using Mouse Clicks in an Applet</A></H3>

<P>

As I was describing the <TT>mouseDown()</TT> method in the previous

section, I felt an example coming on. And, sure enough, here it

is. The applet in Listing 25.1 responds to mouse clicks by printing

the word &quot;Click!&quot; wherever the user clicks in the applet.

It does this by storing the coordinates of the mouse click in

the applet's <TT>coordX</TT> and <TT>coordY</TT> data fields.

The <TT>paint()</TT> method then uses these coordinates to display

the word. Figure 25.1 shows MouseApplet running under Appletviewer.

<P>

<IMG SRC="f25-1.gif"><B> Figure 25.1 : </B><I>The MouseApplet applet responds to mouse clicks.



</I></A><P>

<HR>

<BLOCKQUOTE>

<B>Listing 25.1&nbsp;&nbsp;MouseApplet.java: Using Mouse Clicks

in an Applet.<BR>

</B>

</BLOCKQUOTE>

<BLOCKQUOTE>

<PRE>

import java.awt.*;

import java.applet.*;



public class MouseApplet extends Applet

{

    int coordX, coordY;



    public void init()

    {

        coordX = -1;

        coordY = -1;



        Font font =

            new Font(&quot;TimesRoman&quot;, Font.BOLD, 24);

        setFont(font);



        resize(400, 300);

    }



    public void paint(Graphics g)

    {

        if (coordX != -1)

            g.drawString(&quot;Click!&quot;, coordX, coordY);

    }



    public boolean mouseDown(Event evt, int x, int y)

    {

        coordX = x;

        coordY = y;

        repaint();

        return true;

    }

}

</PRE>

</BLOCKQUOTE>

<HR>

<P>

<IMG ALIGN=RIGHT SRC="pseudo.gif" HEIGHT=94 WIDTH=94 BORDER=1>

<BLOCKQUOTE>

Tell Java that the applet uses the classes in the <TT>awt</TT>

package.<BR>

Tell Java that the applet uses the classes in the <TT>applet</TT>

package.<BR>

Derive the <TT>MouseApplet</TT> class from Java's <TT>Applet</TT>

class.<BR>

    Declare the class's data fields.<BR>

    Override the <TT>init()</TT> method.<BR>

        Initialize the click coordinates.<BR>

        Create and set the font for the applet.<BR>

        Size the applet.<BR>

    Override the <TT>paint()</TT> method.<BR>

        If the user has selected a coordinate...<BR>

            Draw the word Click! at the selected coordinate.<BR>

    Override the <TT>mouseDown()</TT> method.<BR>

        Save the mouse click's coordinates.<BR>

        Force Java to repaint the applet.<BR>

        Tell Java that the event was handled.<BR>

</BLOCKQUOTE>

<P>

<CENTER>

<TABLE BORDER=1 WIDTH=80%>

<TR VALIGN=TOP><TD><B>NOTE</B></TD></TR>

<TR VALIGN=TOP><TD>

<BLOCKQUOTE>

When you run MouseApplet, you'll discover that the applet window gets erased each time the <TT>paint()</TT> method is called. That's why only one &quot;Click!&quot; ever appears in the window.

</BLOCKQUOTE>



</TD></TR>

</TABLE>

</CENTER>

<P>

<H3><A NAME="HandlingMouseMovement">

Handling Mouse Movement</A></H3>

<P>

Although mouse clicks are the most common type of mouse event

to which your applet may want to respond, tracking the mouse pointer's

movement can also be useful. Drawing programs, for example, enable

you to draw shapes by tracking the movement of the mouse and displaying

the results on the screen.

<P>

Unlike mouse clicks, though, which are rare, only occurring when

the user presses a mouse button, <TT>MOUSE_MOVE</TT> events come

flooding into your applet by the hundreds as the user moves the

mouse around the screen. Each one of these events can be handled

in the <TT>mouseMove()</TT> method, whose signature looks like

this:

<BLOCKQUOTE>

<PRE>

public boolean mouseMove(Event evt, int x, int y)

</PRE>

</BLOCKQUOTE>

<P>

Yep. Except for its name, the <TT>mouseMove()</TT> method looks

exactly like the <TT>mouseDown()</TT> method, receiving as arguments

an <TT>Event</TT> object and the X,Y coordinates at which the

event occurred.

<H3><A NAME="ExampleRespondingtoMouseMovementinanApplet">

Example: Responding to Mouse Movement in an Applet</A></H3>

<P>

Responding to mouse movement isn't something you have to do often

in your applets. Still, it's a handy tool to have on your belt.

You might, for example, need to track mouse movement when writing

a game applet that uses the mouse as input. A more common use

is in graphics programs that enable you to draw on the screen.

Listing 25.2 is just such an applet.

<P>

When you run MouseApplet2 with Appletviewer, you see a blank window.

Click the mouse in the window to choose a starting point and then

move the mouse around the window. Wherever the mouse pointer goes,

it leaves a black line behind (Figure 25.2). Although this is

a very simple drawing program, it gives you some idea of how you

might use a mouse to accomplish other similar tasks.

<P>

<IMG SRC="f25-2.gif"><B> Figure 25.2 : </B><I>This applet draws by tracking the movement of the mouse.



</I></A><P>

<HR>

<BLOCKQUOTE>

<B>Listing 25.2&nbsp;&nbsp;MouseApplet2.java: An Applet That Tracks

Mouse Movement.<BR>

</B>

</BLOCKQUOTE>

<BLOCKQUOTE>

<PRE>

import java.awt.*;

import java.applet.*;



public class MouseApplet2 extends Applet

{

    Point startPoint;

    Point points[];

    int numPoints;

    boolean drawing;



    public void init()

    {

        startPoint = new Point(0, 0);

        points = new Point[1000];

        numPoints = 0;

        drawing = false;

        resize(400, 300);

    }



    public void paint(Graphics g)

    {

        int oldX = startPoint.x;

        int oldY = startPoint.y;



        for (int x=0; x&lt;numPoints; ++x)

        {

            g.drawLine(oldX, oldY, points[x].x, points[x].y);

            oldX = points[x].x;

            oldY = points[x].y;

        }

    }



    public boolean mouseDown(Event evt, int x, int y)

    {

        drawing = true;

        startPoint.x = x;

        startPoint.y = y;

        return true;

    }



    public boolean mouseMove(Event evt, int x, int y)

    {

        if ((drawing) &amp;&amp; (numPoints &lt; 1000))

        {

            points[numPoints] = new Point(x, y);

            ++numPoints;

            repaint();

        }



        return true;

    }

}

</PRE>

</BLOCKQUOTE>

<HR>

<P>

<IMG ALIGN=RIGHT SRC="pseudo.gif" HEIGHT=94 WIDTH=94 BORDER=1>

<BLOCKQUOTE>

Tell Java that the applet uses the classes in the <TT>awt</TT>

package.<BR>

Tell Java that the applet uses the classes in the <TT>applet</TT>

package.<BR>

Derive the <TT>MouseApplet2</TT> class from Java's <TT>Applet</TT>

class.<BR>

    Declare the class's data fields.<BR>

    Override the <TT>init()</TT> method.<BR>

        Initialize the starting point.<BR>

        Create an array for storing the coordinates of line segments.

<BR>

        Create and set the font for the applet.<BR>

        Set point count to zero.<BR>

        Set drawing flag off.<BR>

        Size the applet.<BR>

    Override the <TT>paint()</TT> method.<BR>

        Initialize the drawing's starting point.<BR>

        Cycle through each element in the <TT>points[]</TT> array.

<BR>

            Draw a line segment.<BR>

            Save ending point as the starting point for the next

line.<BR>

    Override the <TT>mouseDown()</TT> method.<BR>

        Set the flag in order to allow drawing to begin.<BR>

        Save the mouse click's coordinates.<BR>

        Tell Java that the event was handled.<BR>

    Override the <TT>mouseMove()</TT> method.<BR>

        if it's okay to add another line segment...<BR>

            Create a new point and save the mouse's coordinates.

<BR>

            Increment the point counter.<BR>

            Force Java to repaint the applet.<BR>

        Tell Java that the event was handled.

</BLOCKQUOTE>

<H2><A NAME="TheKeyboard"><FONT SIZE=5 COLOR=#Ff0000>

The Keyboard</FONT></A></H2>

<P>

The keyboard has been around even longer than the mouse and has

been the primary interface between humans and their computers

for decades. Given the keyboard's importance, obviously there

may be times when you'll want to handle the keyboard events at

a lower level than you can with something like a <TT>TextField</TT>

control. Java responds to two basic key events, which are represented

by the <TT>KEY_PRESS</TT> and <TT>KEY_RELEASE</TT> constants.

As you'll soon see, Java defines methods that make it just as

easy to respond to the keyboard as it is to respond to the mouse.

<H3><A NAME="RespondingtoKeyPresses">

Responding to Key Presses</A></H3>

<P>

Whenever the user presses a key when an applet is active, Java

sends the applet a <TT>KEY_PRESS</TT> event. In your applet, you

can respond to this event by overriding the <TT>keyDown()</TT>

method, whose signature looks like this:

<BLOCKQUOTE>

<PRE>

public boolean keyDown(Event evt, int key)

</PRE>

</BLOCKQUOTE>

<P>

As you can see, this method receives two arguments, which are

an <TT>Event</TT> object and an integer representing the key that

was pressed. This integer is actually the ASCII representation

of the character represented by the key. In order to use this

value in your programs, however, you must first cast it to a <TT>char</TT>

value, like this:

<BLOCKQUOTE>

<PRE>

char c = (char)key;

</PRE>

</BLOCKQUOTE>

<H3><A NAME="PredefinedKeyConstants">

Predefined Key Constants</A></H3>

<P>

Some of the keys on your keyboard issue commands rather than generate

characters. These keys include all the F keys, as well as keys

like Shift, Ctrl, Page Up, Page Down, and so on. In order to make

these types of keys easier to handle in your applets, Java's <TT>Event</TT>

class defines a set of constants that represent these key's values.

Table 25.2 lists these constants.<BR>

<P>

<CENTER><B>Table 25.2&nbsp;&nbsp;Key Constants of the </B><I>Event</I><B>

Class.</B></CENTER>

<P>

<CENTER>

<TABLE BORDER=1 WIDTH=80%>

<TR VALIGN=TOP><TD WIDTH=145><I><B>Constant</B></I></TD><TD WIDTH=204><I><B>Key</B></I>

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>DOWN</TD><TD WIDTH=204>The down arrow key.</TD>

</TR>

<TR VALIGN=TOP><TD WIDTH=145>END</TD><TD WIDTH=204>The End key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f1</TD><TD WIDTH=204>The f1 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f2</TD><TD WIDTH=204>The f2 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f3</TD><TD WIDTH=204>The f3 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f4</TD><TD WIDTH=204>The f4 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f5</TD><TD WIDTH=204>The f5 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f6</TD><TD WIDTH=204>The f6 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f7</TD><TD WIDTH=204>The f7 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f8</TD><TD WIDTH=204>The f8 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f9</TD><TD WIDTH=204>The f9 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f10</TD><TD WIDTH=204>The f10 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f11</TD><TD WIDTH=204>The f11 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>f12</TD><TD WIDTH=204>The f12 key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>HOME</TD><TD WIDTH=204>The Home key.</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>LEFT</TD><TD WIDTH=204>The left arrow key.</TD>

</TR>

<TR VALIGN=TOP><TD WIDTH=145>PGDN</TD><TD WIDTH=204>The Page Down key.</TD>

</TR>

<TR VALIGN=TOP><TD WIDTH=145>PGUP</TD><TD WIDTH=204>The Page Up key.</TD>

</TR>

<TR VALIGN=TOP><TD WIDTH=145>RIGHT</TD><TD WIDTH=204>The right arrow key.

</TD></TR>

<TR VALIGN=TOP><TD WIDTH=145>UP</TD><TD WIDTH=204>The up arrow key.</TD>

</TR>

</TABLE>

</CENTER>

<P>

<H3><A NAME="KeyModifiers">

Key Modifiers</A></H3>

<P>

The <TT>Event</TT> class also defines a number of constants for

modifier keys that the user might press along with the basic key.

These constants include <TT>ALT_MASK</TT>, <TT>SHIFT_MASK</TT>,

and <TT>CTRL_MASK</TT>, which represent the Alt, Shift, and Ctrl

(or Control) keys on your keyboard. The <TT>SHIFT_MASK</TT> and

<TT>CTRL_MASK</TT> constants are used in the <TT>Event</TT> class's

methods <TT>shiftDown()</TT> and <TT>controlDown()</TT>, each

which of returns a <TT>boolean</TT> value indicating whether the

modifier key is pressed. (There currently is no <TT>altDown()</TT>

method.) You can also examine the <TT>Event</TT> object's <TT>modifiers</TT>

field to determine whether a particular modifier key was pressed.

For example, if you wanted to check for the Alt key, you might

use a line of Java code like this:

<BLOCKQUOTE>

<PRE>

boolean altPressed = (evt.modifiers &amp; Event.ALT_MASK) != 0;

</PRE>

</BLOCKQUOTE>

<P>

By ANDing the mask with the value in the <TT>modifiers</TT> field,

you end up with a non-zero value if the Alt key was pressed and

a 0 if it wasn't. You convert this result to a <TT>boolean</TT>

value by comparing the result with 0.

<H3><A NAME="ExampleUsingKeyPressesinanApplet">

Example: Using Key Presses in an Applet</A></H3>

<P>

Although capturing key presses is a fairly simple process, there's

nothing like an example applet to put the theoretical stuff to

the test. Listing 25.3 is an applet called KeyApplet that displays

whatever key the user presses. Figure 25.3 shows the applet running

under Appletviewer.

<P>

<IMG SRC="f25-3.gif"><B> Figure 25.3 : </B><I>This applet displays the last character typed.



</I></A><P>

<P>

<CENTER>

<TABLE BORDER=1 WIDTH=80%>

<TR VALIGN=TOP><TD><B>NOTE</B></TD></TR>

<TR VALIGN=TOP><TD>

<BLOCKQUOTE>

If you run KeyApplet under a browser like Netscape Navigator, click on the applet with your mouse before you start typing. This ensures that the applet has the focus and will receive the key presses.</BLOCKQUOTE>



</TD></TR>

</TABLE>

</CENTER>

<P>

<HR>

<BLOCKQUOTE>

<B>Listing 25.3&nbsp;&nbsp;KeyApplet.java: An Applet That Captures

Key Presses.<BR>

</B>

</BLOCKQUOTE>

<BLOCKQUOTE>

<PRE>

import java.awt.*;

import java.applet.*;



public class KeyApplet extends Applet

{

    int keyPressed;



    public void init()

    {

        keyPressed = -1;



        Font font =

            new Font(&quot;TimesRoman&quot;, Font.BOLD, 144);

        setFont(font);



        resize(200, 200);

    }



    public void paint(Graphics g)

    {

        String str = &quot;&quot;;



        if (keyPressed != -1)

        {

            str += (char)keyPressed;

            g.drawString(str, 40, 150);

        }

    }



    public boolean keyDown(Event evt, int key)

    {

        keyPressed = key;

        repaint();

        return true;

    }

}

</PRE>

</BLOCKQUOTE>

<HR>

<P>

<IMG ALIGN=RIGHT SRC="pseudo.gif" HEIGHT=94 WIDTH=94 BORDER=1>

<BLOCKQUOTE>

Tell Java that the applet uses the classes in the <TT>awt</TT>

package.<BR>

Tell Java that the applet uses the classes in the <TT>applet</TT>

package.<BR>

Derive the <TT>KeyApplet</TT> class from Java's <TT>Applet</TT>

class.<BR>

    Declare the class's data field.<BR>

    Override the <TT>init()</TT> method.<BR>

        Initialize <TT>keyPressed</TT> to indicate no valid key

received yet.<BR>

        Create and set the font for the applet.<BR>

        Size the applet.<BR>

    Override the <TT>paint()</TT> method.<BR>

        Create the empty display string.<BR>

        Draw the character on the screen.<BR>

    Override the <TT>keyDown()</TT> method.<BR>

        Save the key that was pressed.<BR>

        Force Java to redraw the applet.<BR>

        Tell Java that the event was handled.

</BLOCKQUOTE>

<H2><A NAME="HandlingEventsDirectly"><FONT SIZE=5 COLOR=#Ff0000>

Handling Events Directly</FONT></A></H2>

<P>

All of the events received by your applet are processed by the

<TT>handleEvent()</TT> method, which the <TT>Applet</TT> class

inherits from the <TT>Component</TT> class. When this method is

not overridden in your applet, the default implementation is responsible

for calling the many methods that respond to events. Listing 25.4

shows how the <TT>handleEvent()</TT> method is implemented in

the <TT>Component</TT> class. By examining this listing, you can

easily see why you only have to override methods like <TT>mouseDown()</TT>

to respond to events. In the next section, you see how to customize

<TT>handleEvent()</TT> in your own programs.

<HR>

<BLOCKQUOTE>

<B>Listing 25.4&nbsp;&nbsp;LST25_4.TXT: The Default Implementation

of </B><I>handleEvent(&nbsp;)</I><B>.<BR>

</B>

</BLOCKQUOTE>

<BLOCKQUOTE>

<PRE>

public boolean handleEvent(Event evt) {

switch (evt.id) {

  case Event.MOUSE_ENTER:

    return mouseEnter(evt, evt.x, evt.y);



  case Event.MOUSE_EXIT:

    return mouseExit(evt, evt.x, evt.y);



  case Event.MOUSE_MOVE:

    return mouseMove(evt, evt.x, evt.y);



  case Event.MOUSE_DOWN:

    return mouseDown(evt, evt.x, evt.y);



  case Event.MOUSE_DRAG:

    return mouseDrag(evt, evt.x, evt.y);



  case Event.MOUSE_UP:

    return mouseUp(evt, evt.x, evt.y);



  case Event.KEY_PRESS:

  case Event.KEY_ACTION:

    return keyDown(evt, evt.key);



  case Event.KEY_RELEASE:

  case Event.KEY_ACTION_RELEASE:

    return keyUp(evt, evt.key);

    

  case Event.ACTION_EVENT:

    return action(evt, evt.arg);

  case Event.GOT_FOCUS:

    return gotFocus(evt, evt.arg);

  case Event.LOST_FOCUS:

    return lostFocus(evt, evt.arg);

}

return false;

}

</PRE>

</BLOCKQUOTE>

<HR>

<H3><A NAME="ExampleOverridingIhandleEventIinanApplet">

Example: Overriding <I>handleEvent()</I> in an Applet</A></H3>

<P>

Although the default implementation of <TT>handleEvent()</TT>

calls special methods that you can override in your applet for

each event, you might want to group all your event handling in

one method to conserve on overhead, change the way an applet responds

to a particular event, or even create your own events. To accomplish

any of these tasks (or any others you might come up with), you

can forget the individual event-handling methods and override

<TT>handleEvent()</TT> instead.

<P>

In your version of <TT>handleEvent()</TT>, you must examine the

<TT>Event</TT> object's <TT>id</TT> field in order to determine

which event is being processed. You can just ignore events in

which you're not interested. However, be sure to return <TT>false</TT>

whenever you ignore a message, so that Java knows that it should

pass the event on up the object hierarchy. Listing 25.5 is a rewritten

version of the MouseApplet2 applet, called MouseApplet3. This

version overrides the <TT>handleEvent()</TT> method in order to

respond to events.

<HR>

<BLOCKQUOTE>

<B>Listing 25.5&nbsp;&nbsp;MouseApplet3.java: Using the </B><I>handleEvent(&nbsp;)</I><B>

Method.<BR>

</B>

</BLOCKQUOTE>

<BLOCKQUOTE>

<PRE>

import java.awt.*;

import java.applet.*;



public class MouseApplet3 extends Applet

{

    Point startPoint;

    Point points[];

    int numPoints;

    boolean drawing;



    public void init()

    {

        startPoint = new Point(0, 0);

        points = new Point[1000];

        numPoints = 0;

        drawing = false;

        resize(400, 300);

    }



    public void paint(Graphics g)

    {

        int oldX = startPoint.x;

        int oldY = startPoint.y;



        for (int x=0; x&lt;numPoints; ++x)

        {

            g.drawLine(oldX, oldY, points[x].x, points[x].y);

            oldX = points[x].x;

            oldY = points[x].y;

        }

    }



    public boolean handleEvent(Event evt)

    {

        switch(evt.id)

        {

            case Event.MOUSE_DOWN:

                drawing = true;

                startPoint.x = evt.x;

                startPoint.y = evt.y;

                return true;

            case Event.MOUSE_MOVE:

                if ((drawing) &amp;&amp; (numPoints &lt; 1000))

                {

                    points[numPoints] = new Point(evt.x, evt.y);

                    ++numPoints;

                    repaint();

                }

                return true;

            default:

                return false;

        }

    }

}

</PRE>

</BLOCKQUOTE>

<HR>

<H2><A NAME="Summary"><FONT SIZE=5 COLOR=#Ff0000>

Summary</FONT></A></H2>

<P>

Because the keyboard and the mouse are two of the most important

devices for accepting input from the user, it's important that

you know how to handle these devices in your applets. Maybe most

of your applets will work fine by leaving such details up to Java

or maybe you'll want to have more control over the devices than

the default behavior allows. You can capture most messages received

by a Java applet by overloading the appropriate event handlers,

such as <TT>mouseDown()</TT> and <TT>keyDown()</TT>. However,

if you want to step back even further in your event-handling code,

you can override the <TT>handleEvent()</TT> method, which receives

all events sent to an applet.

<H2><A NAME="ReviewQuestions"><FONT SIZE=5 COLOR=#Ff0000>

Review Questions</FONT></A></H2>

<OL>

<LI>What is the mouse event that's most commonly captured and

responded to in Java applets?

<LI>What is the mouse message an applet receives the most of?

<LI>What are the six different mouse event messages that your

applet may receive?

<LI>What are the two keyboard events your applet is likely to

receive?

<LI>How can you determine what type of object generated an event?

<LI>How can you determine the type of event message that's being

received?

<LI>When your applet receives a mouse-related message, how can

you determine the coordinates of the mouse at the time of the

event?

<LI>How can you tell whether the user single- or double-clicked

his mouse?

<LI>What two methods are associated with the <TT>KEY_PRESS</TT>

and <TT>KEY_RELEASE</TT> event messages?

<LI>What arguments are received by the <TT>keyDown()</TT> method?

<LI>What arguments are received by the <TT>mouseDown()</TT> method?

<LI>Why might you need to use the <TT>SHIFT_MASK</TT> and <TT>CTRL_MASK</TT>

constants?

<LI>If you want to handle all events in a single method, what

method should you override in your applet?

</OL>

<H2><A NAME="ReviewExercises"><FONT SIZE=5 COLOR=#Ff0000>

Review Exercises</FONT></A></H2>

<OL>

<LI>Write an applet that displays a rectangle wherever the user

clicks.

<LI>Write an applet that displays a rectangle, the color which

changes whenever the user presses a key on his keyboard.

<LI>Write an applet that displays the current coordinates of the

mouse as the mouse moves around the applet's window.

<LI>Write an applet that enables the user to type a string of

characters on the screen. Use a <TT>String</TT> object to hold

the characters, adding each new character to the string as the

user types and displaying the string in the applet's <TT>paint()</TT>

method.

<LI>Modify MouseApplet2 so that the first <TT>MOUSE_DOWN</TT>

event selects a starting point, after which the applet remembers

all the <TT>MOUSE_MOVE</TT> coordinates. However, the applet shouldn't

draw the lines associated with these moves until the user presses

his f2 key. Pressing f3 should erase the lines from the applet

and signal the applet to start the process over again. (You can

find the solution to this exercise, called MouseApplet4,  in the

CHAP25 folder of this book's CD-ROM.)

</OL>

<HR>



<CENTER><P><A HREF="ch24.html"><IMG SRC="pc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A>

<A HREF="#CONTENTS"><IMG SRC="cc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A>

<A HREF="index.html"><IMG SRC="hb.gif" BORDER=0 HEIGHT=88 WIDTH=140></A>

<A HREF="ch26.html"><IMG SRC="nc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A>

<HR WIDTH="100%"></P></CENTER>

</BODY>

</HTML>