<HTML>

<HEAD>
   <TITLE>Chapter 34 -- Sample Scripts</TITLE>
   <META>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#CE2910">
<H1><FONT COLOR=#Ff0000>Chapter 34</FONT></H1>
<H1><B><FONT SIZE=5 COLOR=#Ff0000>Sample Scripts</FONT></B>
</H1>
<P>
<HR WIDTH="100%"></P>
<P>
<H3 ALIGN=CENTER><FONT COLOR="#000000"><FONT SIZE=+2>CONTENTS<A NAME="CONTENTS"></A>
</FONT></FONT></H3>
<UL>
<LI><A HREF="#ACustomizableWebPage" >A Customizable Web Page</A>
<LI><A HREF="#StoryTeller" >Story Teller</A>
<LI><A HREF="#WebGuide" >Web Guide</A>
<LI><A HREF="#Summary" >Summary</A>
</UL>
<HR>
<P>
This chapter contains some sample scripts written in JavaScript
for your viewing. They are provided to give you an idea of what
JavaScript can do, as well as allow you to view some functional
code.
<H2><A NAME="ACustomizableWebPage"><FONT SIZE=5 COLOR=#Ff0000>A
Customizable Web Page</FONT></A></H2>
<P>
The script shown in Listing 34.1 allows a user to create a simple
Web page. When the new page is generated, a separate window appears
in order to display the generated page, as shown in <IMG SRC="f34-1.gif" >Figures 34.1</A>
and <IMG SRC="f34-2.gif" >34.2</A>. Look at the following code
and try to think of how you might be able to incorporate frames
with this script. In order to run the script, type it into a file
named <TT><FONT FACE="Courier">custom.html</FONT></TT> in the <TT><FONT FACE="Courier">\jdg\ch34</FONT></TT>
directory, and then open the file with Netscape Navigator 2.0
or later.
<P>
<IMG SRC="f34-1.gif"><B>Figure 34.1 : </B><I> The Custom Web Page Demo opening screen.</I></A>
<P>
<IMG SRC="f34-2.gif"><B>Figure 34.2 : </B><I>The Web page generated by the script.</I></A>
<P>
<HR>
<BLOCKQUOTE>
<B>Listing 34.1. Script to implement a customizable Web page.</B>
<P>
<TT><FONT FACE="Courier">&lt;HTML&gt;<BR>
&lt;HEAD&gt;<BR>
&lt;SCRIPT LANGUAGE=JavaScript&gt;<BR>
&nbsp;&nbsp;//generate a new page showing the animation<BR>
&nbsp;&nbsp;function gen_page(form)<BR>
&nbsp;&nbsp;{<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//create a blank page<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow = window.open(&quot;&quot;,
&quot;Preview&quot;, &quot;&quot;);<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.open();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;HTML&gt;&lt;HEAD&gt;&quot;);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;TITLE&gt;TEST
PAGE&lt;/TITLE&gt;&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;/HEAD&gt;&lt;BODY
BGCOLOR=&quot;+form.BKGCOLOR.value+<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; TEXT=&quot;+
form.TXTCOLOR.value+&quot;&gt;&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;CENTER&gt;&lt;H1&gt;&quot;);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(form.TITLE.value+&quot;&lt;br&gt;&lt;/H1&gt;&quot;);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;IMG
SRC = '&quot;+form.IMAGEFILE.value+&quot;'&gt;&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;BR&gt;&lt;HR&gt;&quot;);
<BR>
<BR>
aniWindow.document.write(&quot;&lt;A href='mailto:&quot;+form.EMAIL.value+&quot;'&gt;Mail
Me&lt;/A&gt;&quot;);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;/CENTER&gt;&quot;);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.write(&quot;&lt;/BODY&gt;&lt;/HTML&gt;&quot;);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow.document.close();<BR>
&nbsp;&nbsp;}<BR>
&lt;/SCRIPT&gt;<BR>
&lt;TITLE&gt;JavaScript Customizable Web Page Demo&lt;/TITLE&gt;
<BR>
&lt;/HEAD&gt;<BR>
<BR>
&lt;BODY BGCOLOR=FFFFFF TEXT=000000&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;H1&gt;Custom Web Page Demo&lt;br&gt;<BR>
&lt;br&gt;<BR>
&lt;br&gt;<BR>
&lt;/H1&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;H2&gt;<BR>
&lt;FORM NAME=&quot;Web &quot;&gt;<BR>
&lt;RIGHT&gt;<BR>
&lt;A&gt;Background Color<BR>
&lt;INPUT TYPE=TEXT NAME=&quot;BKGCOLOR&quot; SIZE=6&gt;&lt;/A&gt;&lt;br&gt;
<BR>
&lt;A&gt;Text Color<BR>
&lt;INPUT TYPE=TEXT NAME=&quot;TXTCOLOR&quot; SIZE=6&gt;&lt;/A&gt;&lt;br&gt;
<BR>
&lt;A&gt;Title Text<BR>
&lt;INPUT TYPE=TEXT NAME=&quot;TITLE&quot; size=50&gt;&lt;/A&gt;&lt;br&gt;
<BR>
&lt;A&gt;Image name<BR>
&lt;INPUT TYPE=TEXT NAME=&quot;IMAGEFILE&quot; size=40&gt;&lt;/A&gt;&lt;br&gt;
<BR>
&lt;A&gt;Email address<BR>
&lt;INPUT TYPE=TEXT NAME=&quot;EMAIL&quot; size=20&gt;&lt;/A&gt;&lt;br&gt;
<BR>
&lt;INPUT TYPE=BUTTON NAME=&quot;GenBtn&quot; VALUE=&quot;&amp;Generate&quot;
<BR>
onClick = &quot;gen_page(this.form)&quot;&gt;<BR>
&lt;/RIGHT&gt;<BR>
&lt;/FORM&gt;<BR>
&lt;/H2&gt;<BR>
<BR>
&lt;HR&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;FONT SIZE=2&gt;<BR>
Comments to &lt;A HREF=&quot;mailto:cjardin@xprime.com&quot;&gt;X'
inc&lt;/A&gt;<BR>
&lt;/FONT&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;/BODY&gt;<BR>
&lt;/HTML&gt;</FONT></TT>
</BLOCKQUOTE>
<HR>
<H2><A NAME="StoryTeller"><FONT SIZE=5 COLOR=#Ff0000>Story Teller</FONT></A>
</H2>
<P>
The script shown in Listing 34.2 creates a ticker-tape display.
The display is then used to tell a story. (<IMG SRC="f34-3.gif" >See Figure 34.3</A>.)
Besides telling a great story, the script displays the use of
form objects, as well as the provided timer functions. When viewing
the code, think about how you might add graphics to the story.
Type the script into the file <TT><FONT FACE="Courier">story.html</FONT></TT>
and then open it with Netscape Navigator 2.0 or later.
<P>
<IMG SRC="f34-3.gif"><B>Figure 34.3 : </B><I> The Story Teller Demo opening page.</I></A>
<P>
<HR>
<BLOCKQUOTE>
<B>Listing 34.2. Story Teller demo script.</B>
<P>
<TT><FONT FACE="Courier">&lt;HTML&gt;<BR>
&lt;HEAD&gt;<BR>
<BR>
&lt;SCRIPT LANGUAGE=JavaScript&gt;<BR>
//What to say<BR>
var output = &quot;An elephant and a mouse were walking down a
jungle path. &quot;+<BR>
&quot;They talked and laughed and had the gayest of a time. Until
suddenly the&quot;+<BR>
&quot; elephant fell into a poacher's trap. The elephant said,
'Help me&quot;+<BR>
&quot; I have fallen and I can't get up.' The mouse responded,'wait
right there&quot;+<BR>
&quot; I will go get my HUMMER and a tow rope to pull you out.'
So the mouse &quot;+<BR>
&quot; fetches his HUMMER and saves the elephant from death. The
next day, '&quot;+<BR>
&quot; as luck would have it, the mouse falls into the same trap.
The elephant&quot;+<BR>
&quot; says to the mouse, 'here run up my $%^! to safety.' Which
is exactly what&quot;+<BR>
&quot; the mouse did, and they both lived happily ever after.
----!!!!---- Moral &quot;+<BR>
&quot; of the story, if you have a big enough $%^! you don't need
a HUMMER'. :-&gt;&quot;;<BR>
//MAX size of the display field, chars<BR>
&nbsp;&nbsp;var MAXSIZE = 30;<BR>
<BR>
//Used to pad string<BR>
&nbsp;&nbsp;var bunchOspace = <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&quot;;
<BR>
<BR>
//begining and ending string index<BR>
&nbsp;&nbsp;var bindex = 0;<BR>
&nbsp;&nbsp;var eindex = 1;<BR>
<BR>
&nbsp;&nbsp;var timerID = null;<BR>
&nbsp;&nbsp;var timerRunning = false;<BR>
<BR>
&nbsp;&nbsp;function stopclock()<BR>
&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if(timerRunning)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clearTimeout(timerID);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;timerRunning = false;<BR>
&nbsp;&nbsp;}<BR>
<BR>
&nbsp;&nbsp;function startclock()<BR>
{<BR>
&nbsp;&nbsp;stopclock();<BR>
&nbsp;&nbsp;tick();<BR>
}<BR>
<BR>
function tick()<BR>
{<BR>
&nbsp;&nbsp;if(eindex &lt;= output.length)<BR>
&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//populate the value<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].TICKER.value =
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bunchOspace.substring(0,MAXSIZE-(eindex
- bindex))+<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.substring(bindex,eindex);
<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((eindex - bindex) &lt; MAXSIZE)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++eindex;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++bindex;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++eindex;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;else<BR>
&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bindex = 0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eindex = 1;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;timerID = setTimeout(&quot;tick()&quot;,300);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;timerRunning = true;<BR>
&nbsp;&nbsp;}<BR>
&lt;/SCRIPT&gt;<BR>
&lt;TITLE&gt;JavaScript Story Teller Demo&lt;/TITLE&gt;<BR>
&lt;/HEAD&gt;<BR>
<BR>
&lt;BODY BGCOLOR=FFFFFF TEXT=000000 onLoad=&quot;startclock()&quot;&gt;
<BR>
&lt;CENTER&gt;<BR>
&lt;H1&gt;Story Teller Demo&lt;br&gt;<BR>
Let Me Tell You a Tale!&lt;br&gt;<BR>
&lt;br&gt;<BR>
&lt;/H1&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;H2&gt;<BR>
&lt;FORM NAME=&quot;Web &quot;&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;INPUT TYPE=TEXT SIZE=30 NAME=&quot;TICKER&quot;&gt;<BR>
&lt;/CENTER&gt;<BR>
&lt;/FORM&gt;<BR>
&lt;/H2&gt;<BR>
<BR>
&lt;HR&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;FONT SIZE=2&gt;<BR>
Comments to &lt;A HREF=&quot;mailto:cjardin@xprime.com&quot;&gt;X'
inc&lt;/A&gt;<BR>
&lt;/FONT&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;/BODY&gt;<BR>
&lt;/HTML&gt;</FONT></TT>
</BLOCKQUOTE>
<HR>
<H2><A NAME="WebGuide"><FONT SIZE=5 COLOR=#Ff0000>Web Guide</FONT></A>
</H2>
<P>
The script shown in Listing 34.3 creates a menu list from which
to select Web pages. (<IMG SRC="f34-4.gif" >See Figure 34.4</A>.)
The script shows how to  open separate Navigator windows. As you're
looking at it, try to figure out how this script could be implemented
without using a separate window. Type the script into the file
<TT><FONT FACE="Courier">guide.html</FONT></TT> and view it with
Netscape Navigator 2.0 or later.
<P>
<IMG SRC="f34-4.gif"><B>Figure 34.4 : </B><I> The Web Guide menu list.</I></A>
<P>
<HR>
<BLOCKQUOTE>
<B>Listing 34.3. Web Guide script.</B>
<P>
<TT><FONT FACE="Courier">&lt;HTML&gt;<BR>
&lt;HEAD&gt;<BR>
<BR>
&lt;SCRIPT LANGUAGE=JavaScript&gt;<BR>
&nbsp;&nbsp;//creates a structure to hold value<BR>
&nbsp;&nbsp;function select_item(value)<BR>
&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;this.value = value;<BR>
&nbsp;&nbsp;}<BR>
<BR>
&nbsp;&nbsp;//find what value is active in the selection list
<BR>
&nbsp;&nbsp;function find_selection(chcked_object)<BR>
&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;contents = new select_item();<BR>
&nbsp;&nbsp;&nbsp;&nbsp;for(var i=0;i&lt;chcked_object.length;i++)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(chcked_object[i].checked)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contents.value
= chcked_object[i].value;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return contents;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;}<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;//generate a new page showing the animation
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;function Do_Jump(formfield)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;{<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selection = find_selection(formfield.PLACESTOGO);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//create a blank page<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aniWindow = window.open(selection.value,
&quot;Preview&quot;, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;resizable=1,width=480,height=200&quot;);
<BR>
&nbsp;&nbsp;}<BR>
&lt;/SCRIPT&gt;<BR>
&lt;TITLE&gt;JavaScript Web Guide Demo&lt;/TITLE&gt;<BR>
&lt;/HEAD&gt;<BR>
<BR>
&lt;BODY BGCOLOR=FFFFFF TEXT=000000&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;H1&gt;Web Guide Demo&lt;br&gt;<BR>
I'll Take you there!&lt;br&gt;<BR>
&lt;br&gt;<BR>
&lt;/H1&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;H2&gt;<BR>
&lt;FORM NAME=&quot;Web &quot;&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://WWW.XPRIME.COM&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot; chECKED&gt;X prime,
Inc&lt;br&gt;<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://WWW.XPRIME.COM/chocabytes&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;ChocaBytes&lt;br&gt;
<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://WWW.HORIZONS.COM&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;Horizons Technologies,
Inc&lt;br&gt;<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://WWW.JakeDog.COM&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;Jake Dog&lt;br&gt;
<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://yellowpages.bellsouth.COM&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;YellowPages&lt;br&gt;
<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://www.DimensionX&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;Dimension X&lt;br&gt;
<BR>
&lt;INPUT TYPE=RADIO NAME=&quot;PLACESTOGO&quot; <BR>
&nbsp;VALUE=&quot;http://www.csusm.edu&quot; <BR>
&nbsp;OnClick = &quot;Do_Jump(this.form)&quot;&gt;California State
University San Marcos&lt;br&gt;<BR>
&lt;/CENTER&gt;<BR>
&lt;/FORM&gt;<BR>
&lt;/H2&gt;<BR>
<BR>
&lt;HR&gt;<BR>
&lt;CENTER&gt;<BR>
&lt;FONT SIZE=2&gt;<BR>
Comments to &lt;A HREF=&quot;mailto:cjardin@xprime.com&quot;&gt;X'
inc&lt;/A&gt;<BR>
&lt;/FONT&gt;<BR>
&lt;/CENTER&gt;<BR>
<BR>
&lt;/BODY&gt;<BR>
&lt;/HTML&gt;</FONT></TT>
</BLOCKQUOTE>
<HR>
<H2><A NAME="Summary"><FONT SIZE=5 COLOR=#Ff0000>Summary</FONT></A>
</H2>
<P>
The scripts provided in this chapter show some of the capabilities
of JavaScript. The customizable Web page example demonstrates
how JavaScript can be used to generate Web pages on-the-fly. The
Story Teller script shows how timers can be used to create scrolling
text. The Web guide shows how a script can be used to access other
pages on the Web. <A HREF="ch35.html" >Chapter 35</A>, &quot;JavaScript
Reference,&quot; provides a detailed description of the JavaScript
language.
<P>
<HR WIDTH="100%"></P>

<CENTER><P><A HREF="ch33.html"><IMG SRC="pc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A><A HREF="#CONTENTS"><IMG SRC="cc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A><A HREF="index.html"><IMG SRC="hb.gif" BORDER=0 HEIGHT=88 WIDTH=140></A><A HREF="ch35.html"><IMG 
SRC="nc.gif" BORDER=0 HEIGHT=88 WIDTH=140></A></P></CENTER>

<P>
<HR WIDTH="100%"></P>

</BODY>
</HTML>
